{"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/index.ts","statementMap":{"0":{"start":{"line":3,"column":4},"end":{"line":3,"column":71}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"2":{"start":{"line":3,"column":53},"end":{"line":3,"column":71}},"3":{"start":{"line":5,"column":22},"end":{"line":7,"column":1}},"4":{"start":{"line":6,"column":4},"end":{"line":6,"column":62}},"5":{"start":{"line":8,"column":0},"end":{"line":8,"column":62}},"6":{"start":{"line":9,"column":16},"end":{"line":9,"column":34}},"7":{"start":{"line":10,"column":26},"end":{"line":10,"column":68}},"8":{"start":{"line":11,"column":31},"end":{"line":11,"column":71}},"9":{"start":{"line":12,"column":23},"end":{"line":12,"column":55}},"10":{"start":{"line":13,"column":23},"end":{"line":13,"column":48}},"11":{"start":{"line":14,"column":20},"end":{"line":14,"column":40}},"12":{"start":{"line":15,"column":20},"end":{"line":15,"column":57}},"13":{"start":{"line":16,"column":0},"end":{"line":16,"column":29}},"14":{"start":{"line":17,"column":0},"end":{"line":17,"column":48}},"15":{"start":{"line":18,"column":0},"end":{"line":18,"column":31}},"16":{"start":{"line":19,"column":14},"end":{"line":19,"column":32}},"17":{"start":{"line":20,"column":0},"end":{"line":20,"column":36}},"18":{"start":{"line":21,"column":0},"end":{"line":21,"column":32}},"19":{"start":{"line":22,"column":0},"end":{"line":22,"column":33}},"20":{"start":{"line":24,"column":0},"end":{"line":26,"column":2}},"21":{"start":{"line":25,"column":4},"end":{"line":25,"column":19}},"22":{"start":{"line":28,"column":4},"end":{"line":28,"column":18}},"23":{"start":{"line":30,"column":0},"end":{"line":30,"column":28}},"24":{"start":{"line":34,"column":4},"end":{"line":37,"column":5}},"25":{"start":{"line":35,"column":19},"end":{"line":35,"column":43}},"26":{"start":{"line":36,"column":8},"end":{"line":36,"column":33}},"27":{"start":{"line":38,"column":4},"end":{"line":38,"column":17}},"28":{"start":{"line":40,"column":0},"end":{"line":40,"column":26}},"29":{"start":{"line":42,"column":4},"end":{"line":42,"column":17}},"30":{"start":{"line":44,"column":0},"end":{"line":44,"column":26}},"31":{"start":{"line":45,"column":24},"end":{"line":59,"column":1}},"32":{"start":{"line":46,"column":4},"end":{"line":46,"column":35}},"33":{"start":{"line":47,"column":4},"end":{"line":58,"column":6}},"34":{"start":{"line":48,"column":8},"end":{"line":48,"column":64}},"35":{"start":{"line":49,"column":8},"end":{"line":49,"column":32}},"36":{"start":{"line":50,"column":8},"end":{"line":50,"column":56}},"37":{"start":{"line":51,"column":8},"end":{"line":55,"column":11}},"38":{"start":{"line":52,"column":12},"end":{"line":54,"column":13}},"39":{"start":{"line":53,"column":16},"end":{"line":53,"column":149}},"40":{"start":{"line":56,"column":8},"end":{"line":56,"column":70}},"41":{"start":{"line":57,"column":8},"end":{"line":57,"column":133}},"42":{"start":{"line":57,"column":55},"end":{"line":57,"column":131}},"43":{"start":{"line":60,"column":0},"end":{"line":60,"column":34}},"44":{"start":{"line":62,"column":4},"end":{"line":65,"column":5}},"45":{"start":{"line":63,"column":8},"end":{"line":63,"column":138}},"46":{"start":{"line":64,"column":8},"end":{"line":64,"column":15}},"47":{"start":{"line":66,"column":21},"end":{"line":74,"column":5}},"48":{"start":{"line":75,"column":4},"end":{"line":85,"column":5}},"49":{"start":{"line":76,"column":30},"end":{"line":76,"column":31}},"50":{"start":{"line":77,"column":8},"end":{"line":84,"column":9}},"51":{"start":{"line":78,"column":23},"end":{"line":78,"column":35}},"52":{"start":{"line":79,"column":12},"end":{"line":83,"column":15}}},"fnMap":{"0":{"name":"__export","decl":{"start":{"line":2,"column":9},"end":{"line":2,"column":17}},"loc":{"start":{"line":2,"column":21},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":5,"column":56},"end":{"line":5,"column":57}},"loc":{"start":{"line":5,"column":71},"end":{"line":7,"column":1}},"line":5},"2":{"name":"(anonymous_2)","decl":{"start":{"line":24,"column":19},"end":{"line":24,"column":20}},"loc":{"start":{"line":24,"column":30},"end":{"line":26,"column":1}},"line":24},"3":{"name":"getStore","decl":{"start":{"line":27,"column":9},"end":{"line":27,"column":17}},"loc":{"start":{"line":27,"column":20},"end":{"line":29,"column":1}},"line":27},"4":{"name":"getAuth","decl":{"start":{"line":33,"column":15},"end":{"line":33,"column":22}},"loc":{"start":{"line":33,"column":25},"end":{"line":39,"column":1}},"line":33},"5":{"name":"setAuth","decl":{"start":{"line":41,"column":9},"end":{"line":41,"column":16}},"loc":{"start":{"line":41,"column":23},"end":{"line":43,"column":1}},"line":41},"6":{"name":"(anonymous_6)","decl":{"start":{"line":45,"column":24},"end":{"line":45,"column":25}},"loc":{"start":{"line":45,"column":36},"end":{"line":59,"column":1}},"line":45},"7":{"name":"(anonymous_7)","decl":{"start":{"line":47,"column":11},"end":{"line":47,"column":12}},"loc":{"start":{"line":47,"column":22},"end":{"line":58,"column":5}},"line":47},"8":{"name":"(anonymous_8)","decl":{"start":{"line":51,"column":24},"end":{"line":51,"column":25}},"loc":{"start":{"line":51,"column":45},"end":{"line":55,"column":9}},"line":51},"9":{"name":"(anonymous_9)","decl":{"start":{"line":57,"column":49},"end":{"line":57,"column":50}},"loc":{"start":{"line":57,"column":55},"end":{"line":57,"column":131}},"line":57},"10":{"name":"queueLifecycleEvents","decl":{"start":{"line":61,"column":15},"end":{"line":61,"column":35}},"loc":{"start":{"line":61,"column":51},"end":{"line":86,"column":1}},"line":61}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"type":"if","locations":[{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},{"start":{"line":3,"column":21},"end":{"line":3,"column":71}}],"line":3},"1":{"loc":{"start":{"line":5,"column":22},"end":{"line":7,"column":1}},"type":"binary-expr","locations":[{"start":{"line":5,"column":23},"end":{"line":5,"column":27}},{"start":{"line":5,"column":31},"end":{"line":5,"column":51}},{"start":{"line":5,"column":56},"end":{"line":7,"column":1}}],"line":5},"2":{"loc":{"start":{"line":6,"column":11},"end":{"line":6,"column":61}},"type":"cond-expr","locations":[{"start":{"line":6,"column":37},"end":{"line":6,"column":40}},{"start":{"line":6,"column":43},"end":{"line":6,"column":61}}],"line":6},"3":{"loc":{"start":{"line":6,"column":12},"end":{"line":6,"column":33}},"type":"binary-expr","locations":[{"start":{"line":6,"column":12},"end":{"line":6,"column":15}},{"start":{"line":6,"column":19},"end":{"line":6,"column":33}}],"line":6},"4":{"loc":{"start":{"line":34,"column":4},"end":{"line":37,"column":5}},"type":"if","locations":[{"start":{"line":34,"column":4},"end":{"line":37,"column":5}},{"start":{"line":34,"column":4},"end":{"line":37,"column":5}}],"line":34},"5":{"loc":{"start":{"line":52,"column":12},"end":{"line":54,"column":13}},"type":"if","locations":[{"start":{"line":52,"column":12},"end":{"line":54,"column":13}},{"start":{"line":52,"column":12},"end":{"line":54,"column":13}}],"line":52},"6":{"loc":{"start":{"line":62,"column":4},"end":{"line":65,"column":5}},"type":"if","locations":[{"start":{"line":62,"column":4},"end":{"line":65,"column":5}},{"start":{"line":62,"column":4},"end":{"line":65,"column":5}}],"line":62},"7":{"loc":{"start":{"line":77,"column":8},"end":{"line":84,"column":9}},"type":"if","locations":[{"start":{"line":77,"column":8},"end":{"line":84,"column":9}},{"start":{"line":77,"column":8},"end":{"line":84,"column":9}}],"line":77}},"s":{"0":5,"1":72,"2":72,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":3,"22":0,"23":1,"24":0,"25":0,"26":0,"27":0,"28":1,"29":0,"30":1,"31":1,"32":3,"33":3,"34":3,"35":3,"36":3,"37":3,"38":30,"39":0,"40":3,"41":3,"42":3,"43":1,"44":3,"45":0,"46":0,"47":3,"48":3,"49":21,"50":21,"51":15,"52":15},"f":{"0":5,"1":1,"2":3,"3":0,"4":0,"5":0,"6":3,"7":3,"8":30,"9":3,"10":3},"b":{"0":[72,0],"1":[1,1,1],"2":[0,1],"3":[1,1],"4":[0,0],"5":[0,30],"6":[0,3],"7":[15,6]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/index.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  IFiremodelConfig as IFiremodelPluginConfig,\n  IFiremodelState,\n  IFmQueuedAction,\n  FmCallback\n} from \"./types\";\nimport { Store } from \"vuex\";\nimport { FiremodelModule, database } from \"./store\";\nimport { DB, IFirebaseClientConfig } from \"abstracted-client\";\nimport { FmConfigMutation } from \"./types/mutations/FmConfigMutation\";\nimport { FmConfigAction } from \"./types/actions/FmConfigActions\";\nimport { FireModelPluginError } from \"./errors/FiremodelPluginError\";\nimport { addNamespace } from \"./shared/addNamespace\";\nimport { coreServices } from \"./coreServices\";\nimport { FirebaseAuth } from \"@firebase/auth-types\";\nimport { FireModel } from \"firemodel\";\nimport { IDictionary } from \"firemock\";\nimport copy from \"fast-copy\";\n\nexport * from \"./types\";\nexport * from \"./firemodelMutations/index\";\nexport * from \"firemodel\";\nexport { database } from \"./store\";\nexport * from \"./auth/api\";\nexport * from \"./abc/index\"\n\nexport let configuration: IFiremodelPluginConfig<any>;\nexport let dbConfig: IFirebaseClientConfig;\nexport let firemodelVuex: Store<any>;\nlet _store: Store<any>;\nexport const setStore = <T>(store: Store<T>) => {\n  _store = store;\n};\nexport function getStore<T = any>() {\n  return _store as Store<T>;\n}\n\nlet _db: DB;\nlet _auth: FirebaseAuth;\n\nexport async function getAuth() {\n  if (!_auth) {\n    const db = await database();\n    setAuth(await db.auth());\n  }\n\n  return _auth;\n}\n\nexport function setAuth(auth: FirebaseAuth) {\n  _auth = auth;\n}\n\nexport let initialState: IDictionary;\n\nexport type IFiremodel<T> = { \"@firemodel\": IFiremodelState<T> };\n\nconst FiremodelPlugin = <T>(config: IFiremodelPluginConfig<T & IFiremodel<T>>) => {\n  configuration = config;\n  type IRootState = T & { \"@firemodel\": IFiremodelState<T> };\n  return (store: Store<IRootState>) => {\n    initialState = copy(store.state);\n    setStore(store);\n    FireModel.dispatch = store.dispatch;\n\n    store.subscribe((mutation, state) => {\n      if (mutation.type === \"route/ROUTE_CHANGED\") {\n        store.dispatch(addNamespace(FmConfigAction.watchRouteChanges), {\n          ...mutation.payload\n        });\n      }\n    });\n\n    store.registerModule(\"@firemodel\", FiremodelModule<IRootState>());\n\n    queueLifecycleEvents<IRootState>(store, config).then(() =>\n      coreServices(store, { ...{ connect: true }, ...config })\n    );\n  };\n};\n\nexport default FiremodelPlugin;\n\nasync function queueLifecycleEvents<T>(\n  store: Store<T>,\n  config?: IFiremodelPluginConfig<T>\n) {\n  if (!config) {\n    throw new FireModelPluginError(\n      `There was no configuration sent into the FiremodelPlugin!`,\n      \"not-allowed\"\n    );\n    return;\n  }\n  const iterable = [\n    [\"onConnect\", \"connected\"],\n    [\"onAuth\", \"auth-event\"],\n    [\"onLogin\", \"logged-in\"],\n    [\"onLogout\", \"logged-out\"],\n    [\"onDisconnect\", \"disconnected\"],\n    [\"onRouteChange\", \"route-changed\"],\n    [\"onUserUpgraded\", \"user-upgraded\"]\n  ];\n\n  for (const i of iterable) {\n    const [name, event] = i;\n    if (config[name as keyof IFiremodelPluginConfig<T>]) {\n      const cb: FmCallback = config[\n        name as keyof IFiremodelPluginConfig<T>\n      ] as any;\n      await store.commit(addNamespace(FmConfigMutation.queueHook), {\n        on: event,\n        name: `lifecycle-event-${event}`,\n        cb\n      } as IFmQueuedAction<T>);\n    }\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"338929974082e3404f4743f8e13a4682a7263d66","contentHash":"6391311e43c8d0e505ea129f8d48715480e1dc3d540b0f5362eb95290c8da7ee"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":16},"end":{"line":3,"column":34}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":44}},"3":{"start":{"line":5,"column":18},"end":{"line":5,"column":38}},"4":{"start":{"line":7,"column":4},"end":{"line":7,"column":18}},"5":{"start":{"line":9,"column":0},"end":{"line":9,"column":42}},"6":{"start":{"line":10,"column":17},"end":{"line":10,"column":46}},"7":{"start":{"line":11,"column":0},"end":{"line":11,"column":39}},"8":{"start":{"line":12,"column":22},"end":{"line":12,"column":89}},"9":{"start":{"line":12,"column":65},"end":{"line":12,"column":88}},"10":{"start":{"line":16,"column":0},"end":{"line":21,"column":3}},"11":{"start":{"line":16,"column":33},"end":{"line":21,"column":1}}},"fnMap":{"0":{"name":"generateLocalId","decl":{"start":{"line":6,"column":9},"end":{"line":6,"column":24}},"loc":{"start":{"line":6,"column":47},"end":{"line":8,"column":1}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":12,"column":60},"end":{"line":12,"column":61}},"loc":{"start":{"line":12,"column":65},"end":{"line":12,"column":88}},"line":12},"2":{"name":"(anonymous_2)","decl":{"start":{"line":16,"column":26},"end":{"line":16,"column":27}},"loc":{"start":{"line":16,"column":33},"end":{"line":21,"column":1}},"line":16}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":0,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1,"11":3},"f":{"0":0,"1":0,"2":3},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/index.ts"],"names":[],"mappings":";;AAGA,mCAAgC;AAChC,6CAA8C;AAC9C,uCAAoC;AAEpC,SAAgB,eAAe,CAC7B,YAA8B,EAC9B,MAAuB;IAEvB,OAAO,MAAM,CAAC;AAChB,CAAC;AALD,0CAKC;AAED,+CAA8C;AAArC,8BAAA,QAAQ,CAAA;AAEjB,MAAM,aAAa,GAAG,MAAM,CAAC,IAAI,CAAC,iBAAS,CAAC,CAAC,MAAM,CACjD,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,KAAK,UAAU,CAC7B,CAAC;AAKF;;GAEG;AACU,QAAA,eAAe,GAAqB,GAAM,EAAE,CAAC,CAAC;IACzD,KAAK,EAAE,aAAK,EAAK;IACjB,SAAS,EAAE,iBAAS,EAAK;IACzB,OAAO,EAAE,iBAAO,EAAK;IACrB,UAAU,EAAE,IAAI;CACjB,CAAC,CAAC","sourcesContent":["import { IFmEventActions, IFiremodelState } from \"../types\";\nimport { Module } from \"vuex\";\nimport { ICompositeKey, Model } from \"firemodel\";\nimport { state } from \"./state\";\nimport { mutations } from \"./mutations/index\";\nimport { actions } from \"./actions\";\n\nexport function generateLocalId<T = Model>(\n  compositeKey: ICompositeKey<T>,\n  action: IFmEventActions\n) {\n  return action;\n}\n\nexport { database } from \"../shared/database\";\n\nconst mutationTypes = Object.keys(mutations).filter(\n  i => typeof i !== \"function\"\n);\nexport type IFmConfigMutationTypes = keyof typeof mutationTypes;\n\ntype FunctionToModule = <T>() => Module<IFiremodelState<T>, T>;\n\n/**\n * The **Vuex** module that this plugin exports\n */\nexport const FiremodelModule: FunctionToModule = <T>() => ({\n  state: state<T>(),\n  mutations: mutations<T>(),\n  actions: actions<T>(),\n  namespaced: true\n});\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"816d51ac5ec3c2d18e882c4c24b56e71ea48f355","contentHash":"f0e681eb4a1e90c2b8277ed6d95efbe050d3cd234ef0c4f1205a48ff6ce7e9ff"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/state.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/state.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":6,"column":0},"end":{"line":13,"column":3}},"2":{"start":{"line":6,"column":23},"end":{"line":13,"column":1}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":16},"end":{"line":6,"column":17}},"loc":{"start":{"line":6,"column":23},"end":{"line":13,"column":1}},"line":6}},"branchMap":{},"s":{"0":1,"1":1,"2":3},"f":{"0":3},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/state.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/state.ts"],"names":[],"mappings":";;AAEA;;GAEG;AACU,QAAA,KAAK,GAAgC,GAAM,EAAE,CAAC,CAAC;IAC1D,aAAa,EAAE,KAAK;IACpB,MAAM,EAAE,cAAc;IACtB,MAAM,EAAE,EAAE;IACV,QAAQ,EAAE,EAAE;IACZ,SAAS,EAAE,EAAE;IACb,KAAK,EAAE,EAAE;CACV,CAAC,CAAC","sourcesContent":["import { IFiremodelState } from \"../types\";\n\n/**\n * The default state for this plugin's **Vuex** state node\n */\nexport const state: <T>() => IFiremodelState<T> = <T>() => ({\n  authenticated: false,\n  status: \"unconfigured\",\n  queued: [],\n  watching: [],\n  localOnly: {},\n  muted: []\n});\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"080f4cbe6fbb7a0428b7513383c2c72e933c7f0e","contentHash":"0e60d9cbb4d95a808da3064e2d3140777986b705f8dd6150e39105017861f19e"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":22},"end":{"line":3,"column":46}},"2":{"start":{"line":4,"column":24},"end":{"line":4,"column":50}},"3":{"start":{"line":5,"column":25},"end":{"line":5,"column":52}},"4":{"start":{"line":6,"column":15},"end":{"line":6,"column":32}},"5":{"start":{"line":7,"column":18},"end":{"line":7,"column":38}},"6":{"start":{"line":8,"column":20},"end":{"line":8,"column":42}},"7":{"start":{"line":9,"column":17},"end":{"line":9,"column":36}},"8":{"start":{"line":10,"column":24},"end":{"line":10,"column":50}},"9":{"start":{"line":16,"column":0},"end":{"line":16,"column":378}},"10":{"start":{"line":16,"column":27},"end":{"line":16,"column":376}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":16,"column":20},"end":{"line":16,"column":21}},"loc":{"start":{"line":16,"column":27},"end":{"line":16,"column":376}},"line":16}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":3},"f":{"0":3},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/index.ts"],"names":[],"mappings":";;AAAA,+CAA4C;AAC5C,mDAAgD;AAChD,qDAAkD;AAClD,iCAAuC;AACvC,uCAAoC;AACpC,2CAAwC;AACxC,qCAA0C;AAG1C,mDAAgD;AAEhD;;;;GAIG;AACU,QAAA,SAAS,GAAG,GAAM,EAAE,CAC/B,CAAC,oHACI,uBAAc,EAAK,GACnB,yBAAW,EAAK,GAChB,oBAAa,EAAK,GAClB,6BAAa,EAAK,GAClB,+BAAc,EAAK,GACnB,qBAAS,EAAK,GACd,6BAAa,EAAK,GAClB,iBAAO,EAAK,CACqB,CAAA,CAAC","sourcesContent":["import { localConfig } from \"./localConfig\";\nimport { serverConfirm } from \"./serverConfirm\";\nimport { serverRollback } from \"./serverRollback\";\nimport { authMutations } from \"./auth\";\nimport { watcher } from \"./watcher\";\nimport { localCrud } from \"./localCrud\";\nimport { errorMutations } from \"./errors\";\nimport { MutationTree } from \"vuex\";\nimport { IFiremodelState } from \"../../types\";\nimport { relationships } from \"./relationships\";\n\n/**\n * The **mutations** to the `@firemodel` state node; this state node will be off the\n * root of a state tree which is defined by the application but remains\n * unknown/generic to this plugin\n */\nexport const mutations = <T>() =>\n  ({\n    ...errorMutations<T>(),\n    ...localConfig<T>(),\n    ...authMutations<T>(),\n    ...serverConfirm<T>(),\n    ...serverRollback<T>(),\n    ...localCrud<T>(),\n    ...relationships<T>(),\n    ...watcher<T>()\n  } as MutationTree<IFiremodelState<T>>);\n\nexport type IFiremodelMutation = keyof typeof mutations;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f22c423723c54f22de6e1a148e5873503ec240b6","contentHash":"8128c812aa48639223254db89d3e2955808a63a6e5bbd60d5d9cc551cd6a7b96"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/localConfig.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/localConfig.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":14},"end":{"line":6,"column":45}},"4":{"start":{"line":10,"column":0},"end":{"line":59,"column":3}},"5":{"start":{"line":10,"column":29},"end":{"line":59,"column":1}},"6":{"start":{"line":15,"column":8},"end":{"line":15,"column":30}},"7":{"start":{"line":18,"column":8},"end":{"line":18,"column":35}},"8":{"start":{"line":21,"column":8},"end":{"line":21,"column":36}},"9":{"start":{"line":24,"column":8},"end":{"line":24,"column":31}},"10":{"start":{"line":25,"column":8},"end":{"line":25,"column":108}},"11":{"start":{"line":28,"column":8},"end":{"line":30,"column":9}},"12":{"start":{"line":29,"column":12},"end":{"line":29,"column":51}},"13":{"start":{"line":31,"column":8},"end":{"line":31,"column":77}},"14":{"start":{"line":34,"column":8},"end":{"line":34,"column":47}},"15":{"start":{"line":37,"column":8},"end":{"line":37,"column":54}},"16":{"start":{"line":38,"column":8},"end":{"line":38,"column":112}},"17":{"start":{"line":41,"column":8},"end":{"line":41,"column":54}},"18":{"start":{"line":42,"column":8},"end":{"line":42,"column":57}},"19":{"start":{"line":51,"column":8},"end":{"line":51,"column":70}},"20":{"start":{"line":54,"column":8},"end":{"line":54,"column":70}},"21":{"start":{"line":61,"column":4},"end":{"line":61,"column":42}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":10,"column":22},"end":{"line":10,"column":23}},"loc":{"start":{"line":10,"column":29},"end":{"line":59,"column":1}},"line":10},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":57},"end":{"line":11,"column":58}},"loc":{"start":{"line":11,"column":66},"end":{"line":13,"column":5}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":14,"column":35},"end":{"line":14,"column":36}},"loc":{"start":{"line":14,"column":54},"end":{"line":16,"column":5}},"line":14},"4":{"name":"(anonymous_4)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":41},"end":{"line":19,"column":5}},"line":17},"5":{"name":"(anonymous_5)","decl":{"start":{"line":20,"column":4},"end":{"line":20,"column":5}},"loc":{"start":{"line":20,"column":43},"end":{"line":22,"column":5}},"line":20},"6":{"name":"(anonymous_6)","decl":{"start":{"line":23,"column":4},"end":{"line":23,"column":5}},"loc":{"start":{"line":23,"column":59},"end":{"line":26,"column":5}},"line":23},"7":{"name":"(anonymous_7)","decl":{"start":{"line":27,"column":4},"end":{"line":27,"column":5}},"loc":{"start":{"line":27,"column":43},"end":{"line":32,"column":5}},"line":27},"8":{"name":"(anonymous_8)","decl":{"start":{"line":33,"column":4},"end":{"line":33,"column":5}},"loc":{"start":{"line":33,"column":46},"end":{"line":35,"column":5}},"line":33},"9":{"name":"(anonymous_9)","decl":{"start":{"line":36,"column":4},"end":{"line":36,"column":5}},"loc":{"start":{"line":36,"column":55},"end":{"line":39,"column":5}},"line":36},"10":{"name":"(anonymous_10)","decl":{"start":{"line":40,"column":4},"end":{"line":40,"column":5}},"loc":{"start":{"line":40,"column":57},"end":{"line":43,"column":5}},"line":40},"11":{"name":"(anonymous_11)","decl":{"start":{"line":44,"column":4},"end":{"line":44,"column":5}},"loc":{"start":{"line":44,"column":57},"end":{"line":46,"column":5}},"line":44},"12":{"name":"(anonymous_12)","decl":{"start":{"line":47,"column":4},"end":{"line":47,"column":5}},"loc":{"start":{"line":47,"column":59},"end":{"line":49,"column":5}},"line":47},"13":{"name":"(anonymous_13)","decl":{"start":{"line":50,"column":4},"end":{"line":50,"column":5}},"loc":{"start":{"line":50,"column":54},"end":{"line":52,"column":5}},"line":50},"14":{"name":"(anonymous_14)","decl":{"start":{"line":53,"column":4},"end":{"line":53,"column":5}},"loc":{"start":{"line":53,"column":54},"end":{"line":55,"column":5}},"line":53},"15":{"name":"(anonymous_15)","decl":{"start":{"line":56,"column":4},"end":{"line":56,"column":5}},"loc":{"start":{"line":56,"column":78},"end":{"line":58,"column":5}},"line":56},"16":{"name":"isUserCredential","decl":{"start":{"line":60,"column":9},"end":{"line":60,"column":25}},"loc":{"start":{"line":60,"column":32},"end":{"line":62,"column":1}},"line":60}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":25,"column":43},"end":{"line":25,"column":106}},"type":"cond-expr","locations":[{"start":{"line":25,"column":58},"end":{"line":25,"column":90}},{"start":{"line":25,"column":93},"end":{"line":25,"column":106}}],"line":25},"4":{"loc":{"start":{"line":28,"column":8},"end":{"line":30,"column":9}},"type":"if","locations":[{"start":{"line":28,"column":8},"end":{"line":30,"column":9}},{"start":{"line":28,"column":8},"end":{"line":30,"column":9}}],"line":28},"5":{"loc":{"start":{"line":38,"column":50},"end":{"line":38,"column":110}},"type":"cond-expr","locations":[{"start":{"line":38,"column":58},"end":{"line":38,"column":63}},{"start":{"line":38,"column":66},"end":{"line":38,"column":110}}],"line":38},"6":{"loc":{"start":{"line":38,"column":66},"end":{"line":38,"column":110}},"type":"cond-expr","locations":[{"start":{"line":38,"column":85},"end":{"line":38,"column":96}},{"start":{"line":38,"column":99},"end":{"line":38,"column":110}}],"line":38},"7":{"loc":{"start":{"line":61,"column":11},"end":{"line":61,"column":41}},"type":"cond-expr","locations":[{"start":{"line":61,"column":29},"end":{"line":61,"column":33}},{"start":{"line":61,"column":36},"end":{"line":61,"column":41}}],"line":61}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":3,"6":3,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":3,"18":3,"19":15,"20":0,"21":0},"f":{"0":1,"1":3,"2":3,"3":3,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":3,"11":0,"12":0,"13":15,"14":0,"15":6,"16":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/localConfig.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/localConfig.ts"],"names":[],"mappings":";;;;;AASA,8CAAsB;AAEtB;;GAEG;AACU,QAAA,WAAW,GAAG,GAAM,EAAE,CACjC,CAAC;IACC,mDAAsC,EAAE,KAAK,CAAC,EAAE;QAC9C,EAAE;IACJ,CAAC;IACD,6BAA4B,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,EAAE;QAC9C,KAAK,CAAC,MAAM,GAAG,MAAM,CAAC;IACxB,CAAC;IACD,6BAA4B,CAAC,KAAK;QAChC,KAAK,CAAC,MAAM,GAAG,WAAW,CAAC;IAC7B,CAAC;IACD,+BAA6B,CAAC,KAAK;QACjC,KAAK,CAAC,MAAM,GAAG,YAAY,CAAC;IAC9B,CAAC;IACD,0CAAkC,CAAC,KAAK,EAAE,GAAU;QAClD,KAAK,CAAC,MAAM,GAAG,OAAO,CAAC;QACvB,aAAG,CAAC,GAAG,CACL,KAAK,EACL,QAAQ,EACR,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,CAChE,CAAC;IACJ,CAAC;IACD,0BAAyB,CAAC,KAAK,EAAE,GAAG;QAClC,IAAI,CAAC,KAAK,CAAC,MAAM,EAAE;YACjB,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAC;SAC9B;QACD,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,EAAG,KAAK,CAAC,MAAgB,CAAC,MAAM,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC;IACxE,CAAC;IACD,kCAA8B,CAAC,KAAK;QAClC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,EAAE,EAAE,CAAC,CAAC;IAC/B,CAAC;IAED,qCAA+B,CAAC,KAAK,EAAE,IAAkB;QACvD,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,aAAa,EAAE,IAAI,CAAC,CAAC;QAEpC,aAAG,CAAC,GAAG,CACL,KAAK,EACL,eAAe,EACf,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,WAAW,CAC7D,CAAC;IACJ,CAAC;IAED,uCAAgC,CAAC,KAAK,EAAE,IAAkB;QACxD,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,aAAa,EAAE,IAAI,CAAC,CAAC;QACpC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,eAAe,EAAE,KAAK,CAAC,CAAC;IACzC,CAAC;IAED,oCAA+B,CAAC,KAAK,EAAE,OAAO;QAC5C,kBAAkB;IACpB,CAAC;IAED,sCAAgC,CAAC,KAAK,EAAE,OAAO;QAC7C,kBAAkB;IACpB,CAAC;IAED,oCAA4B,CAAC,KAAK,EAAE,IAAwB;QAC1D,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;IACtD,CAAC;IAED,oCAA+B,CAAC,KAAK,EAAE,IAAwB;QAC7D,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,EAAE,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,CAAC;IACtD,CAAC;IAED,2DAA0C,CACxC,KAAK,EACL,KAA+D;QAE/D,EAAE;IACJ,CAAC;CACmC,CAAA,CAAC;AAEzC,SAAS,gBAAgB,CAAC,IAA2B;IACnD,OAAQ,IAAuB,CAAC,UAAU,CAAC,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,KAAK,CAAC;AAC5D,CAAC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport {\n  IFiremodelState,\n  IFmLifecycleEvents,\n  IFmQueuedAction,\n  ICurrentUser\n} from \"../../types\";\nimport { FmConfigMutation } from \"../../types/mutations/FmConfigMutation\";\nimport { User, UserCredential } from \"@firebase/auth-types\";\nimport Vue from \"vue\";\n\n/**\n * The **mutations** scoped to the local configuration of Firebase\n */\nexport const localConfig = <T>() =>\n  ({\n    [FmConfigMutation.coreServicesStarted]: state => {\n      //\n    },\n    [FmConfigMutation.configure]: (state, config) => {\n      state.config = config;\n    },\n    [FmConfigMutation.connected](state) {\n      state.status = \"connected\";\n    },\n    [FmConfigMutation.connecting](state) {\n      state.status = \"connecting\";\n    },\n    [FmConfigMutation.connectionError](state, err: Error) {\n      state.status = \"error\";\n      Vue.set(\n        state,\n        \"errors\",\n        state.errors ? state.errors.concat(err.message) : [err.message]\n      );\n    },\n    [FmConfigMutation.appErr](state, err) {\n      if (!state.errors) {\n        Vue.set(state, \"errors\", []);\n      }\n      Vue.set(state, \"errors\", (state.errors as any[]).concat(err.message));\n    },\n    [FmConfigMutation.clearErrors](state) {\n      Vue.set(state, \"errors\", []);\n    },\n\n    [FmConfigMutation.userLoggedIn](state, user: ICurrentUser) {\n      Vue.set(state, \"currentUser\", user);\n\n      Vue.set(\n        state,\n        \"authenticated\",\n        !user ? false : user.isAnonymous ? \"anonymous\" : \"logged-in\"\n      );\n    },\n\n    [FmConfigMutation.userLoggedOut](state, user: ICurrentUser) {\n      Vue.set(state, \"currentUser\", user);\n      Vue.set(state, \"authenticated\", false);\n    },\n\n    [FmConfigMutation.userUpgraded](state, payload) {\n      // TODO: implement\n    },\n\n    [FmConfigMutation.userAbandoned](state, payload) {\n      // TODO: implement\n    },\n\n    [FmConfigMutation.queueHook](state, item: IFmQueuedAction<T>) {\n      Vue.set(state, \"queued\", state.queued.concat(item));\n    },\n\n    [FmConfigMutation.queueWatcher](state, item: IFmQueuedAction<T>) {\n      Vue.set(state, \"queued\", state.queued.concat(item));\n    },\n\n    [FmConfigMutation.lifecycleEventCompleted](\n      state,\n      event: { event: IFmLifecycleEvents; actionCallbacks: string[] }\n    ) {\n      //\n    }\n  } as MutationTree<IFiremodelState<T>>);\n\nfunction isUserCredential(user: User | UserCredential): user is UserCredential {\n  return (user as UserCredential).credential ? true : false;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ea9bedb5be58644585681f521310b26520ea715d","contentHash":"68730b368970a82b7c14ac34a5b654737a10ead4f340ab0d917e54ba0b61c776"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/serverConfirm.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/serverConfirm.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":14},"end":{"line":6,"column":45}},"4":{"start":{"line":7,"column":0},"end":{"line":31,"column":3}},"5":{"start":{"line":7,"column":31},"end":{"line":31,"column":1}},"6":{"start":{"line":12,"column":8},"end":{"line":12,"column":54}},"7":{"start":{"line":15,"column":30},"end":{"line":15,"column":51}},"8":{"start":{"line":16,"column":26},"end":{"line":16,"column":60}},"9":{"start":{"line":17,"column":8},"end":{"line":17,"column":40}},"10":{"start":{"line":18,"column":8},"end":{"line":18,"column":57}},"11":{"start":{"line":26,"column":30},"end":{"line":26,"column":51}},"12":{"start":{"line":27,"column":26},"end":{"line":27,"column":60}},"13":{"start":{"line":28,"column":8},"end":{"line":28,"column":40}},"14":{"start":{"line":29,"column":8},"end":{"line":29,"column":57}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":24},"end":{"line":7,"column":25}},"loc":{"start":{"line":7,"column":31},"end":{"line":31,"column":1}},"line":7},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":4},"end":{"line":11,"column":5}},"loc":{"start":{"line":11,"column":64},"end":{"line":13,"column":5}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":14,"column":4},"end":{"line":14,"column":5}},"loc":{"start":{"line":14,"column":70},"end":{"line":20,"column":5}},"line":14},"4":{"name":"(anonymous_4)","decl":{"start":{"line":25,"column":4},"end":{"line":25,"column":5}},"loc":{"start":{"line":25,"column":70},"end":{"line":30,"column":5}},"line":25}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":3,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"f":{"0":1,"1":3,"2":0,"3":0,"4":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/serverConfirm.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/serverConfirm.ts"],"names":[],"mappings":";;;;;AAEA,8CAAsB;AAGT,QAAA,aAAa,GAAG,GAAM,EAAE,CACnC,CAAC;IACC;;OAEG;IACH,2CAAiC,CAAC,KAAK,EAAE,OAA+B;QACtE,OAAO,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;IAChD,CAAC;IAED,iDAAoC,CAClC,KAAK,EACL,OAA+B;QAE/B,MAAM,aAAa,GAAG,OAAO,CAAC,aAAa,CAAC;QAC5C,MAAM,SAAS,iBAAgC,EAAE,EAAK,KAAK,CAAC,SAAS,CAAE,CAAC;QACxE,OAAO,SAAS,CAAC,aAAa,CAAC,CAAC;QAEhC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;QACvC,iDAAiD;IACnD,CAAC;IAED;;;OAGG;IACH,iDAAoC,CAClC,KAAK,EACL,OAA+B;QAE/B,MAAM,aAAa,GAAG,OAAO,CAAC,aAAa,CAAC;QAC5C,MAAM,SAAS,iBAAgC,EAAE,EAAK,KAAK,CAAC,SAAS,CAAE,CAAC;QACxE,OAAO,SAAS,CAAC,aAAa,CAAC,CAAC;QAEhC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;IACzC,CAAC;CACmC,CAAA,CAAC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { IFiremodelState, IFmLocalRecordEvent } from \"../../index\";\nimport Vue from \"vue\";\nimport { FmCrudMutation } from \"../../types/mutations/FmCrudMutation\";\n\nexport const serverConfirm = <T>() =>\n  ({\n    /**\n     * When a change has been made\n     */\n    [FmCrudMutation.serverAddConfirm](state, payload: IFmLocalRecordEvent<T>) {\n      delete state.localOnly[payload.transactionId];\n    },\n\n    [FmCrudMutation.serverChangeConfirm](\n      state,\n      payload: IFmLocalRecordEvent<T>\n    ) {\n      const transactionId = payload.transactionId;\n      const localOnly: typeof state.localOnly = { ...{}, ...state.localOnly };\n      delete localOnly[transactionId];\n\n      Vue.set(state, \"localOnly\", localOnly);\n      // delete state.localOnly[payload.transactionId];\n    },\n\n    /**\n     * Removes the `localOnly` reference to a transaction once the server\n     * has confirmed it.\n     */\n    [FmCrudMutation.serverRemoveConfirm](\n      state,\n      payload: IFmLocalRecordEvent<T>\n    ) {\n      const transactionId = payload.transactionId;\n      const localOnly: typeof state.localOnly = { ...{}, ...state.localOnly };\n      delete localOnly[transactionId];\n\n      Vue.set(state, \"localOnly\", localOnly);\n    }\n  } as MutationTree<IFiremodelState<T>>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8f2ef5477a2527304dba38bd443b22d46a7343c1","contentHash":"f3d86aab434c2e4057b46944b2d7b8f220610054a41fd0b0cd43c5490144fd75"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/serverRollback.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/serverRollback.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":14},"end":{"line":6,"column":45}},"4":{"start":{"line":7,"column":0},"end":{"line":31,"column":3}},"5":{"start":{"line":7,"column":32},"end":{"line":31,"column":1}},"6":{"start":{"line":25,"column":30},"end":{"line":25,"column":51}},"7":{"start":{"line":26,"column":26},"end":{"line":26,"column":60}},"8":{"start":{"line":27,"column":8},"end":{"line":27,"column":40}},"9":{"start":{"line":28,"column":8},"end":{"line":28,"column":57}},"10":{"start":{"line":29,"column":8},"end":{"line":29,"column":94}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":25},"end":{"line":7,"column":26}},"loc":{"start":{"line":7,"column":32},"end":{"line":31,"column":1}},"line":7},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":4},"end":{"line":11,"column":5}},"loc":{"start":{"line":11,"column":61},"end":{"line":13,"column":5}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":14,"column":4},"end":{"line":14,"column":5}},"loc":{"start":{"line":14,"column":67},"end":{"line":16,"column":5}},"line":14},"4":{"name":"(anonymous_4)","decl":{"start":{"line":21,"column":4},"end":{"line":21,"column":5}},"loc":{"start":{"line":21,"column":67},"end":{"line":23,"column":5}},"line":21},"5":{"name":"(anonymous_5)","decl":{"start":{"line":24,"column":4},"end":{"line":24,"column":5}},"loc":{"start":{"line":24,"column":82},"end":{"line":30,"column":5}},"line":24}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":3,"6":0,"7":0,"8":0,"9":0,"10":0},"f":{"0":1,"1":3,"2":0,"3":0,"4":0,"5":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/serverRollback.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/serverRollback.ts"],"names":[],"mappings":";;;;;AAEA,8CAAsB;AAGT,QAAA,cAAc,GAAG,GAAM,EAAE,CACpC,CAAC;IACC;;OAEG;IACH,wCAAkC,CAAC,KAAK,EAAE,OAA+B;QACvE,kBAAkB;IACpB,CAAC;IAED,8CAAqC,CACnC,KAAK,EACL,OAA+B;QAE/B,kBAAkB;IACpB,CAAC;IAED;;;OAGG;IACH,8CAAqC,CACnC,KAAK,EACL,OAA+B;QAE/B,kBAAkB;IACpB,CAAC;IAED,6DAAwC,CACtC,KAAK,EACL,OAA+B;QAE/B,MAAM,aAAa,GAAG,OAAO,CAAC,aAAa,CAAC;QAC5C,MAAM,SAAS,iBAAgC,EAAE,EAAK,KAAK,CAAC,SAAS,CAAE,CAAC;QACxE,OAAO,SAAS,CAAC,aAAa,CAAC,CAAC;QAChC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;QACvC,OAAO,CAAC,IAAI,CACV,sDAAsD,aAAa,IAAI,CACxE,CAAC;IACJ,CAAC;CACmC,CAAA,CAAC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { IFiremodelState, IFmLocalRecordEvent } from \"../../index\";\nimport Vue from \"vue\";\nimport { FmCrudMutation } from \"../../types/mutations/FmCrudMutation\";\n\nexport const serverRollback = <T>() =>\n  ({\n    /**\n     * Local ADD must be rolled back\n     */\n    [FmCrudMutation.serverAddRollback](state, payload: IFmLocalRecordEvent<T>) {\n      // TODO: implement\n    },\n\n    [FmCrudMutation.serverChangeRollback](\n      state,\n      payload: IFmLocalRecordEvent<T>\n    ) {\n      // TODO: implement\n    },\n\n    /**\n     * Removes the `localOnly` reference to a transaction once the server\n     * has confirmed it.\n     */\n    [FmCrudMutation.serverRemoveRollback](\n      state,\n      payload: IFmLocalRecordEvent<T>\n    ) {\n      // TODO: implement\n    },\n\n    [FmCrudMutation.relationshipAddRollback](\n      state,\n      payload: IFmLocalRecordEvent<T>\n    ) {\n      const transactionId = payload.transactionId;\n      const localOnly: typeof state.localOnly = { ...{}, ...state.localOnly };\n      delete localOnly[transactionId];\n      Vue.set(state, \"localOnly\", localOnly);\n      console.info(\n        `Rolled back changes made locally [ transaction id: ${transactionId} ]`\n      );\n    }\n  } as MutationTree<IFiremodelState<T>>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"55fcf6cccd62ee96c3db07842d4696a513950bcc","contentHash":"ea63b68b3b6ed96895cdb88b55f795a4353313f40cbb76897d648fa7bef3b6ee"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/auth.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/auth.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":14},"end":{"line":6,"column":45}},"4":{"start":{"line":10,"column":0},"end":{"line":53,"column":3}},"5":{"start":{"line":10,"column":31},"end":{"line":53,"column":1}},"6":{"start":{"line":12,"column":8},"end":{"line":12,"column":60}},"7":{"start":{"line":13,"column":8},"end":{"line":13,"column":78}},"8":{"start":{"line":29,"column":8},"end":{"line":29,"column":112}},"9":{"start":{"line":42,"column":8},"end":{"line":42,"column":44}},"10":{"start":{"line":45,"column":8},"end":{"line":45,"column":51}},"11":{"start":{"line":48,"column":8},"end":{"line":48,"column":49}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":10,"column":24},"end":{"line":10,"column":25}},"loc":{"start":{"line":10,"column":31},"end":{"line":53,"column":1}},"line":10},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":4},"end":{"line":11,"column":5}},"loc":{"start":{"line":11,"column":54},"end":{"line":15,"column":5}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":16,"column":4},"end":{"line":16,"column":5}},"loc":{"start":{"line":16,"column":58},"end":{"line":18,"column":5}},"line":16},"4":{"name":"(anonymous_4)","decl":{"start":{"line":19,"column":4},"end":{"line":19,"column":5}},"loc":{"start":{"line":19,"column":34},"end":{"line":21,"column":5}},"line":19},"5":{"name":"(anonymous_5)","decl":{"start":{"line":22,"column":4},"end":{"line":22,"column":5}},"loc":{"start":{"line":22,"column":32},"end":{"line":24,"column":5}},"line":22},"6":{"name":"(anonymous_6)","decl":{"start":{"line":25,"column":4},"end":{"line":25,"column":5}},"loc":{"start":{"line":25,"column":42},"end":{"line":27,"column":5}},"line":25},"7":{"name":"(anonymous_7)","decl":{"start":{"line":28,"column":4},"end":{"line":28,"column":5}},"loc":{"start":{"line":28,"column":31},"end":{"line":30,"column":5}},"line":28},"8":{"name":"(anonymous_8)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":22},"end":{"line":33,"column":5}},"line":31},"9":{"name":"(anonymous_9)","decl":{"start":{"line":34,"column":4},"end":{"line":34,"column":5}},"loc":{"start":{"line":34,"column":19},"end":{"line":36,"column":5}},"line":34},"10":{"name":"(anonymous_10)","decl":{"start":{"line":41,"column":4},"end":{"line":41,"column":5}},"loc":{"start":{"line":41,"column":31},"end":{"line":43,"column":5}},"line":41},"11":{"name":"(anonymous_11)","decl":{"start":{"line":44,"column":4},"end":{"line":44,"column":5}},"loc":{"start":{"line":44,"column":37},"end":{"line":46,"column":5}},"line":44},"12":{"name":"(anonymous_12)","decl":{"start":{"line":47,"column":4},"end":{"line":47,"column":5}},"loc":{"start":{"line":47,"column":33},"end":{"line":49,"column":5}},"line":47},"13":{"name":"(anonymous_13)","decl":{"start":{"line":50,"column":4},"end":{"line":50,"column":5}},"loc":{"start":{"line":50,"column":36},"end":{"line":52,"column":5}},"line":50}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":3,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"f":{"0":1,"1":3,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/auth.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/auth.ts"],"names":[],"mappings":";;;;;AAIA,8CAAsB;AAGtB;;GAEG;AACU,QAAA,aAAa,GAAG,GAAM,EAAE,CACnC,CAAC;IACC,0BAA0B,CAAC,KAAK,EAAE,cAA8B;QAC9D,OAAO,CAAC,KAAK,CAAC,oCAAoC,CAAC,CAAC;QACpD,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,gBAAgB,EAAE,cAAc,CAAC,UAAU,CAAC,CAAC;QAC5D,0EAA0E;IAC5E,CAAC;IACD,8BAA8B,CAAC,KAAK,EAAE,cAA8B;QAClE,kFAAkF;IACpF,CAAC;IAED,sBAAsB,CAAC,KAAK;QAC1B,gBAAgB;IAClB,CAAC;IAED,oBAAoB,CAAC,KAAK;QACxB,gBAAgB;IAClB,CAAC;IAED,uBAAuB,CAAC,KAAK,EAAE,KAAK;QAClC,yEAAyE;IAC3E,CAAC;IAED,YAAY,CAAC,KAAK,EAAE,KAAa;QAC/B,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,aAAa,kCACtB,KAAK,CAAC,WAA4B,GACnC,EAAE,KAAK,EAAE,EACZ,CAAC;IACL,CAAC;IAED,eAAe;QACb,gBAAgB;IAClB,CAAC;IAED,OAAO,CAAC,KAAK;QACX,kFAAkF;IACpF,CAAC;IAED,uCAAuC;IACvC,iDAAiD;IACjD,KAAK;IAEL,8CAA8C;IAC9C,UAAU,CAAC,KAAK,EAAE,OAAO;QACvB,OAAO,CAAC,GAAG,CAAC,aAAa,EAAE,OAAO,CAAC,CAAC;IACtC,CAAC;IAED,iBAAiB,CAAC,KAAK,EAAE,MAAmB;QAC1C,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,QAAQ,EAAE,MAAM,CAAC,CAAC;IACnC,CAAC;IAED,cAAc,CAAC,KAAK,EAAE,KAAa;QACjC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,OAAO,EAAE,KAAK,CAAC,CAAC;IACjC,CAAC;IAED,eAAe,CAAC,KAAK,EAAE,OAAO;QAC5B,QAAQ;IACV,CAAC;CACmC,CAAA,CAAC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { IFiremodelState } from \"../..\";\nimport { UserCredential } from \"@firebase/auth-types\";\nimport { IFiremodelAbbreviatedUser, ICurrentUser } from \"../../types\";\nimport Vue from \"vue\";\nimport { IDictionary } from \"firemock\";\n\n/**\n * The **mutations** associated to the Firebase Auth API.\n */\nexport const authMutations = <T>() =>\n  ({\n    signInWithEmailAndPassword(state, userCredential: UserCredential) {\n      console.debug(\"user signed in with email/password\");\n      Vue.set(state, \"userCredential\", userCredential.credential);\n      // the @firemodel.currentUser will be updated by the `changeAuth` function\n    },\n    createUserWithEmailAndPassword(state, userCredential: UserCredential) {\n      // no need to change state tree as the observer on onAuthChanged will address this\n    },\n\n    sendPasswordResetEmail(state) {\n      // nothing to do\n    },\n\n    confirmPasswordReset(state) {\n      // nothing to do\n    },\n\n    verifyPasswordResetCode(state, email) {\n      // on success it returns the email of the user who entered the reset code\n    },\n\n    updatedEmail(state, email: string) {\n      Vue.set(state, \"currentUser\", {\n        ...(state.currentUser as ICurrentUser),\n        ...{ email }\n      });\n    },\n\n    updatedPassword() {\n      // nothing to do\n    },\n\n    signOut(state) {\n      // no need to change state tree as the observer on onAuthChanged will address this\n    },\n\n    // updatedProfile(state, profile: {}) {\n    //   state.currentUser?.fullProfile.displayName =\n    // },\n\n    /** once the sign out process has completed */\n    SIGNED_OUT(state, payload) {\n      console.log(`Signed out:`, payload);\n    },\n\n    SET_CUSTOM_CLAIMS(state, claims: IDictionary) {\n      Vue.set(state, \"claims\", claims);\n    },\n\n    SET_AUTH_TOKEN(state, token: string) {\n      Vue.set(state, \"token\", token);\n    },\n\n    ANONYMOUS_LOGIN(state, payload) {\n      // no-op\n    }\n  } as MutationTree<IFiremodelState<T>>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3971d24a1b14d866340f53d6f4bfc0b47f42744a","contentHash":"ddab28c4b7b774c2d6530d2b79aa0b1cdf6182282799c31dfa54c7dd2a92dca7"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/watcher.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/watcher.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":14},"end":{"line":6,"column":45}},"4":{"start":{"line":7,"column":0},"end":{"line":26,"column":3}},"5":{"start":{"line":7,"column":25},"end":{"line":26,"column":1}},"6":{"start":{"line":12,"column":8},"end":{"line":12,"column":106}},"7":{"start":{"line":15,"column":8},"end":{"line":15,"column":87}},"8":{"start":{"line":15,"column":52},"end":{"line":15,"column":85}},"9":{"start":{"line":18,"column":8},"end":{"line":18,"column":28}},"10":{"start":{"line":21,"column":8},"end":{"line":21,"column":52}},"11":{"start":{"line":24,"column":8},"end":{"line":24,"column":63}},"12":{"start":{"line":24,"column":46},"end":{"line":24,"column":61}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":18},"end":{"line":7,"column":19}},"loc":{"start":{"line":7,"column":25},"end":{"line":26,"column":1}},"line":7},"2":{"name":"(anonymous_2)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":63},"end":{"line":10,"column":5}},"line":8},"3":{"name":"(anonymous_3)","decl":{"start":{"line":11,"column":4},"end":{"line":11,"column":5}},"loc":{"start":{"line":11,"column":61},"end":{"line":13,"column":5}},"line":11},"4":{"name":"(anonymous_4)","decl":{"start":{"line":14,"column":4},"end":{"line":14,"column":5}},"loc":{"start":{"line":14,"column":61},"end":{"line":16,"column":5}},"line":14},"5":{"name":"(anonymous_5)","decl":{"start":{"line":15,"column":47},"end":{"line":15,"column":48}},"loc":{"start":{"line":15,"column":52},"end":{"line":15,"column":85}},"line":15},"6":{"name":"(anonymous_6)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":68},"end":{"line":19,"column":5}},"line":17},"7":{"name":"(anonymous_7)","decl":{"start":{"line":20,"column":4},"end":{"line":20,"column":5}},"loc":{"start":{"line":20,"column":59},"end":{"line":22,"column":5}},"line":20},"8":{"name":"(anonymous_8)","decl":{"start":{"line":23,"column":4},"end":{"line":23,"column":5}},"loc":{"start":{"line":23,"column":63},"end":{"line":25,"column":5}},"line":23},"9":{"name":"(anonymous_9)","decl":{"start":{"line":24,"column":41},"end":{"line":24,"column":42}},"loc":{"start":{"line":24,"column":46},"end":{"line":24,"column":61}},"line":24}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":12,"column":45},"end":{"line":12,"column":104}},"type":"cond-expr","locations":[{"start":{"line":12,"column":62},"end":{"line":12,"column":92}},{"start":{"line":12,"column":95},"end":{"line":12,"column":104}}],"line":12}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":3,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"f":{"0":1,"1":3,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/watcher.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/watcher.ts"],"names":[],"mappings":";;;;;AAIA,8CAAsB;AAET,QAAA,OAAO,GAAG,GAAM,EAAE,CAC7B,CAAC;IACC,0CAAkC,CAChC,KAAyB,EACzB,OAA6B;QAE7B,gBAAgB;IAClB,CAAC;IAED,wCAAiC,CAC/B,KAAyB,EACzB,OAA6B;QAE7B,aAAG,CAAC,GAAG,CACL,KAAK,EACL,UAAU,EACV,KAAK,CAAC,QAAQ,CAAC,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,CAAC,CAAC,OAAO,CAAC,CAC5D,CAAC;IACJ,CAAC;IAED,wCAAiC,CAC/B,KAAyB,EACzB,OAA0B;QAE1B,KAAK,CAAC,QAAQ,GAAG,KAAK,CAAC,QAAQ,CAAC,MAAM,CACpC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,SAAS,KAAK,OAAO,CAAC,SAAS,CACvC,CAAC;IACJ,CAAC;IACD,+CAAoC,CAAC,KAAyB,EAAE,OAAO;QACrE,KAAK,CAAC,QAAQ,GAAG,EAAE,CAAC;IACtB,CAAC;IAED,oCAA+B,CAC7B,KAAyB,EACzB,SAAiB;QAEjB,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,SAAS,CAAC,CAAC;IAC9C,CAAC;IAED,wCAAiC,CAC/B,KAAyB,EACzB,SAAiB;QAEjB,KAAK,CAAC,KAAK,GAAG,KAAK,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,SAAS,CAAC,CAAC;IACzD,CAAC;CACmC,CAAA,CAAC","sourcesContent":["import { IFiremodelState } from \"../../index\";\nimport { IFmWatcherStopped, IWatcherEventContext } from \"firemodel\";\nimport { FmConfigMutation } from \"../../types/mutations/FmConfigMutation\";\nimport { MutationTree } from \"vuex\";\nimport Vue from \"vue\";\n\nexport const watcher = <T>() =>\n  ({\n    [FmConfigMutation.watcherStarting](\n      state: IFiremodelState<T>,\n      payload: IWatcherEventContext\n    ) {\n      // nothing to do\n    },\n\n    [FmConfigMutation.watcherStarted](\n      state: IFiremodelState<T>,\n      payload: IWatcherEventContext\n    ) {\n      Vue.set(\n        state,\n        \"watching\",\n        state.watching ? state.watching.concat(payload) : [payload]\n      );\n    },\n\n    [FmConfigMutation.watcherStopped](\n      state: IFiremodelState<T>,\n      payload: IFmWatcherStopped\n    ) {\n      state.watching = state.watching.filter(\n        i => i.watcherId !== payload.watcherId\n      );\n    },\n    [FmConfigMutation.watcherAllStopped](state: IFiremodelState<T>, payload) {\n      state.watching = [];\n    },\n\n    [FmConfigMutation.watcherMuted](\n      state: IFiremodelState<T>,\n      watcherId: string\n    ) {\n      state.muted = state.muted.concat(watcherId);\n    },\n\n    [FmConfigMutation.watcherUnmuted](\n      state: IFiremodelState<T>,\n      watcherId: string\n    ) {\n      state.muted = state.muted.filter(i => i !== watcherId);\n    }\n  } as MutationTree<IFiremodelState<T>>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"cb7e8113e04c72cc9f4d9d7ea2554d2c6335faf7","contentHash":"3340c89fd6e2551aa4d52585e94771804aa89ad929b23054a8b159b34764bccd"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/localCrud.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/localCrud.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":14},"end":{"line":6,"column":45}},"4":{"start":{"line":7,"column":0},"end":{"line":19,"column":3}},"5":{"start":{"line":7,"column":27},"end":{"line":19,"column":1}},"6":{"start":{"line":9,"column":8},"end":{"line":9,"column":135}},"7":{"start":{"line":12,"column":8},"end":{"line":12,"column":135}},"8":{"start":{"line":15,"column":26},"end":{"line":15,"column":60}},"9":{"start":{"line":16,"column":8},"end":{"line":16,"column":48}},"10":{"start":{"line":17,"column":8},"end":{"line":17,"column":57}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":20},"end":{"line":7,"column":21}},"loc":{"start":{"line":7,"column":27},"end":{"line":19,"column":1}},"line":7},"2":{"name":"(anonymous_2)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":57},"end":{"line":10,"column":5}},"line":8},"3":{"name":"(anonymous_3)","decl":{"start":{"line":11,"column":4},"end":{"line":11,"column":5}},"loc":{"start":{"line":11,"column":61},"end":{"line":13,"column":5}},"line":11},"4":{"name":"(anonymous_4)","decl":{"start":{"line":14,"column":4},"end":{"line":14,"column":5}},"loc":{"start":{"line":14,"column":61},"end":{"line":18,"column":5}},"line":14}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":3,"6":0,"7":0,"8":0,"9":0,"10":0},"f":{"0":1,"1":3,"2":0,"3":0,"4":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/localCrud.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/localCrud.ts"],"names":[],"mappings":";;;;;AAIA,8CAAsB;AAET,QAAA,SAAS,GAAG,GAAM,EAAE,CAC/B,CAAC;IACC,oCAA6B,CAAC,KAAK,EAAE,OAA+B;QAClE,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,kCACrB,KAAK,CAAC,SAAS,KAClB,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE,OAAO,IAChC,CAAC;IACL,CAAC;IAED,wCAA+B,CAAC,KAAK,EAAE,OAA+B;QACpE,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,kCACrB,KAAK,CAAC,SAAS,KAClB,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE,OAAO,IAChC,CAAC;IACL,CAAC;IAED,wCAA+B,CAAC,KAAK,EAAE,OAA+B;QACpE,MAAM,SAAS,iBAAgC,EAAE,EAAK,KAAK,CAAC,SAAS,CAAE,CAAC;QACxE,OAAO,SAAS,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;QAExC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;IACzC,CAAC;CACmC,CAAA,CAAC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { IFiremodelState } from \"../..\";\nimport { FmCrudMutation } from \"../../types/mutations/FmCrudMutation\";\nimport { IFmLocalRecordEvent } from \"firemodel\";\nimport Vue from \"vue\";\n\nexport const localCrud = <T>() =>\n  ({\n    [FmCrudMutation.addedLocally](state, payload: IFmLocalRecordEvent<T>) {\n      Vue.set(state, \"localOnly\", {\n        ...state.localOnly,\n        [payload.transactionId]: payload\n      });\n    },\n\n    [FmCrudMutation.changedLocally](state, payload: IFmLocalRecordEvent<T>) {\n      Vue.set(state, \"localOnly\", {\n        ...state.localOnly,\n        [payload.transactionId]: payload\n      });\n    },\n\n    [FmCrudMutation.removedLocally](state, payload: IFmLocalRecordEvent<T>) {\n      const localOnly: typeof state.localOnly = { ...{}, ...state.localOnly };\n      delete localOnly[payload.transactionId];\n\n      Vue.set(state, \"localOnly\", localOnly);\n    }\n  } as MutationTree<IFiremodelState<T>>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3fcb2b36dba4cb09177ea5b3ebe36f0356ee4e98","contentHash":"a4ed74b1180fd4035010bc48bd40a8cb4cc64cd8f1013d7410df269623221a8a"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/errors.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/errors.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":7,"column":0},"end":{"line":11,"column":3}},"2":{"start":{"line":7,"column":32},"end":{"line":11,"column":1}},"3":{"start":{"line":9,"column":8},"end":{"line":9,"column":71}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":7,"column":25},"end":{"line":7,"column":26}},"loc":{"start":{"line":7,"column":32},"end":{"line":11,"column":1}},"line":7},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":22},"end":{"line":10,"column":5}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":9,"column":23},"end":{"line":9,"column":70}},"type":"cond-expr","locations":[{"start":{"line":9,"column":38},"end":{"line":9,"column":62}},{"start":{"line":9,"column":65},"end":{"line":9,"column":70}}],"line":9}},"s":{"0":1,"1":1,"2":3,"3":0},"f":{"0":3,"1":0},"b":{"0":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/errors.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/errors.ts"],"names":[],"mappings":";;AAGA;;;GAGG;AACU,QAAA,cAAc,GAAG,GAAM,EAAE,CACpC,CAAC;IACC,KAAK,CAAC,KAAK,EAAE,GAAG;QACd,KAAK,CAAC,MAAM,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,CAAC,MAAM,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,GAAG,CAAC,CAAC;IACjE,CAAC;CACmC,CAAA,CAAC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { IFiremodelState } from \"../../types/firemodel\";\n\n/**\n * The **mutations** associated to errors encountered during the\n * plugin's execution.\n */\nexport const errorMutations = <T>() =>\n  ({\n    error(state, err) {\n      state.errors = state.errors ? state.errors.concat(err) : [err];\n    }\n  } as MutationTree<IFiremodelState<T>>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"25455fed8a7545d44389656311e7da0ca9930613","contentHash":"6c62c8bb67d34ad44d3b96346ff1e1905b4711213164155938fcbdc02abe4691"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/relationships.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/relationships.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":14},"end":{"line":6,"column":45}},"4":{"start":{"line":7,"column":0},"end":{"line":54,"column":3}},"5":{"start":{"line":7,"column":31},"end":{"line":54,"column":1}},"6":{"start":{"line":10,"column":8},"end":{"line":10,"column":135}},"7":{"start":{"line":13,"column":8},"end":{"line":13,"column":135}},"8":{"start":{"line":16,"column":8},"end":{"line":16,"column":135}},"9":{"start":{"line":20,"column":30},"end":{"line":20,"column":51}},"10":{"start":{"line":21,"column":26},"end":{"line":21,"column":60}},"11":{"start":{"line":22,"column":8},"end":{"line":22,"column":40}},"12":{"start":{"line":23,"column":8},"end":{"line":23,"column":57}},"13":{"start":{"line":26,"column":30},"end":{"line":26,"column":51}},"14":{"start":{"line":27,"column":26},"end":{"line":27,"column":60}},"15":{"start":{"line":28,"column":8},"end":{"line":28,"column":40}},"16":{"start":{"line":29,"column":8},"end":{"line":29,"column":57}},"17":{"start":{"line":32,"column":30},"end":{"line":32,"column":51}},"18":{"start":{"line":33,"column":26},"end":{"line":33,"column":60}},"19":{"start":{"line":34,"column":8},"end":{"line":34,"column":40}},"20":{"start":{"line":35,"column":8},"end":{"line":35,"column":57}},"21":{"start":{"line":46,"column":8},"end":{"line":46,"column":54}},"22":{"start":{"line":49,"column":8},"end":{"line":49,"column":54}},"23":{"start":{"line":52,"column":8},"end":{"line":52,"column":54}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":24},"end":{"line":7,"column":25}},"loc":{"start":{"line":7,"column":31},"end":{"line":54,"column":1}},"line":7},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":4},"end":{"line":9,"column":5}},"loc":{"start":{"line":9,"column":82},"end":{"line":11,"column":5}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":12,"column":4},"end":{"line":12,"column":5}},"loc":{"start":{"line":12,"column":78},"end":{"line":14,"column":5}},"line":12},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":86},"end":{"line":17,"column":5}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":19,"column":4},"end":{"line":19,"column":5}},"loc":{"start":{"line":19,"column":90},"end":{"line":24,"column":5}},"line":19},"6":{"name":"(anonymous_6)","decl":{"start":{"line":25,"column":4},"end":{"line":25,"column":5}},"loc":{"start":{"line":25,"column":96},"end":{"line":30,"column":5}},"line":25},"7":{"name":"(anonymous_7)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":88},"end":{"line":36,"column":5}},"line":31},"8":{"name":"(anonymous_8)","decl":{"start":{"line":45,"column":4},"end":{"line":45,"column":5}},"loc":{"start":{"line":45,"column":82},"end":{"line":47,"column":5}},"line":45},"9":{"name":"(anonymous_9)","decl":{"start":{"line":48,"column":4},"end":{"line":48,"column":5}},"loc":{"start":{"line":48,"column":88},"end":{"line":50,"column":5}},"line":48},"10":{"name":"(anonymous_10)","decl":{"start":{"line":51,"column":4},"end":{"line":51,"column":5}},"loc":{"start":{"line":51,"column":80},"end":{"line":53,"column":5}},"line":51}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":3,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0},"f":{"0":1,"1":3,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/relationships.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/mutations/relationships.ts"],"names":[],"mappings":";;;;;AAIA,8CAAsB;AAET,QAAA,aAAa,GAAG,GAAM,EAAE,CACnC,CAAC;IACC,QAAQ;IACR,6DAAyC,CACvC,KAAK,EACL,OAAqC;QAErC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,kCACrB,KAAK,CAAC,SAAS,KAClB,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE,OAAO,IAChC,CAAC;IACL,CAAC;IAED,yDAAuC,CACrC,KAAK,EACL,OAAqC;QAErC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,kCACrB,KAAK,CAAC,SAAS,KAClB,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE,OAAO,IAChC,CAAC;IACL,CAAC;IAED,iEAA2C,CACzC,KAAK,EACL,OAAqC;QAErC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,kCACrB,KAAK,CAAC,SAAS,KAClB,CAAC,OAAO,CAAC,aAAa,CAAC,EAAE,OAAO,IAChC,CAAC;IACL,CAAC;IAED,eAAe;IACf,qEAA4C,CAC1C,KAAK,EACL,OAAqC;QAErC,MAAM,aAAa,GAAG,OAAO,CAAC,aAAa,CAAC;QAC5C,MAAM,SAAS,iBAAgC,EAAE,EAAK,KAAK,CAAC,SAAS,CAAE,CAAC;QACxE,OAAO,SAAS,CAAC,aAAa,CAAC,CAAC;QAChC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;IACzC,CAAC;IACD,2EAAgD,CAC9C,KAAK,EACL,OAAqC;QAErC,MAAM,aAAa,GAAG,OAAO,CAAC,aAAa,CAAC;QAC5C,MAAM,SAAS,iBAAgC,EAAE,EAAK,KAAK,CAAC,SAAS,CAAE,CAAC;QACxE,OAAO,SAAS,CAAC,aAAa,CAAC,CAAC;QAChC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;IACzC,CAAC;IACD,mEAA4C,CAC1C,KAAK,EACL,OAAqC;QAErC,MAAM,aAAa,GAAG,OAAO,CAAC,aAAa,CAAC;QAC5C,MAAM,SAAS,iBAAgC,EAAE,EAAK,KAAK,CAAC,SAAS,CAAE,CAAC;QACxE,OAAO,SAAS,CAAC,aAAa,CAAC,CAAC;QAChC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,WAAW,EAAE,SAAS,CAAC,CAAC;IACzC,CAAC;IAED,WAAW;IACX;;;;;;OAMG;IACH,6DAAwC,CACtC,KAAK,EACL,OAAqC;QAErC,OAAO,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;IAChD,CAAC;IACD,mEAA4C,CAC1C,KAAK,EACL,OAAqC;QAErC,OAAO,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;IAChD,CAAC;IACD,2DAAwC,CACtC,KAAK,EACL,OAAqC;QAErC,OAAO,KAAK,CAAC,SAAS,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;IAChD,CAAC;CACmC,CAAA,CAAC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { IFiremodelState } from \"../../index\";\nimport { FmCrudMutation } from \"../../types/mutations/FmCrudMutation\";\nimport { IFmLocalRelationshipEvent } from \"firemodel\";\nimport Vue from \"vue\";\n\nexport const relationships = <T>() =>\n  ({\n    // LOCAL\n    [FmCrudMutation.relationshipAddedLocally](\n      state,\n      payload: IFmLocalRelationshipEvent<T>\n    ) {\n      Vue.set(state, \"localOnly\", {\n        ...state.localOnly,\n        [payload.transactionId]: payload\n      });\n    },\n\n    [FmCrudMutation.relationshipSetLocally](\n      state,\n      payload: IFmLocalRelationshipEvent<T>\n    ) {\n      Vue.set(state, \"localOnly\", {\n        ...state.localOnly,\n        [payload.transactionId]: payload\n      });\n    },\n\n    [FmCrudMutation.relationshipRemovedLocally](\n      state,\n      payload: IFmLocalRelationshipEvent<T>\n    ) {\n      Vue.set(state, \"localOnly\", {\n        ...state.localOnly,\n        [payload.transactionId]: payload\n      });\n    },\n\n    // CONFIRMATION\n    [FmCrudMutation.relationshipAddConfirmation](\n      state,\n      payload: IFmLocalRelationshipEvent<T>\n    ) {\n      const transactionId = payload.transactionId;\n      const localOnly: typeof state.localOnly = { ...{}, ...state.localOnly };\n      delete localOnly[transactionId];\n      Vue.set(state, \"localOnly\", localOnly);\n    },\n    [FmCrudMutation.relationshipRemovedConfirmation](\n      state,\n      payload: IFmLocalRelationshipEvent<T>\n    ) {\n      const transactionId = payload.transactionId;\n      const localOnly: typeof state.localOnly = { ...{}, ...state.localOnly };\n      delete localOnly[transactionId];\n      Vue.set(state, \"localOnly\", localOnly);\n    },\n    [FmCrudMutation.relationshipSetConfirmation](\n      state,\n      payload: IFmLocalRelationshipEvent<T>\n    ) {\n      const transactionId = payload.transactionId;\n      const localOnly: typeof state.localOnly = { ...{}, ...state.localOnly };\n      delete localOnly[transactionId];\n      Vue.set(state, \"localOnly\", localOnly);\n    },\n\n    // ROLLBACK\n    /**\n     * Note: this and all rollback mutations remove their\n     * entry from the `localOnly` state hash because the\n     * action which called this will have ensured that the\n     * actual properties that had been set locally were rolled\n     * back already\n     */\n    [FmCrudMutation.relationshipAddRollback](\n      state,\n      payload: IFmLocalRelationshipEvent<T>\n    ) {\n      delete state.localOnly[payload.transactionId];\n    },\n    [FmCrudMutation.relationshipRemovedRollback](\n      state,\n      payload: IFmLocalRelationshipEvent<T>\n    ) {\n      delete state.localOnly[payload.transactionId];\n    },\n    [FmCrudMutation.relationshipSetRollback](\n      state,\n      payload: IFmLocalRelationshipEvent<T>\n    ) {\n      delete state.localOnly[payload.transactionId];\n    }\n  } as MutationTree<IFiremodelState<T>>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6e1ffa871bf7b7cc4ae4ccbfb923161ba470da06","contentHash":"79524d674f767d8e2d46cf8a987b3bf6ff7abc1c69d92d2529ac2f9a14f0a721"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/actions.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/actions.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":16},"end":{"line":3,"column":51}},"2":{"start":{"line":4,"column":24},"end":{"line":4,"column":63}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":120}},"4":{"start":{"line":5,"column":25},"end":{"line":5,"column":118}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":18},"end":{"line":5,"column":19}},"loc":{"start":{"line":5,"column":25},"end":{"line":5,"column":118}},"line":5}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":3},"f":{"0":3},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/actions.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/actions.ts"],"names":[],"mappings":";;AAAA,oDAA4D;AAC5D,gEAA6D;AAIhD,QAAA,OAAO,GAAG,GAAM,EAAE,CAC7B,CAAC,gCACI,wBAAgB,EAAK,GACrB,6BAAa,EAAK,CACgB,CAAA,CAAC","sourcesContent":["import { firemodelActions } from \"./firemodelActions/index\";\nimport { pluginActions } from \"./localActions/pluginActions\";\nimport { ActionTree } from \"vuex\";\nimport { IFiremodelState } from \"../types\";\n\nexport const actions = <T>() =>\n  ({\n    ...firemodelActions<T>(),\n    ...pluginActions<T>()\n  } as ActionTree<IFiremodelState<T>, T>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d408206c716d6e97fd7b9d70fa51010385a88d3a","contentHash":"e0c351343bccecdc58e313f6c69d5ab9bf237c8c07897307ec71ca1bc311f678"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":30},"end":{"line":3,"column":62}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":34}},"3":{"start":{"line":5,"column":23},"end":{"line":5,"column":48}},"4":{"start":{"line":6,"column":22},"end":{"line":6,"column":46}},"5":{"start":{"line":7,"column":25},"end":{"line":7,"column":52}},"6":{"start":{"line":8,"column":26},"end":{"line":8,"column":54}},"7":{"start":{"line":9,"column":15},"end":{"line":9,"column":32}},"8":{"start":{"line":10,"column":17},"end":{"line":10,"column":36}},"9":{"start":{"line":11,"column":16},"end":{"line":11,"column":34}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":447}},"11":{"start":{"line":12,"column":33},"end":{"line":12,"column":446}},"12":{"start":{"line":14,"column":18},"end":{"line":14,"column":20}},"13":{"start":{"line":15,"column":4},"end":{"line":17,"column":7}},"14":{"start":{"line":16,"column":8},"end":{"line":16,"column":60}},"15":{"start":{"line":18,"column":4},"end":{"line":18,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":27},"end":{"line":12,"column":28}},"loc":{"start":{"line":12,"column":33},"end":{"line":12,"column":446}},"line":12},"1":{"name":"stripNamespaceFromKeys","decl":{"start":{"line":13,"column":9},"end":{"line":13,"column":31}},"loc":{"start":{"line":13,"column":40},"end":{"line":19,"column":1}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":15,"column":32},"end":{"line":15,"column":33}},"loc":{"start":{"line":15,"column":39},"end":{"line":17,"column":5}},"line":15}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":3,"12":3,"13":3,"14":120,"15":3},"f":{"0":3,"1":3,"2":120},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/index.ts"],"names":[],"mappings":";;AAAA,+DAA4D;AAG5D,mCAAgC;AAChC,iDAA8C;AAC9C,+CAA4C;AAC5C,qDAAkD;AAClD,uDAAoD;AACpD,iCAAqC;AACrC,qCAAkC;AAClC,mCAAgC;AAEnB,QAAA,gBAAgB,GAAG,GAAM,EAAE,CACtC,sBAAsB,mIACjB,eAAM,EAAK,GACX,kBAAW,EAAK,GAChB,yCAAmB,EAAK,GACxB,yBAAW,EAAK,GAChB,+BAAc,EAAK,GACnB,iCAAe,EAAK,GACpB,aAAK,EAAK,GACV,2BAAY,EAAK,GACjB,aAAK,EAAK,EACwB,CAAC;AAE1C,SAAS,sBAAsB,CAAI,MAAyC;IAC1E,MAAM,KAAK,GAAsC,EAAE,CAAC;IACpD,MAAM,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;QAChC,KAAK,CAAC,GAAG,CAAC,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;IACtD,CAAC,CAAC,CAAC;IAEH,OAAO,KAAK,CAAC;AACf,CAAC","sourcesContent":["import { recordServerChanges } from \"./recordServerChanges\";\nimport { ActionTree } from \"vuex\";\nimport { IFiremodelState } from \"../..\";\nimport { watch } from \"./watch\";\nimport { relationship } from \"./relationship\";\nimport { recordLocal } from \"./recordLocal\";\nimport { recordConfirms } from \"./recordConfirms\";\nimport { recordRollbacks } from \"./recordRollbacks\";\nimport { authActions } from \"./auth\";\nimport { errors } from \"./errors\";\nimport { other } from \"./other\";\n\nexport const firemodelActions = <T>() =>\n  stripNamespaceFromKeys<T>({\n    ...errors<T>(),\n    ...authActions<T>(),\n    ...recordServerChanges<T>(),\n    ...recordLocal<T>(),\n    ...recordConfirms<T>(),\n    ...recordRollbacks<T>(),\n    ...watch<T>(),\n    ...relationship<T>(),\n    ...other<T>()\n  }) as ActionTree<IFiremodelState<T>, T>;\n\nfunction stripNamespaceFromKeys<T>(global: ActionTree<IFiremodelState<T>, T>) {\n  const local: ActionTree<IFiremodelState<T>, T> = {};\n  Object.keys(global).forEach(key => {\n    local[key.replace(\"@firemodel/\", \"\")] = global[key];\n  });\n\n  return local;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4cbdb6ad75e30cde56088d42be5e136f5fd07776","contentHash":"15e843a687b18570b74d1e07dd99fff93f70c5dc383be8b15cdbdd358b6cc83f"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordServerChanges.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordServerChanges.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":40}},"2":{"start":{"line":4,"column":34},"end":{"line":4,"column":81}},"3":{"start":{"line":5,"column":0},"end":{"line":36,"column":3}},"4":{"start":{"line":5,"column":37},"end":{"line":36,"column":1}},"5":{"start":{"line":7,"column":8},"end":{"line":16,"column":9}},"6":{"start":{"line":8,"column":12},"end":{"line":15,"column":13}},"7":{"start":{"line":9,"column":16},"end":{"line":11,"column":19}},"8":{"start":{"line":14,"column":16},"end":{"line":14,"column":199}},"9":{"start":{"line":19,"column":8},"end":{"line":21,"column":11}},"10":{"start":{"line":24,"column":8},"end":{"line":24,"column":68}},"11":{"start":{"line":27,"column":8},"end":{"line":34,"column":9}},"12":{"start":{"line":28,"column":12},"end":{"line":30,"column":15}},"13":{"start":{"line":33,"column":12},"end":{"line":33,"column":196}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":30},"end":{"line":5,"column":31}},"loc":{"start":{"line":5,"column":37},"end":{"line":36,"column":1}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":68},"end":{"line":17,"column":5}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":18,"column":4},"end":{"line":18,"column":5}},"loc":{"start":{"line":18,"column":63},"end":{"line":22,"column":5}},"line":18},"3":{"name":"(anonymous_3)","decl":{"start":{"line":23,"column":4},"end":{"line":23,"column":5}},"loc":{"start":{"line":23,"column":61},"end":{"line":25,"column":5}},"line":23},"4":{"name":"(anonymous_4)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":63},"end":{"line":35,"column":5}},"line":26}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":8},"end":{"line":16,"column":9}},"type":"if","locations":[{"start":{"line":7,"column":8},"end":{"line":16,"column":9}},{"start":{"line":7,"column":8},"end":{"line":16,"column":9}}],"line":7}},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"f":{"0":3,"1":0,"2":0,"3":0,"4":0},"b":{"0":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordServerChanges.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordServerChanges.ts"],"names":[],"mappings":";;AAEA,yCAAoD;AAEpD,kFAA+E;AAElE,QAAA,mBAAmB,GAAG,GAAM,EAAE,CACzC,CAAC;IACC,CAAC,oBAAQ,CAAC,YAAY,CAAC,CAAC,EAAE,MAAM,EAAE,KAAK,EAAE,EAAE,OAAsB;QAC/D,IAAI,CAAC,KAAK,CAAC,KAAK,CAAC,QAAQ,CAAC,OAAO,CAAC,SAAS,CAAC,EAAE;YAC5C,IAAI;gBACF,MAAM,CACJ,iDAAuB,CAAC,OAAO,+BAA2B,EAC1D,OAAO,EACP;oBACE,IAAI,EAAE,IAAI;iBACX,CACF,CAAC;aACH;YAAC,OAAO,CAAC,EAAE;gBACV,OAAO,CAAC,KAAK,CACX,yBAAyB,iDAAuB,CAC9C,OAAO,+BAER,kBAAkB,OAAO,kBAAkB,CAAC,CAAC,OAAO,EAAE,CACxD,CAAC;aACH;SACF;IACH,CAAC;IAED,CAAC,oBAAQ,CAAC,cAAc,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,OAAO;QAC3C,MAAM,CACJ,iDAAuB,CAAC,OAAO,qCAA8B,EAC7D,OAAO,EACP;YACE,IAAI,EAAE,IAAI;SACX,CACF,CAAC;IACJ,CAAC;IAED,CAAC,oBAAQ,CAAC,YAAY,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,OAAO;QACzC,OAAO,CAAC,IAAI,CAAC,oCAAoC,EAAE,OAAO,CAAC,CAAC;IAC9D,CAAC;IAED,CAAC,oBAAQ,CAAC,cAAc,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,OAAsB;QAC1D,IAAI;YACF,MAAM,CACJ,iDAAuB,CAAC,OAAO,qCAA8B,EAC7D,OAAO,EACP;gBACE,IAAI,EAAE,IAAI;aACX,CACF,CAAC;SACH;QAAC,OAAO,CAAC,EAAE;YACV,OAAO,CAAC,KAAK,CACX,yBAAyB,iDAAuB,CAC9C,OAAO,+BAER,kBAAkB,OAAO,mBAAmB,CAAC,CAAC,OAAO,EAAE,CACzD,CAAC;SACH;IACH,CAAC;CACoC,CAAA,CAAC","sourcesContent":["import { ActionTree } from \"vuex\";\nimport { IFiremodelState } from \"../../index\";\nimport { FmEvents, IFmWatchEvent } from \"firemodel\";\nimport { FmCrudMutation } from \"../../types/mutations/FmCrudMutation\";\nimport { determineLocalStateNode } from \"../../shared/determineLocalStateNode\";\n\nexport const recordServerChanges = <T>() =>\n  ({\n    [FmEvents.RECORD_ADDED]({ commit, state }, payload: IFmWatchEvent) {\n      if (!state.muted.includes(payload.watcherId)) {\n        try {\n          commit(\n            determineLocalStateNode(payload, FmCrudMutation.serverAdd),\n            payload,\n            {\n              root: true\n            }\n          );\n        } catch (e) {\n          console.error(\n            `Problem with mutation ${determineLocalStateNode(\n              payload,\n              FmCrudMutation.serverAdd\n            )}. Payload was: ${payload}\\n\\nError was: ${e.message}`\n          );\n        }\n      }\n    },\n\n    [FmEvents.RECORD_REMOVED]({ commit }, payload) {\n      commit(\n        determineLocalStateNode(payload, FmCrudMutation.serverRemove),\n        payload,\n        {\n          root: true\n        }\n      );\n    },\n\n    [FmEvents.RECORD_MOVED]({ commit }, payload) {\n      console.info(\"A RECORD_MOVED action was received\", payload);\n    },\n\n    [FmEvents.RECORD_CHANGED]({ commit }, payload: IFmWatchEvent) {\n      try {\n        commit(\n          determineLocalStateNode(payload, FmCrudMutation.serverChange),\n          payload,\n          {\n            root: true\n          }\n        );\n      } catch (e) {\n        console.error(\n          `Problem with mutation ${determineLocalStateNode(\n            payload,\n            FmCrudMutation.serverAdd\n          )}. Payload was: ${payload}.\\n\\nError was: ${e.message}`\n        );\n      }\n    }\n  } as ActionTree<IFiremodelState<T>, T>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6d7f3cd1a6230b19c707999a7945b2e21022febf","contentHash":"d36de954b6dd0dd6be8a2d15901f25229e7ceb81d91aecccb6939ad72fd48062"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/determineLocalStateNode.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/determineLocalStateNode.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":23},"end":{"line":3,"column":46}},"2":{"start":{"line":11,"column":4},"end":{"line":11,"column":112}},"3":{"start":{"line":13,"column":0},"end":{"line":13,"column":58}}},"fnMap":{"0":{"name":"determineLocalStateNode","decl":{"start":{"line":10,"column":9},"end":{"line":10,"column":32}},"loc":{"start":{"line":10,"column":52},"end":{"line":12,"column":1}},"line":10}},"branchMap":{"0":{"loc":{"start":{"line":11,"column":36},"end":{"line":11,"column":59}},"type":"binary-expr","locations":[{"start":{"line":11,"column":36},"end":{"line":11,"column":53}},{"start":{"line":11,"column":57},"end":{"line":11,"column":59}}],"line":11}},"s":{"0":1,"1":1,"2":0,"3":1},"f":{"0":0},"b":{"0":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/determineLocalStateNode.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/determineLocalStateNode.ts"],"names":[],"mappings":";;AAAA,+CAAwC;AAGxC;;;;;GAKG;AACH,SAAgB,uBAAuB,CACrC,OAAsB,EACtB,QAAgB;IAEhB,OAAO,uBAAQ,CACb,CAAC,OAAO,CAAC,SAAS,IAAI,EAAE,CAAC,CAAC,OAAO,CAAC,IAAI,OAAO,CAAC,YAAY,EAAE,EAAE,EAAE,CAAC,EACjE,QAAQ,CACT,CAAC;AACJ,CAAC;AARD,0DAQC","sourcesContent":["import { pathJoin } from \"common-types\";\nimport { IFmWatchEvent } from \"firemodel\";\n\n/**\n * **pathToState**\n *\n * Takes a **Firemodel** server event and determines the\n * appropriate path to the local state node.\n */\nexport function determineLocalStateNode(\n  payload: IFmWatchEvent,\n  mutation: string\n) {\n  return pathJoin(\n    (payload.localPath || \"\").replace(`/${payload.localPostfix}`, \"\"),\n    mutation\n  );\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4710b648e696c98d668e51095dffc27e6045c525","contentHash":"ede4b14a2acc2cce318970bf31b4478be2de3ab26c5a5d7cd9d7327370ae0093"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/watch.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/watch.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":40}},"2":{"start":{"line":4,"column":34},"end":{"line":4,"column":81}},"3":{"start":{"line":5,"column":0},"end":{"line":33,"column":3}},"4":{"start":{"line":5,"column":23},"end":{"line":33,"column":1}},"5":{"start":{"line":7,"column":8},"end":{"line":7,"column":66}},"6":{"start":{"line":10,"column":8},"end":{"line":10,"column":64}},"7":{"start":{"line":13,"column":8},"end":{"line":13,"column":64}},"8":{"start":{"line":16,"column":8},"end":{"line":16,"column":62}},"9":{"start":{"line":17,"column":8},"end":{"line":17,"column":70}},"10":{"start":{"line":20,"column":8},"end":{"line":20,"column":71}},"11":{"start":{"line":27,"column":8},"end":{"line":27,"column":70}},"12":{"start":{"line":28,"column":8},"end":{"line":28,"column":143}},"13":{"start":{"line":29,"column":8},"end":{"line":31,"column":17}},"14":{"start":{"line":30,"column":12},"end":{"line":30,"column":78}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":16},"end":{"line":5,"column":17}},"loc":{"start":{"line":5,"column":23},"end":{"line":33,"column":1}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":65},"end":{"line":8,"column":5}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":9,"column":4},"end":{"line":9,"column":5}},"loc":{"start":{"line":9,"column":64},"end":{"line":11,"column":5}},"line":9},"3":{"name":"(anonymous_3)","decl":{"start":{"line":12,"column":4},"end":{"line":12,"column":5}},"loc":{"start":{"line":12,"column":64},"end":{"line":14,"column":5}},"line":12},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":4},"end":{"line":15,"column":5}},"loc":{"start":{"line":15,"column":63},"end":{"line":18,"column":5}},"line":15},"5":{"name":"(anonymous_5)","decl":{"start":{"line":19,"column":4},"end":{"line":19,"column":5}},"loc":{"start":{"line":19,"column":68},"end":{"line":21,"column":5}},"line":19},"6":{"name":"(anonymous_6)","decl":{"start":{"line":26,"column":4},"end":{"line":26,"column":5}},"loc":{"start":{"line":26,"column":67},"end":{"line":32,"column":5}},"line":26},"7":{"name":"(anonymous_7)","decl":{"start":{"line":29,"column":19},"end":{"line":29,"column":20}},"loc":{"start":{"line":29,"column":25},"end":{"line":31,"column":9}},"line":29}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0},"f":{"0":3,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/watch.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/watch.ts"],"names":[],"mappings":";;AAEA,yCAAuE;AAGvE,kFAA+E;AAElE,QAAA,KAAK,GAAG,GAAM,EAAE,CAC3B,CAAC;IACC,CAAC,oBAAQ,CAAC,gBAAgB,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,OAAsB;QAC5D,MAAM,2CAAmC,OAAO,CAAC,CAAC;IACpD,CAAC;IAED,CAAC,oBAAQ,CAAC,eAAe,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,OAAsB;QAC3D,MAAM,yCAAkC,OAAO,CAAC,CAAC;IACnD,CAAC;IAED,CAAC,oBAAQ,CAAC,eAAe,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,OAA0B;QAC/D,MAAM,yCAAkC,OAAO,CAAC,CAAC;IACnD,CAAC;IAED,CAAC,oBAAQ,CAAC,cAAc,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,OAA0B;QAC9D,MAAM,uCAAiC,OAAO,CAAC,CAAC;QAChD,OAAO,CAAC,IAAI,CAAC,WAAW,OAAO,CAAC,SAAS,mBAAmB,CAAC,CAAC;IAChE,CAAC;IAED,CAAC,oBAAQ,CAAC,mBAAmB,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,OAAsB;QAC/D,MAAM,gDAAqC,OAAO,CAAC,CAAC;IACtD,CAAC;IAED;;;OAGG;IACH,KAAK,CAAC,CAAC,oBAAQ,CAAC,YAAY,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,OAAsB;QAC9D,MAAM,qCAAgC,OAAO,CAAC,SAAS,CAAC,CAAC;QACzD,MAAM,CACJ,iDAAuB,CAAC,OAAO,4CAAiC,EAChE,OAAO,EACP,EAAE,IAAI,EAAE,IAAI,EAAE,CACf,CAAC;QACF,UAAU,CAAC,GAAG,EAAE;YACd,MAAM,yCAAkC,OAAO,CAAC,SAAS,CAAC,CAAC;QAC7D,CAAC,EAAE,IAAI,CAAC,CAAC;IACX,CAAC;CACoC,CAAA,CAAC","sourcesContent":["import { ActionTree } from \"vuex\";\nimport { IFiremodelState } from \"../../index\";\nimport { FmEvents, IFmWatchEvent, IFmWatcherStopped } from \"firemodel\";\nimport { FmConfigMutation } from \"../../types/mutations/FmConfigMutation\";\nimport { FmCrudMutation } from \"../../types\";\nimport { determineLocalStateNode } from \"../../shared/determineLocalStateNode\";\n\nexport const watch = <T>() =>\n  ({\n    [FmEvents.WATCHER_STARTING]({ commit }, payload: IFmWatchEvent) {\n      commit(FmConfigMutation.watcherStarting, payload);\n    },\n\n    [FmEvents.WATCHER_STARTED]({ commit }, payload: IFmWatchEvent) {\n      commit(FmConfigMutation.watcherStarted, payload);\n    },\n\n    [FmEvents.WATCHER_STOPPED]({ commit }, payload: IFmWatcherStopped) {\n      commit(FmConfigMutation.watcherStopped, payload);\n    },\n\n    [FmEvents.WATCHER_FAILED]({ commit }, payload: IFmWatcherStopped) {\n      commit(FmConfigMutation.watcherFailed, payload);\n      console.warn(`Watcher ${payload.watcherId} failed to start!`);\n    },\n\n    [FmEvents.WATCHER_STOPPED_ALL]({ commit }, payload: IFmWatchEvent) {\n      commit(FmConfigMutation.watcherAllStopped, payload);\n    },\n\n    /**\n     * When getting a SYNC action from a watcher starting, pass this to the\n     * appropriate local state node\n     */\n    async [FmEvents.WATCHER_SYNC]({ commit }, payload: IFmWatchEvent) {\n      commit(FmConfigMutation.watcherMuted, payload.watcherId);\n      commit(\n        determineLocalStateNode(payload, FmCrudMutation.serverStateSync),\n        payload,\n        { root: true }\n      );\n      setTimeout(() => {\n        commit(FmConfigMutation.watcherUnmuted, payload.watcherId);\n      }, 3000);\n    }\n  } as ActionTree<IFiremodelState<T>, T>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"db339db6a289f0cd7f914ec0cee372440a770eac","contentHash":"3e7d80ab4870821bd0aaabeb74c9eb416205a7d4502017467e729bf316d51acd"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/relationship.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/relationship.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":40}},"2":{"start":{"line":4,"column":0},"end":{"line":35,"column":3}},"3":{"start":{"line":4,"column":30},"end":{"line":35,"column":1}},"4":{"start":{"line":6,"column":8},"end":{"line":6,"column":85}},"5":{"start":{"line":9,"column":8},"end":{"line":9,"column":89}},"6":{"start":{"line":12,"column":8},"end":{"line":12,"column":81}},"7":{"start":{"line":15,"column":8},"end":{"line":15,"column":93}},"8":{"start":{"line":18,"column":8},"end":{"line":18,"column":99}},"9":{"start":{"line":21,"column":8},"end":{"line":21,"column":91}},"10":{"start":{"line":25,"column":8},"end":{"line":25,"column":61}},"11":{"start":{"line":29,"column":8},"end":{"line":29,"column":64}},"12":{"start":{"line":33,"column":8},"end":{"line":33,"column":61}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":23},"end":{"line":4,"column":24}},"loc":{"start":{"line":4,"column":30},"end":{"line":35,"column":1}},"line":4},"1":{"name":"(anonymous_1)","decl":{"start":{"line":5,"column":4},"end":{"line":5,"column":5}},"loc":{"start":{"line":5,"column":92},"end":{"line":7,"column":5}},"line":5},"2":{"name":"(anonymous_2)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":94},"end":{"line":10,"column":5}},"line":8},"3":{"name":"(anonymous_3)","decl":{"start":{"line":11,"column":4},"end":{"line":11,"column":5}},"loc":{"start":{"line":11,"column":90},"end":{"line":13,"column":5}},"line":11},"4":{"name":"(anonymous_4)","decl":{"start":{"line":14,"column":4},"end":{"line":14,"column":5}},"loc":{"start":{"line":14,"column":97},"end":{"line":16,"column":5}},"line":14},"5":{"name":"(anonymous_5)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":99},"end":{"line":19,"column":5}},"line":17},"6":{"name":"(anonymous_6)","decl":{"start":{"line":20,"column":4},"end":{"line":20,"column":5}},"loc":{"start":{"line":20,"column":95},"end":{"line":22,"column":5}},"line":20},"7":{"name":"(anonymous_7)","decl":{"start":{"line":23,"column":4},"end":{"line":23,"column":5}},"loc":{"start":{"line":23,"column":93},"end":{"line":26,"column":5}},"line":23},"8":{"name":"(anonymous_8)","decl":{"start":{"line":27,"column":4},"end":{"line":27,"column":5}},"loc":{"start":{"line":27,"column":95},"end":{"line":30,"column":5}},"line":27},"9":{"name":"(anonymous_9)","decl":{"start":{"line":31,"column":4},"end":{"line":31,"column":5}},"loc":{"start":{"line":31,"column":91},"end":{"line":34,"column":5}},"line":31}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":3,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"f":{"0":3,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/relationship.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/relationship.ts"],"names":[],"mappings":";;AAEA,yCAAgE;AAGnD,QAAA,YAAY,GAAG,GAAM,EAAE,CAClC,CAAC;IACC,KAAK,CAAC,CAAC,oBAAQ,CAAC,0BAA0B,CAAC,CACzC,EAAE,MAAM,EAAE,SAAS,EAAE,EACrB,OAAkC;QAElC,MAAM,8DAA0C,OAAO,CAAC,CAAC;IAC3D,CAAC;IACD,KAAK,CAAC,CAAC,oBAAQ,CAAC,4BAA4B,CAAC,CAC3C,EAAE,MAAM,EAAE,SAAS,EAAE,EACrB,OAAkC;QAElC,MAAM,kEAA4C,OAAO,CAAC,CAAC;IAC7D,CAAC;IACD,KAAK,CAAC,CAAC,oBAAQ,CAAC,wBAAwB,CAAC,CACvC,EAAE,MAAM,EAAE,SAAS,EAAE,EACrB,OAAkC;QAElC,MAAM,0DAAwC,OAAO,CAAC,CAAC;IACzD,CAAC;IAED,KAAK,CAAC,CAAC,oBAAQ,CAAC,+BAA+B,CAAC,CAC9C,EAAE,MAAM,EAAE,SAAS,EAAE,EACrB,OAAkC;QAElC,MAAM,sEAA6C,OAAO,CAAC,CAAC;IAC9D,CAAC;IACD,KAAK,CAAC,CAAC,oBAAQ,CAAC,iCAAiC,CAAC,CAChD,EAAE,MAAM,EAAE,SAAS,EAAE,EACrB,OAAkC;QAElC,MAAM,4EAAiD,OAAO,CAAC,CAAC;IAClE,CAAC;IACD,KAAK,CAAC,CAAC,oBAAQ,CAAC,6BAA6B,CAAC,CAC5C,EAAE,MAAM,EAAE,SAAS,EAAE,EACrB,OAAkC;QAElC,MAAM,oEAA6C,OAAO,CAAC,CAAC;IAC9D,CAAC;IAED,KAAK,CAAC,CAAC,oBAAQ,CAAC,2BAA2B,CAAC,CAC1C,EAAE,MAAM,EAAE,SAAS,EAAE,EACrB,OAAkC;QAElC,kBAAkB;QAClB,OAAO,CAAC,GAAG,CAAC,8BAA8B,EAAE,OAAO,CAAC,CAAC;IACvD,CAAC;IACD,KAAK,CAAC,CAAC,oBAAQ,CAAC,6BAA6B,CAAC,CAC5C,EAAE,MAAM,EAAE,SAAS,EAAE,EACrB,OAAkC;QAElC,kBAAkB;QAClB,OAAO,CAAC,GAAG,CAAC,iCAAiC,EAAE,OAAO,CAAC,CAAC;IAC1D,CAAC;IACD,KAAK,CAAC,CAAC,oBAAQ,CAAC,yBAAyB,CAAC,CACxC,EAAE,MAAM,EAAE,SAAS,EAAE,EACrB,OAAkC;QAElC,kBAAkB;QAClB,OAAO,CAAC,GAAG,CAAC,8BAA8B,EAAE,OAAO,CAAC,CAAC;IACvD,CAAC;CACoC,CAAA,CAAC","sourcesContent":["import { ActionTree } from \"vuex\";\nimport { IFiremodelState } from \"../../index\";\nimport { FmEvents, IFmLocalRelationshipEvent } from \"firemodel\";\nimport { FmCrudMutation } from \"../../types/mutations/FmCrudMutation\";\n\nexport const relationship = <T>() =>\n  ({\n    async [FmEvents.RELATIONSHIP_ADDED_LOCALLY](\n      { commit, rootState },\n      payload: IFmLocalRelationshipEvent\n    ) {\n      commit(FmCrudMutation.relationshipAddedLocally, payload);\n    },\n    async [FmEvents.RELATIONSHIP_REMOVED_LOCALLY](\n      { commit, rootState },\n      payload: IFmLocalRelationshipEvent\n    ) {\n      commit(FmCrudMutation.relationshipRemovedLocally, payload);\n    },\n    async [FmEvents.RELATIONSHIP_SET_LOCALLY](\n      { commit, rootState },\n      payload: IFmLocalRelationshipEvent\n    ) {\n      commit(FmCrudMutation.relationshipSetLocally, payload);\n    },\n\n    async [FmEvents.RELATIONSHIP_ADDED_CONFIRMATION](\n      { commit, rootState },\n      payload: IFmLocalRelationshipEvent\n    ) {\n      commit(FmCrudMutation.relationshipAddConfirmation, payload);\n    },\n    async [FmEvents.RELATIONSHIP_REMOVED_CONFIRMATION](\n      { commit, rootState },\n      payload: IFmLocalRelationshipEvent\n    ) {\n      commit(FmCrudMutation.relationshipRemovedConfirmation, payload);\n    },\n    async [FmEvents.RELATIONSHIP_SET_CONFIRMATION](\n      { commit, rootState },\n      payload: IFmLocalRelationshipEvent\n    ) {\n      commit(FmCrudMutation.relationshipSetConfirmation, payload);\n    },\n\n    async [FmEvents.RELATIONSHIP_ADDED_ROLLBACK](\n      { commit, rootState },\n      payload: IFmLocalRelationshipEvent\n    ) {\n      // TODO: implement\n      console.log(\"relationship add rolled back\", payload);\n    },\n    async [FmEvents.RELATIONSHIP_REMOVED_ROLLBACK](\n      { commit, rootState },\n      payload: IFmLocalRelationshipEvent\n    ) {\n      // TODO: implement\n      console.log(\"relationship remove rolled back\", payload);\n    },\n    async [FmEvents.RELATIONSHIP_SET_ROLLBACK](\n      { commit, rootState },\n      payload: IFmLocalRelationshipEvent\n    ) {\n      // TODO: implement\n      console.log(\"relationship set rolled back\", payload);\n    }\n  } as ActionTree<IFiremodelState<T>, T>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2f02d102c13b9e9cf5f1c461209eb311c8cf4a6f","contentHash":"b4d0bd0aec75f405c68e8a7db531b8f7ea7aa81368059dd8e8f3b04ff990b796"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordLocal.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordLocal.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":20},"end":{"line":6,"column":40}},"4":{"start":{"line":7,"column":21},"end":{"line":7,"column":59}},"5":{"start":{"line":8,"column":34},"end":{"line":8,"column":81}},"6":{"start":{"line":9,"column":0},"end":{"line":30,"column":3}},"7":{"start":{"line":9,"column":29},"end":{"line":30,"column":1}},"8":{"start":{"line":11,"column":28},"end":{"line":11,"column":137}},"9":{"start":{"line":12,"column":8},"end":{"line":12,"column":68}},"10":{"start":{"line":13,"column":8},"end":{"line":15,"column":11}},"11":{"start":{"line":18,"column":28},"end":{"line":18,"column":137}},"12":{"start":{"line":19,"column":8},"end":{"line":19,"column":64}},"13":{"start":{"line":20,"column":8},"end":{"line":22,"column":11}},"14":{"start":{"line":25,"column":8},"end":{"line":25,"column":64}},"15":{"start":{"line":26,"column":8},"end":{"line":28,"column":11}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":22},"end":{"line":9,"column":23}},"loc":{"start":{"line":9,"column":29},"end":{"line":30,"column":1}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":10,"column":4},"end":{"line":10,"column":5}},"loc":{"start":{"line":10,"column":88},"end":{"line":16,"column":5}},"line":10},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":86},"end":{"line":23,"column":5}},"line":17},"4":{"name":"(anonymous_4)","decl":{"start":{"line":24,"column":4},"end":{"line":24,"column":5}},"loc":{"start":{"line":24,"column":77},"end":{"line":29,"column":5}},"line":24}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":3,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"f":{"0":1,"1":3,"2":0,"3":0,"4":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordLocal.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordLocal.ts"],"names":[],"mappings":";;;;;AAEA,yCAAoD;AACpD,4DAA6B;AAE7B,kFAA+E;AAElE,QAAA,WAAW,GAAG,GAAM,EAAE,CACjC,CAAC;IACC,KAAK,CAAC,CAAC,oBAAQ,CAAC,sBAAsB,CAAC,CACrC,EAAE,MAAM,EAAE,SAAS,EAAE,EACrB,OAAsB;QAEtB,MAAM,WAAW,mCACZ,OAAO,KACV,UAAU,EAAE,oBAAG,CAAC,SAAS,EAAE,OAAO,CAAC,SAAS,CAAC,GAC9C,CAAC;QACF,MAAM,yCAAgC,WAAW,CAAC,CAAC;QACnD,MAAM,CACJ,iDAAuB,CAAC,OAAO,yCAAgC,EAC/D,WAAW,EACX;YACE,IAAI,EAAE,IAAI;SACX,CACF,CAAC;IACJ,CAAC;IAED,KAAK,CAAC,CAAC,oBAAQ,CAAC,oBAAoB,CAAC,CACnC,EAAE,MAAM,EAAE,SAAS,EAAE,EACrB,OAAsB;QAEtB,MAAM,WAAW,mCACZ,OAAO,KACV,UAAU,EAAE,oBAAG,CAAC,SAAS,EAAE,OAAO,CAAC,SAAS,CAAC,GAC9C,CAAC;QACF,MAAM,qCAA8B,WAAW,CAAC,CAAC;QACjD,MAAM,CACJ,iDAAuB,CAAC,OAAO,qCAA8B,EAC7D,WAAW,EACX;YACE,IAAI,EAAE,IAAI;SACX,CACF,CAAC;IACJ,CAAC;IAED,KAAK,CAAC,CAAC,oBAAQ,CAAC,sBAAsB,CAAC,CAAC,EAAE,MAAM,EAAE,EAAE,OAAO;QACzD,MAAM,yCAAgC,OAAO,CAAC,CAAC;QAC/C,MAAM,CACJ,iDAAuB,CAAC,OAAO,yCAAgC,EAC/D,OAAO,EACP;YACE,IAAI,EAAE,IAAI;SACX,CACF,CAAC;IACJ,CAAC;CACoC,CAAA,CAAC","sourcesContent":["import { ActionTree } from \"vuex\";\nimport { IFiremodelState } from \"../../index\";\nimport { FmEvents, IFmWatchEvent } from \"firemodel\";\nimport get from \"lodash.get\";\nimport { FmCrudMutation } from \"../../types/mutations/FmCrudMutation\";\nimport { determineLocalStateNode } from \"../../shared/determineLocalStateNode\";\n\nexport const recordLocal = <T>() =>\n  ({\n    async [FmEvents.RECORD_CHANGED_LOCALLY](\n      { commit, rootState },\n      payload: IFmWatchEvent\n    ) {\n      const payloadPlus = {\n        ...payload,\n        priorValue: get(rootState, payload.localPath)\n      };\n      commit(FmCrudMutation.changedLocally, payloadPlus);\n      commit(\n        determineLocalStateNode(payload, FmCrudMutation.changedLocally),\n        payloadPlus,\n        {\n          root: true\n        }\n      );\n    },\n\n    async [FmEvents.RECORD_ADDED_LOCALLY](\n      { commit, rootState },\n      payload: IFmWatchEvent\n    ) {\n      const payloadPlus = {\n        ...payload,\n        priorValue: get(rootState, payload.localPath)\n      };\n      commit(FmCrudMutation.addedLocally, payloadPlus);\n      commit(\n        determineLocalStateNode(payload, FmCrudMutation.addedLocally),\n        payloadPlus,\n        {\n          root: true\n        }\n      );\n    },\n\n    async [FmEvents.RECORD_REMOVED_LOCALLY]({ commit }, payload) {\n      commit(FmCrudMutation.removedLocally, payload);\n      commit(\n        determineLocalStateNode(payload, FmCrudMutation.removedLocally),\n        payload,\n        {\n          root: true\n        }\n      );\n    }\n  } as ActionTree<IFiremodelState<T>, T>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"07810294d6162bb9c9f42affad597adc63efc5c9","contentHash":"b7ab9b09ed3b764d0da4f4c753a508afbafe3e27f34f731f4eb26470ad7caa03"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordConfirms.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordConfirms.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":40}},"2":{"start":{"line":4,"column":34},"end":{"line":4,"column":81}},"3":{"start":{"line":5,"column":0},"end":{"line":24,"column":3}},"4":{"start":{"line":5,"column":32},"end":{"line":24,"column":1}},"5":{"start":{"line":7,"column":8},"end":{"line":7,"column":67}},"6":{"start":{"line":8,"column":8},"end":{"line":10,"column":11}},"7":{"start":{"line":13,"column":8},"end":{"line":13,"column":73}},"8":{"start":{"line":14,"column":8},"end":{"line":16,"column":11}},"9":{"start":{"line":19,"column":8},"end":{"line":19,"column":73}},"10":{"start":{"line":20,"column":8},"end":{"line":22,"column":11}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":25},"end":{"line":5,"column":26}},"loc":{"start":{"line":5,"column":32},"end":{"line":24,"column":1}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":81},"end":{"line":11,"column":5}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":12,"column":4},"end":{"line":12,"column":5}},"loc":{"start":{"line":12,"column":83},"end":{"line":17,"column":5}},"line":12},"3":{"name":"(anonymous_3)","decl":{"start":{"line":18,"column":4},"end":{"line":18,"column":5}},"loc":{"start":{"line":18,"column":83},"end":{"line":23,"column":5}},"line":18}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"f":{"0":3,"1":0,"2":0,"3":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordConfirms.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordConfirms.ts"],"names":[],"mappings":";;AAEA,yCAAoD;AAEpD,kFAA+E;AAElE,QAAA,cAAc,GAAG,GAAM,EAAE,CACpC,CAAC;IACC,CAAC,oBAAQ,CAAC,yBAAyB,CAAC,CAClC,EAAE,MAAM,EAAE,KAAK,EAAE,EACjB,OAAsB;QAEtB,MAAM,4CAAkC,OAAO,CAAC,CAAC;QACjD,MAAM,CACJ,iDAAuB,CAAC,OAAO,4CAAkC,EACjE,OAAO,EACP;YACE,IAAI,EAAE,IAAI;SACX,CACF,CAAC;IACJ,CAAC;IAED,CAAC,oBAAQ,CAAC,2BAA2B,CAAC,CACpC,EAAE,MAAM,EAAE,KAAK,EAAE,EACjB,OAAsB;QAEtB,MAAM,kDAAqC,OAAO,CAAC,CAAC;QACpD,MAAM,CACJ,iDAAuB,CAAC,OAAO,kDAAqC,EACpE,OAAO,EACP;YACE,IAAI,EAAE,IAAI;SACX,CACF,CAAC;IACJ,CAAC;IAED,CAAC,oBAAQ,CAAC,2BAA2B,CAAC,CACpC,EAAE,MAAM,EAAE,KAAK,EAAE,EACjB,OAAsB;QAEtB,MAAM,kDAAqC,OAAO,CAAC,CAAC;QACpD,MAAM,CACJ,iDAAuB,CAAC,OAAO,+CAAsC,EACrE,OAAO,EACP;YACE,IAAI,EAAE,IAAI;SACX,CACF,CAAC;IACJ,CAAC;CACoC,CAAA,CAAC","sourcesContent":["import { ActionTree } from \"vuex\";\nimport { IFiremodelState } from \"../../index\";\nimport { FmEvents, IFmWatchEvent } from \"firemodel\";\nimport { FmCrudMutation } from \"../../types/mutations/FmCrudMutation\";\nimport { determineLocalStateNode } from \"../../shared/determineLocalStateNode\";\n\nexport const recordConfirms = <T>() =>\n  ({\n    [FmEvents.RECORD_ADDED_CONFIRMATION](\n      { commit, state },\n      payload: IFmWatchEvent\n    ) {\n      commit(FmCrudMutation.serverAddConfirm, payload);\n      commit(\n        determineLocalStateNode(payload, FmCrudMutation.serverAddConfirm),\n        payload,\n        {\n          root: true\n        }\n      );\n    },\n\n    [FmEvents.RECORD_CHANGED_CONFIRMATION](\n      { commit, state },\n      payload: IFmWatchEvent\n    ) {\n      commit(FmCrudMutation.serverChangeConfirm, payload);\n      commit(\n        determineLocalStateNode(payload, FmCrudMutation.serverChangeConfirm),\n        payload,\n        {\n          root: true\n        }\n      );\n    },\n\n    [FmEvents.RECORD_REMOVED_CONFIRMATION](\n      { commit, state },\n      payload: IFmWatchEvent\n    ) {\n      commit(FmCrudMutation.serverRemoveConfirm, payload);\n      commit(\n        determineLocalStateNode(payload, FmCrudMutation.serverChangeRollback),\n        payload,\n        {\n          root: true\n        }\n      );\n    }\n  } as ActionTree<IFiremodelState<T>, T>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"fedfa3592abf128f460ccddcc7320fb931838a71","contentHash":"63078a7c313a131f81c6cf639ff3750e78f77a0013691be59f7a70f7d27251b7"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordRollbacks.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordRollbacks.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":40}},"2":{"start":{"line":4,"column":34},"end":{"line":4,"column":81}},"3":{"start":{"line":5,"column":0},"end":{"line":24,"column":3}},"4":{"start":{"line":5,"column":33},"end":{"line":24,"column":1}},"5":{"start":{"line":7,"column":8},"end":{"line":7,"column":64}},"6":{"start":{"line":8,"column":8},"end":{"line":10,"column":11}},"7":{"start":{"line":13,"column":8},"end":{"line":13,"column":70}},"8":{"start":{"line":14,"column":8},"end":{"line":16,"column":11}},"9":{"start":{"line":19,"column":8},"end":{"line":19,"column":70}},"10":{"start":{"line":20,"column":8},"end":{"line":22,"column":11}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":5,"column":26},"end":{"line":5,"column":27}},"loc":{"start":{"line":5,"column":33},"end":{"line":24,"column":1}},"line":5},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":77},"end":{"line":11,"column":5}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":12,"column":4},"end":{"line":12,"column":5}},"loc":{"start":{"line":12,"column":79},"end":{"line":17,"column":5}},"line":12},"3":{"name":"(anonymous_3)","decl":{"start":{"line":18,"column":4},"end":{"line":18,"column":5}},"loc":{"start":{"line":18,"column":79},"end":{"line":23,"column":5}},"line":18}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"f":{"0":3,"1":0,"2":0,"3":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordRollbacks.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/recordRollbacks.ts"],"names":[],"mappings":";;AAEA,yCAAoD;AAEpD,kFAA+E;AAElE,QAAA,eAAe,GAAG,GAAM,EAAE,CACrC,CAAC;IACC,CAAC,oBAAQ,CAAC,qBAAqB,CAAC,CAC9B,EAAE,MAAM,EAAE,KAAK,EAAE,EACjB,OAAsB;QAEtB,MAAM,yCAAmC,OAAO,CAAC,CAAC;QAClD,MAAM,CACJ,iDAAuB,CAAC,OAAO,yCAAmC,EAClE,OAAO,EACP;YACE,IAAI,EAAE,IAAI;SACX,CACF,CAAC;IACJ,CAAC;IACD,CAAC,oBAAQ,CAAC,uBAAuB,CAAC,CAChC,EAAE,MAAM,EAAE,KAAK,EAAE,EACjB,OAAsB;QAEtB,MAAM,+CAAsC,OAAO,CAAC,CAAC;QACrD,MAAM,CACJ,iDAAuB,CAAC,OAAO,+CAAsC,EACrE,OAAO,EACP;YACE,IAAI,EAAE,IAAI;SACX,CACF,CAAC;IACJ,CAAC;IACD,CAAC,oBAAQ,CAAC,uBAAuB,CAAC,CAChC,EAAE,MAAM,EAAE,KAAK,EAAE,EACjB,OAAsB;QAEtB,MAAM,+CAAsC,OAAO,CAAC,CAAC;QACrD,MAAM,CACJ,iDAAuB,CAAC,OAAO,+CAAsC,EACrE,OAAO,EACP;YACE,IAAI,EAAE,IAAI;SACX,CACF,CAAC;IACJ,CAAC;CACoC,CAAA,CAAC","sourcesContent":["import { ActionTree } from \"vuex\";\nimport { IFiremodelState } from \"../../index\";\nimport { FmEvents, IFmWatchEvent } from \"firemodel\";\nimport { FmCrudMutation } from \"../../types/mutations/FmCrudMutation\";\nimport { determineLocalStateNode } from \"../../shared/determineLocalStateNode\";\n\nexport const recordRollbacks = <T>() =>\n  ({\n    [FmEvents.RECORD_ADDED_ROLLBACK](\n      { commit, state },\n      payload: IFmWatchEvent\n    ) {\n      commit(FmCrudMutation.serverAddRollback, payload);\n      commit(\n        determineLocalStateNode(payload, FmCrudMutation.serverAddRollback),\n        payload,\n        {\n          root: true\n        }\n      );\n    },\n    [FmEvents.RECORD_CHANGED_ROLLBACK](\n      { commit, state },\n      payload: IFmWatchEvent\n    ) {\n      commit(FmCrudMutation.serverChangeRollback, payload);\n      commit(\n        determineLocalStateNode(payload, FmCrudMutation.serverChangeRollback),\n        payload,\n        {\n          root: true\n        }\n      );\n    },\n    [FmEvents.RECORD_REMOVED_ROLLBACK](\n      { commit, state },\n      payload: IFmWatchEvent\n    ) {\n      commit(FmCrudMutation.serverRemoveRollback, payload);\n      commit(\n        determineLocalStateNode(payload, FmCrudMutation.serverRemoveRollback),\n        payload,\n        {\n          root: true\n        }\n      );\n    }\n  } as ActionTree<IFiremodelState<T>, T>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"0e53f95e82063f22bb598225357a4d77fb35f05b","contentHash":"acba6e8606c1f0857add9ed369133caa3a51a94d89073202ee9a915392830434"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/auth.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/auth.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":19},"end":{"line":3,"column":51}},"2":{"start":{"line":4,"column":31},"end":{"line":4,"column":75}},"3":{"start":{"line":5,"column":20},"end":{"line":5,"column":40}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":53}},"5":{"start":{"line":12,"column":0},"end":{"line":256,"column":3}},"6":{"start":{"line":12,"column":29},"end":{"line":256,"column":1}},"7":{"start":{"line":18,"column":8},"end":{"line":31,"column":9}},"8":{"start":{"line":19,"column":23},"end":{"line":19,"column":50}},"9":{"start":{"line":20,"column":25},"end":{"line":20,"column":40}},"10":{"start":{"line":21,"column":35},"end":{"line":21,"column":89}},"11":{"start":{"line":22,"column":12},"end":{"line":22,"column":65}},"12":{"start":{"line":23,"column":12},"end":{"line":23,"column":34}},"13":{"start":{"line":26,"column":12},"end":{"line":29,"column":15}},"14":{"start":{"line":30,"column":12},"end":{"line":30,"column":20}},"15":{"start":{"line":39,"column":8},"end":{"line":52,"column":9}},"16":{"start":{"line":40,"column":23},"end":{"line":40,"column":50}},"17":{"start":{"line":41,"column":25},"end":{"line":41,"column":40}},"18":{"start":{"line":42,"column":35},"end":{"line":42,"column":93}},"19":{"start":{"line":43,"column":12},"end":{"line":43,"column":69}},"20":{"start":{"line":44,"column":12},"end":{"line":44,"column":34}},"21":{"start":{"line":47,"column":12},"end":{"line":50,"column":15}},"22":{"start":{"line":51,"column":12},"end":{"line":51,"column":20}},"23":{"start":{"line":61,"column":8},"end":{"line":73,"column":9}},"24":{"start":{"line":62,"column":23},"end":{"line":62,"column":50}},"25":{"start":{"line":63,"column":25},"end":{"line":63,"column":40}},"26":{"start":{"line":64,"column":12},"end":{"line":64,"column":73}},"27":{"start":{"line":65,"column":12},"end":{"line":65,"column":76}},"28":{"start":{"line":68,"column":12},"end":{"line":71,"column":15}},"29":{"start":{"line":72,"column":12},"end":{"line":72,"column":20}},"30":{"start":{"line":80,"column":8},"end":{"line":92,"column":9}},"31":{"start":{"line":81,"column":23},"end":{"line":81,"column":50}},"32":{"start":{"line":82,"column":25},"end":{"line":82,"column":40}},"33":{"start":{"line":83,"column":12},"end":{"line":83,"column":63}},"34":{"start":{"line":84,"column":12},"end":{"line":84,"column":43}},"35":{"start":{"line":87,"column":12},"end":{"line":90,"column":15}},"36":{"start":{"line":91,"column":12},"end":{"line":91,"column":20}},"37":{"start":{"line":99,"column":8},"end":{"line":112,"column":9}},"38":{"start":{"line":100,"column":23},"end":{"line":100,"column":50}},"39":{"start":{"line":101,"column":25},"end":{"line":101,"column":40}},"40":{"start":{"line":102,"column":26},"end":{"line":102,"column":66}},"41":{"start":{"line":103,"column":12},"end":{"line":103,"column":53}},"42":{"start":{"line":104,"column":12},"end":{"line":104,"column":25}},"43":{"start":{"line":107,"column":12},"end":{"line":110,"column":15}},"44":{"start":{"line":111,"column":12},"end":{"line":111,"column":20}},"45":{"start":{"line":119,"column":8},"end":{"line":122,"column":9}},"46":{"start":{"line":120,"column":12},"end":{"line":120,"column":110}},"47":{"start":{"line":121,"column":12},"end":{"line":121,"column":161}},"48":{"start":{"line":123,"column":8},"end":{"line":135,"column":9}},"49":{"start":{"line":124,"column":23},"end":{"line":124,"column":50}},"50":{"start":{"line":125,"column":25},"end":{"line":125,"column":54}},"51":{"start":{"line":126,"column":12},"end":{"line":126,"column":45}},"52":{"start":{"line":127,"column":12},"end":{"line":127,"column":71}},"53":{"start":{"line":130,"column":12},"end":{"line":133,"column":15}},"54":{"start":{"line":134,"column":12},"end":{"line":134,"column":20}},"55":{"start":{"line":144,"column":8},"end":{"line":147,"column":9}},"56":{"start":{"line":145,"column":12},"end":{"line":145,"column":113}},"57":{"start":{"line":146,"column":12},"end":{"line":146,"column":161}},"58":{"start":{"line":148,"column":8},"end":{"line":160,"column":9}},"59":{"start":{"line":149,"column":23},"end":{"line":149,"column":50}},"60":{"start":{"line":150,"column":25},"end":{"line":150,"column":54}},"61":{"start":{"line":151,"column":12},"end":{"line":151,"column":48}},"62":{"start":{"line":152,"column":12},"end":{"line":152,"column":76}},"63":{"start":{"line":155,"column":12},"end":{"line":158,"column":15}},"64":{"start":{"line":159,"column":12},"end":{"line":159,"column":20}},"65":{"start":{"line":167,"column":8},"end":{"line":183,"column":9}},"66":{"start":{"line":168,"column":23},"end":{"line":168,"column":50}},"67":{"start":{"line":169,"column":25},"end":{"line":169,"column":40}},"68":{"start":{"line":170,"column":25},"end":{"line":170,"column":41}},"69":{"start":{"line":171,"column":12},"end":{"line":173,"column":13}},"70":{"start":{"line":172,"column":16},"end":{"line":172,"column":168}},"71":{"start":{"line":174,"column":12},"end":{"line":174,"column":46}},"72":{"start":{"line":175,"column":12},"end":{"line":175,"column":46}},"73":{"start":{"line":178,"column":12},"end":{"line":181,"column":15}},"74":{"start":{"line":182,"column":12},"end":{"line":182,"column":20}},"75":{"start":{"line":191,"column":8},"end":{"line":208,"column":9}},"76":{"start":{"line":192,"column":23},"end":{"line":192,"column":50}},"77":{"start":{"line":193,"column":12},"end":{"line":193,"column":46}},"78":{"start":{"line":194,"column":25},"end":{"line":194,"column":40}},"79":{"start":{"line":195,"column":12},"end":{"line":198,"column":13}},"80":{"start":{"line":196,"column":34},"end":{"line":196,"column":112}},"81":{"start":{"line":197,"column":16},"end":{"line":197,"column":68}},"82":{"start":{"line":199,"column":12},"end":{"line":199,"column":33}},"83":{"start":{"line":203,"column":12},"end":{"line":206,"column":15}},"84":{"start":{"line":207,"column":12},"end":{"line":207,"column":20}},"85":{"start":{"line":214,"column":8},"end":{"line":228,"column":9}},"86":{"start":{"line":215,"column":23},"end":{"line":215,"column":50}},"87":{"start":{"line":216,"column":25},"end":{"line":216,"column":40}},"88":{"start":{"line":217,"column":12},"end":{"line":219,"column":13}},"89":{"start":{"line":218,"column":16},"end":{"line":218,"column":209}},"90":{"start":{"line":220,"column":12},"end":{"line":220,"column":60}},"91":{"start":{"line":223,"column":12},"end":{"line":226,"column":15}},"92":{"start":{"line":227,"column":12},"end":{"line":227,"column":20}},"93":{"start":{"line":231,"column":8},"end":{"line":242,"column":9}},"94":{"start":{"line":232,"column":23},"end":{"line":232,"column":50}},"95":{"start":{"line":233,"column":12},"end":{"line":233,"column":46}},"96":{"start":{"line":234,"column":25},"end":{"line":234,"column":40}},"97":{"start":{"line":235,"column":12},"end":{"line":237,"column":13}},"98":{"start":{"line":236,"column":16},"end":{"line":236,"column":199}},"99":{"start":{"line":238,"column":12},"end":{"line":238,"column":76}},"100":{"start":{"line":241,"column":12},"end":{"line":241,"column":112}},"101":{"start":{"line":246,"column":8},"end":{"line":254,"column":9}},"102":{"start":{"line":247,"column":23},"end":{"line":247,"column":50}},"103":{"start":{"line":248,"column":12},"end":{"line":248,"column":46}},"104":{"start":{"line":249,"column":25},"end":{"line":249,"column":40}},"105":{"start":{"line":250,"column":12},"end":{"line":250,"column":115}},"106":{"start":{"line":253,"column":12},"end":{"line":253,"column":76}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":22},"end":{"line":12,"column":23}},"loc":{"start":{"line":12,"column":29},"end":{"line":256,"column":1}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":17,"column":4},"end":{"line":17,"column":5}},"loc":{"start":{"line":17,"column":70},"end":{"line":32,"column":5}},"line":17},"2":{"name":"(anonymous_2)","decl":{"start":{"line":38,"column":4},"end":{"line":38,"column":5}},"loc":{"start":{"line":38,"column":74},"end":{"line":53,"column":5}},"line":38},"3":{"name":"(anonymous_3)","decl":{"start":{"line":60,"column":4},"end":{"line":60,"column":5}},"loc":{"start":{"line":60,"column":76},"end":{"line":74,"column":5}},"line":60},"4":{"name":"(anonymous_4)","decl":{"start":{"line":79,"column":4},"end":{"line":79,"column":5}},"loc":{"start":{"line":79,"column":66},"end":{"line":93,"column":5}},"line":79},"5":{"name":"(anonymous_5)","decl":{"start":{"line":98,"column":4},"end":{"line":98,"column":5}},"loc":{"start":{"line":98,"column":52},"end":{"line":113,"column":5}},"line":98},"6":{"name":"(anonymous_6)","decl":{"start":{"line":118,"column":4},"end":{"line":118,"column":5}},"loc":{"start":{"line":118,"column":51},"end":{"line":136,"column":5}},"line":118},"7":{"name":"(anonymous_7)","decl":{"start":{"line":143,"column":4},"end":{"line":143,"column":5}},"loc":{"start":{"line":143,"column":58},"end":{"line":161,"column":5}},"line":143},"8":{"name":"(anonymous_8)","decl":{"start":{"line":166,"column":4},"end":{"line":166,"column":5}},"loc":{"start":{"line":166,"column":52},"end":{"line":184,"column":5}},"line":166},"9":{"name":"(anonymous_9)","decl":{"start":{"line":190,"column":4},"end":{"line":190,"column":5}},"loc":{"start":{"line":190,"column":53},"end":{"line":209,"column":5}},"line":190},"10":{"name":"(anonymous_10)","decl":{"start":{"line":213,"column":4},"end":{"line":213,"column":5}},"loc":{"start":{"line":213,"column":44},"end":{"line":229,"column":5}},"line":213},"11":{"name":"(anonymous_11)","decl":{"start":{"line":230,"column":4},"end":{"line":230,"column":5}},"loc":{"start":{"line":230,"column":67},"end":{"line":243,"column":5}},"line":230},"12":{"name":"(anonymous_12)","decl":{"start":{"line":244,"column":4},"end":{"line":244,"column":5}},"loc":{"start":{"line":244,"column":57},"end":{"line":255,"column":5}},"line":244}},"branchMap":{"0":{"loc":{"start":{"line":119,"column":8},"end":{"line":122,"column":9}},"type":"if","locations":[{"start":{"line":119,"column":8},"end":{"line":122,"column":9}},{"start":{"line":119,"column":8},"end":{"line":122,"column":9}}],"line":119},"1":{"loc":{"start":{"line":144,"column":8},"end":{"line":147,"column":9}},"type":"if","locations":[{"start":{"line":144,"column":8},"end":{"line":147,"column":9}},{"start":{"line":144,"column":8},"end":{"line":147,"column":9}}],"line":144},"2":{"loc":{"start":{"line":171,"column":12},"end":{"line":173,"column":13}},"type":"if","locations":[{"start":{"line":171,"column":12},"end":{"line":173,"column":13}},{"start":{"line":171,"column":12},"end":{"line":173,"column":13}}],"line":171},"3":{"loc":{"start":{"line":195,"column":12},"end":{"line":198,"column":13}},"type":"if","locations":[{"start":{"line":195,"column":12},"end":{"line":198,"column":13}},{"start":{"line":195,"column":12},"end":{"line":198,"column":13}}],"line":195},"4":{"loc":{"start":{"line":196,"column":34},"end":{"line":196,"column":112}},"type":"cond-expr","locations":[{"start":{"line":196,"column":62},"end":{"line":196,"column":67}},{"start":{"line":196,"column":70},"end":{"line":196,"column":112}}],"line":196},"5":{"loc":{"start":{"line":217,"column":12},"end":{"line":219,"column":13}},"type":"if","locations":[{"start":{"line":217,"column":12},"end":{"line":219,"column":13}},{"start":{"line":217,"column":12},"end":{"line":219,"column":13}}],"line":217},"6":{"loc":{"start":{"line":235,"column":12},"end":{"line":237,"column":13}},"type":"if","locations":[{"start":{"line":235,"column":12},"end":{"line":237,"column":13}},{"start":{"line":235,"column":12},"end":{"line":237,"column":13}}],"line":235},"7":{"loc":{"start":{"line":250,"column":19},"end":{"line":250,"column":113}},"type":"cond-expr","locations":[{"start":{"line":250,"column":71},"end":{"line":250,"column":77}},{"start":{"line":250,"column":80},"end":{"line":250,"column":113}}],"line":250},"8":{"loc":{"start":{"line":250,"column":19},"end":{"line":250,"column":68}},"type":"binary-expr","locations":[{"start":{"line":250,"column":19},"end":{"line":250,"column":51}},{"start":{"line":250,"column":55},"end":{"line":250,"column":68}}],"line":250}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":3,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0,"101":0,"102":0,"103":0,"104":0,"105":0,"106":0},"f":{"0":3,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/auth.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/auth.ts"],"names":[],"mappings":"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","sourcesContent":["import { ActionTree } from \"vuex\";\n\nimport { IFiremodelState, ISignOutPayload, IAuthProfile } from \"../../index\";\nimport { database } from \"../../shared/database\";\nimport { FireModelPluginError } from \"../../errors/FiremodelPluginError\";\nimport {\n  ActionCodeSettings,\n  UserCredential,\n  AuthCredential\n} from \"@firebase/auth-types\";\nimport { Record } from \"firemodel\";\nimport { FireModelProxyError } from \"firemodel/dist/cjs/errors\";\nimport { User } from \"firemock\";\n\n/**\n * **authActions**\n *\n * The Firebase AUTH actions which this plugin will execute for the user\n */\nexport const authActions = <T>() =>\n  ({\n    /**\n     * Sends a email and password trying to auth on firebase module `signInWithEmailAndPassword`.\n     * For more see [API docs](https://firebase.google.com/docs/reference/node/firebase.auth.Auth.html#signinwithemailandpassword).\n     */\n    async signInWithEmailAndPassword(\n      { commit },\n      { email, password }: { email: string; password: string }\n    ) {\n      try {\n        const db = await database();\n        const auth = await db.auth();\n        const userCredential = await auth.signInWithEmailAndPassword(\n          email,\n          password\n        );\n        commit(\"signInWithEmailAndPassword\", userCredential);\n\n        return userCredential;\n      } catch (e) {\n        commit(\"error\", {\n          stack: e.stack,\n          message: `Failure to login user [${email}]: ${e.message} [ ${e.code} ${e.name} ]`\n        });\n        throw e;\n      }\n    },\n\n    /**\n     * Allows a frontend app to create a new user for email and password\n     * authentication. The account will initially be set to _un-verified_ but\n     * the email used will be sent a link to make the account verified.\n     */\n    async createUserWithEmailAndPassword(\n      { commit },\n      { email, password }: { email: string; password: string }\n    ): Promise<UserCredential> {\n      try {\n        const db = await database();\n        const auth = await db.auth();\n        const userCredential = await auth.createUserWithEmailAndPassword(\n          email,\n          password\n        );\n        commit(\"createUserWithEmailAndPassword\", userCredential);\n\n        return userCredential;\n      } catch (e) {\n        commit(\"error\", {\n          stack: e.stack,\n          message: `Failure to create user: ${e.message} [ ${e.code} ${e.name} ]`\n        });\n        throw e;\n      }\n    },\n\n    /**\n     * Sends a password reset email to the given email address.\n     * To complete the password reset, dispatch `confirmPasswordReset` with\n     * the code supplied in the email sent to the user, along with the new password\n     * specified by the user.\n     */\n    async sendPasswordResetEmail(\n      { commit },\n      {\n        email,\n        actionCodeSettings\n      }: { email: string; actionCodeSettings?: ActionCodeSettings | null }\n    ) {\n      try {\n        const db = await database();\n        const auth = await db.auth();\n        await auth.sendPasswordResetEmail(email, actionCodeSettings);\n        commit(\"sendPasswordResetEmail\", { email, actionCodeSettings });\n      } catch (e) {\n        commit(\"error\", {\n          stack: e.stack,\n          message: `Failure to send password-reset email: ${e.message} [ ${e.code} ${e.name} ]`\n        });\n        throw e;\n      }\n    },\n\n    /**\n     * Completes the password reset process, given a _confirmation code_\n     * and new _password_.\n     */\n    async confirmPasswordReset(\n      { commit },\n      { code, newPassword }: { code: string; newPassword: string }\n    ) {\n      try {\n        const db = await database();\n        const auth = await db.auth();\n        await auth.confirmPasswordReset(code, newPassword);\n        commit(\"confirmPasswordReset\");\n      } catch (e) {\n        commit(\"error\", {\n          stack: e.stack,\n          message: `Failured to confirm password reset: ${e.message} [ ${e.code} ${e.name} ]`\n        });\n        throw e;\n      }\n    },\n\n    /**\n     * Checks a password reset code sent to the user by email or other\n     * out-of-band mechanism. Returns the user's email address if valid.\n     */\n    async verifyPasswordResetCode({ commit }, code: string): Promise<string> {\n      try {\n        const db = await database();\n        const auth = await db.auth();\n        const email = await auth.verifyPasswordResetCode(code);\n        commit(\"verifyPasswordResetCode\", email);\n\n        return email;\n      } catch (e) {\n        commit(\"error\", {\n          stack: e.stack,\n          message: `Failure to verify password reset code: ${e.message} [ ${e.code} ${e.name} ]`\n        });\n        throw e;\n      }\n    },\n\n    /**\n     * Updates the user's email address. An email will be sent to the original email address\n     * that allows owner of that email address to revoke the email address change.\n     */\n    async updateEmail({ commit, state }, newEmail: string) {\n      if (!state.currentUser) {\n        commit(\n          \"error\",\n          `The updateEmail dispatch was dispatched but the current user profile is empty!`\n        );\n        throw new FireModelPluginError(\n          `The updateEmail dispatch was dispatched but the current user profile is empty!`,\n          \"not-ready\"\n        );\n      }\n\n      try {\n        const db = await database();\n        const user = (await db.auth()).currentUser as User;\n        await user.updateEmail(newEmail);\n        commit(\"updatedEmail\", { uid: user.uid, email: newEmail });\n      } catch (e) {\n        commit(\"error\", {\n          stack: e.stack,\n          message: `Failure to update the logged in user's email address: ${e.message} [ ${e.code} ${e.name} ]`\n        });\n        throw e;\n      }\n    },\n\n    /**\n     * Updates the user's password. In order to allow this operation a user\n     * must have logged in recently. If this requirement isn't met a\n     * `auth/requires-recent-login` error will be thrown. You will then have to\n     * call the `reauthenticateWithCredential` to resolve this.\n     */\n    async updatePassword({ commit, state }, { password }) {\n      if (!state.currentUser) {\n        commit(\n          \"error\",\n          `The updatePassword dispatch was dispatched but the current user profile is empty!`\n        );\n        throw new FireModelPluginError(\n          `The updateEmail dispatch was dispatched but the current user profile is empty!`,\n          \"not-ready\"\n        );\n      }\n\n      try {\n        const db = await database();\n        const user = (await db.auth()).currentUser as User;\n        await user.updatePassword(password);\n        commit(\"updatedPassword\", { uid: user.uid, password: \"*****\" });\n      } catch (e) {\n        commit(\"error\", {\n          stack: e.stack,\n          message: `Failure to update the logged in user's password: ${e.message} [ ${e.code} ${e.name} ]`\n        });\n        throw e;\n      }\n    },\n\n    /**\n     * Update a user's basic profile information with name and/or\n     * photo URL.\n     */\n    async updateProfile({ commit, state }, profile: IAuthProfile) {\n      try {\n        const db = await database();\n        const auth = await db.auth();\n        const user = auth.currentUser;\n        if (!user) {\n          throw new FireModelPluginError(\n            `Attempt to updateProfile() before currentUser is set in Firebase identity system!`,\n            \"not-ready\"\n          );\n        }\n        await user.updateProfile(profile);\n        commit(\"updatedProfile\", profile);\n      } catch (e) {\n        commit(\"error\", {\n          stack: e.stack,\n          message: `Failure to update user's profile: ${e.message} [ ${e.code} ]`\n        });\n        throw e;\n      }\n    },\n\n    /**\n     * Signs out the current user from Firebase; it will also\n     * optionally send a **reset** to the `Model` which stores the\n     * user profile of the user.\n     */\n    async signOut({ commit }, { uid, email, model }: ISignOutPayload) {\n      try {\n        const db = await database();\n        Record.defaultDb = db;\n        const auth = await db.auth();\n        if (model) {\n          const localPath =\n            typeof model === \"string\" ? model : Record.create(model).localPath;\n          commit(`${localPath}/RESET`, { uid, email, model });\n        }\n        await auth.signOut();\n        // commit(\"@firemodel/SIGNED_OUT\", { loggedOutUser: uid });\n      } catch (e) {\n        commit(\"error\", {\n          stack: e.stack,\n          message: `Failure to sign out of Firebase: ${e.message}`\n        });\n        throw e;\n      }\n    },\n\n    /**\n     * Sends a verification email to the currently logged in user\n     */\n    async sendEmailVerification({ commit }) {\n      try {\n        const db = await database();\n        const auth = await db.auth();\n        if (!auth.currentUser) {\n          throw new FireModelPluginError(\n            `Attempt to call sendEmailVerification() failed because there is no \"currentUser\" set in the identity system yet!`,\n            \"firemodel/not-ready\"\n          );\n        }\n        return auth.currentUser.sendEmailVerification();\n      } catch (e) {\n        commit(\"error\", {\n          stack: e.stack,\n          message: `Failure to sign out of Firebase: ${e.message}`\n        });\n        throw e;\n      }\n    },\n\n    async reauthenticateWithCredential({ commit }, { credential } : { credential: AuthCredential }) {\n      try {\n        const db = await database();\n        Record.defaultDb = db;\n        const auth = await db.auth();\n        if (!auth.currentUser) {\n          throw new FireModelPluginError(\n            `Attempt to call reauthenticateWithCredential() requires that the \"auth.currentUser\" be set and it is not!`,\n            \"auth/not-allowed\"\n          );\n        }\n\n        await auth.currentUser.reauthenticateWithCredential(credential);\n      } catch (e) {\n        throw new FireModelProxyError(\n          e,\n          \"firemodelActions/auth.ts[reauthenticateWithCredential]\"\n        );\n      }\n    },\n\n    async linkWithCredential({ commit }, { credential }: { credential: AuthCredential }) {\n      try {\n        const db = await database();\n        Record.defaultDb = db;\n        const auth = await db.auth();\n\n        await auth.currentUser?.linkWithCredential(credential);\n      } catch (e) {\n        throw new FireModelProxyError(e, \"linkWithCredential\");\n      }\n    }\n  } as ActionTree<IFiremodelState<T>, T>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2c92935b03f4cf910d18ceca1cc5476aff8e549d","contentHash":"086c31fee391eab24f0220f0f6a39f0f4fc73bf28a065b7168e0963350a11da5"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/database.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/database.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":56}},"2":{"start":{"line":4,"column":31},"end":{"line":4,"column":72}},"3":{"start":{"line":5,"column":20},"end":{"line":5,"column":40}},"4":{"start":{"line":13,"column":4},"end":{"line":19,"column":5}},"5":{"start":{"line":14,"column":8},"end":{"line":17,"column":9}},"6":{"start":{"line":15,"column":12},"end":{"line":15,"column":29}},"7":{"start":{"line":16,"column":12},"end":{"line":16,"column":63}},"8":{"start":{"line":18,"column":8},"end":{"line":18,"column":46}},"9":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"10":{"start":{"line":21,"column":8},"end":{"line":21,"column":153}},"11":{"start":{"line":23,"column":4},"end":{"line":23,"column":15}},"12":{"start":{"line":25,"column":0},"end":{"line":25,"column":28}}},"fnMap":{"0":{"name":"database","decl":{"start":{"line":12,"column":15},"end":{"line":12,"column":23}},"loc":{"start":{"line":12,"column":32},"end":{"line":24,"column":1}},"line":12}},"branchMap":{"0":{"loc":{"start":{"line":13,"column":4},"end":{"line":19,"column":5}},"type":"if","locations":[{"start":{"line":13,"column":4},"end":{"line":19,"column":5}},{"start":{"line":13,"column":4},"end":{"line":19,"column":5}}],"line":13},"1":{"loc":{"start":{"line":14,"column":8},"end":{"line":17,"column":9}},"type":"if","locations":[{"start":{"line":14,"column":8},"end":{"line":17,"column":9}},{"start":{"line":14,"column":8},"end":{"line":17,"column":9}}],"line":14},"2":{"loc":{"start":{"line":14,"column":12},"end":{"line":14,"column":70}},"type":"binary-expr","locations":[{"start":{"line":14,"column":12},"end":{"line":14,"column":62}},{"start":{"line":14,"column":66},"end":{"line":14,"column":70}}],"line":14},"3":{"loc":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},{"start":{"line":20,"column":4},"end":{"line":22,"column":5}}],"line":20},"4":{"loc":{"start":{"line":20,"column":8},"end":{"line":20,"column":24}},"type":"binary-expr","locations":[{"start":{"line":20,"column":8},"end":{"line":20,"column":12}},{"start":{"line":20,"column":16},"end":{"line":20,"column":24}}],"line":20}},"s":{"0":1,"1":1,"2":1,"3":1,"4":9,"5":6,"6":3,"7":3,"8":6,"9":9,"10":0,"11":9,"12":1},"f":{"0":9},"b":{"0":[6,3],"1":[3,3],"2":[6,3],"3":[0,9],"4":[9,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/database.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/database.ts"],"names":[],"mappings":";;AAAA,yDAA8D;AAC9D,yEAAsE;AACtE,yCAAsC;AAEtC,IAAI,GAAO,CAAC;AACZ,IAAI,OAA8B,CAAC;AACnC;;;GAGG;AACI,KAAK,UAAU,QAAQ,CAAC,MAA8B;IAC3D,IAAI,MAAM,EAAE;QACV,IAAI,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,KAAK,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,EAAE;YAC9D,OAAO,GAAG,MAAM,CAAC;YACjB,GAAG,GAAG,MAAM,sBAAE,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC;SAChC;QACD,qBAAS,CAAC,SAAS,GAAG,GAAG,CAAC;KAC3B;IAED,IAAI,CAAC,GAAG,IAAI,CAAC,OAAO,EAAE;QACpB,MAAM,IAAI,2CAAoB,CAC5B,4EAA4E,EAC5E,WAAW,CACZ,CAAC;KACH;IAED,OAAO,GAAG,CAAC;AACb,CAAC;AAjBD,4BAiBC","sourcesContent":["import { DB, IFirebaseClientConfig } from \"abstracted-client\";\nimport { FireModelPluginError } from \"../errors/FiremodelPluginError\";\nimport { FireModel } from \"firemodel\";\n\nlet _db: DB;\nlet _config: IFirebaseClientConfig;\n/**\n * connects to a Firebase DB unless already connected in which case it\n * it just hands back the existing connection.\n */\nexport async function database(config?: IFirebaseClientConfig) {\n  if (config) {\n    if (JSON.stringify(config) !== JSON.stringify(_config) || !_db) {\n      _config = config;\n      _db = await DB.connect(config);\n    }\n    FireModel.defaultDb = _db;\n  }\n\n  if (!_db && !_config) {\n    throw new FireModelPluginError(\n      \"Trying to get the database connection but it has not been established yet!\",\n      \"not-ready\"\n    );\n  }\n\n  return _db;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8c01bcbad6fd38698b367a129d556910c21dc2aa","contentHash":"053834af97ecd5ab4065cd69ba378d930a9c803805feffc79cee3f365a9abf9c"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/FiremodelPluginError.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/FiremodelPluginError.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":9,"column":8},"end":{"line":9,"column":23}},"2":{"start":{"line":10,"column":8},"end":{"line":10,"column":30}},"3":{"start":{"line":11,"column":22},"end":{"line":11,"column":47}},"4":{"start":{"line":12,"column":32},"end":{"line":12,"column":91}},"5":{"start":{"line":13,"column":8},"end":{"line":13,"column":41}},"6":{"start":{"line":14,"column":8},"end":{"line":14,"column":28}},"7":{"start":{"line":17,"column":0},"end":{"line":17,"column":52}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":68},"end":{"line":15,"column":5}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":8,"column":25},"end":{"line":8,"column":66}},"type":"default-arg","locations":[{"start":{"line":8,"column":42},"end":{"line":8,"column":66}}],"line":8},"1":{"loc":{"start":{"line":12,"column":32},"end":{"line":12,"column":91}},"type":"cond-expr","locations":[{"start":{"line":12,"column":53},"end":{"line":12,"column":83}},{"start":{"line":12,"column":86},"end":{"line":12,"column":91}}],"line":12}},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":1},"f":{"0":0},"b":{"0":[0],"1":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/FiremodelPluginError.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/FiremodelPluginError.ts"],"names":[],"mappings":";;AAAA;;;GAGG;AACH,MAAa,oBAAqB,SAAQ,KAAK;IAG7C,YAAY,OAAe,EAAE,iBAAyB,wBAAwB;QAC5E,KAAK,CAAC,OAAO,CAAC,CAAC;QAHV,cAAS,GAAG,IAAI,CAAC;QAItB,MAAM,KAAK,GAAG,cAAc,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACxC,MAAM,CAAC,IAAI,EAAE,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,kBAAkB,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;QACpF,IAAI,CAAC,IAAI,GAAG,GAAG,IAAI,IAAI,OAAO,EAAE,CAAC;QACjC,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC;IACtB,CAAC;CACF;AAVD,oDAUC","sourcesContent":["/**\n * Base **Error** for **FireModel Plugin**. Takes _message_ and _type/subtype_ as\n * parameters. The code will be the `subtype`; the name is both.\n */\nexport class FireModelPluginError extends Error {\n  public firemodel = true;\n  public code: string;\n  constructor(message: string, classification: string = \"firemodel-plugin/error\") {\n    super(message);\n    const parts = classification.split(\"/\");\n    const [type, subType] = parts.length === 1 ? [\"firemodel-plugin\", parts[0]] : parts;\n    this.name = `${type}/${subType}`;\n    this.code = subType;\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"70f709e1a47f3f394a1710195de10c5824d428ef","contentHash":"cf3df302041c159c4466d674e75c781b2b450db21a540abc0ba9060adbce410b"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/errors.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/errors.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":40}},"2":{"start":{"line":4,"column":0},"end":{"line":8,"column":3}},"3":{"start":{"line":4,"column":24},"end":{"line":8,"column":1}},"4":{"start":{"line":6,"column":8},"end":{"line":6,"column":72}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":17},"end":{"line":4,"column":18}},"loc":{"start":{"line":4,"column":24},"end":{"line":8,"column":1}},"line":4},"1":{"name":"(anonymous_1)","decl":{"start":{"line":5,"column":4},"end":{"line":5,"column":5}},"loc":{"start":{"line":5,"column":62},"end":{"line":7,"column":5}},"line":5}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":3,"4":0},"f":{"0":3,"1":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/errors.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/errors.ts"],"names":[],"mappings":";;AAAA,yCAAqC;AAExB,QAAA,MAAM,GAAG,GAAM,EAAE,CAAC,CAAC;IAC9B,KAAK,CAAC,CAAC,oBAAQ,CAAC,gBAAgB,CAAC,CAAC,CAAM,EAAE,OAAY;QACpD,OAAO,CAAC,IAAI,CAAC,wCAAwC,EAAE,OAAO,CAAC,CAAC;IAClE,CAAC;CACF,CAAC,CAAC","sourcesContent":["import { FmEvents } from \"firemodel\";\n\nexport const errors = <T>() => ({\n  async [FmEvents.UNEXPECTED_ERROR](_: any, payload: any) {\n    console.warn(`An unexpected Firemodel error occurred`, payload);\n  }\n});\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"d1a27cc3563454527f197235a9bcf6c02c8d14c5","contentHash":"20ab1dac92174c4b3c1d36e601c7d231339f311275a4ae62ac68d4ebea45683c"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/other.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/other.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":0},"end":{"line":10,"column":3}},"2":{"start":{"line":3,"column":23},"end":{"line":10,"column":1}},"3":{"start":{"line":8,"column":8},"end":{"line":8,"column":62}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":16},"end":{"line":3,"column":17}},"loc":{"start":{"line":3,"column":23},"end":{"line":10,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":4},"end":{"line":7,"column":5}},"loc":{"start":{"line":7,"column":36},"end":{"line":9,"column":5}},"line":7}},"branchMap":{},"s":{"0":1,"1":1,"2":3,"3":0},"f":{"0":3,"1":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/other.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/firemodelActions/other.ts"],"names":[],"mappings":";;AAGa,QAAA,KAAK,GAAG,GAAM,EAAE,CAC3B,CAAC;IACC;;OAEG;IACH,KAAK,CAAC,KAAK,CAAC,EAAE,MAAM,EAAE,EAAE,MAAc;QACpC,MAAM,CAAC,GAAG,MAAM,QAAQ,EAAE,EAAE,MAAM,EAAE,EAAE,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;IACxD,CAAC;CACoC,CAAA,CAAC","sourcesContent":["import { ActionTree } from \"vuex\";\nimport { IFiremodelState } from \"../../index\";\n\nexport const other = <T>() =>\n  ({\n    /**\n     * Resets a given module name back to it's default state\n     */\n    async RESET({ commit }, module: string) {\n      commit(`${module}/RESET`, { module }, { root: true });\n    }\n  } as ActionTree<IFiremodelState<T>, T>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"192315f6227ed42032f765726b6d4bd32737a46e","contentHash":"ee01fc91b5e11a4c590152eeaf178b7ac405bd005bcc2ebffbe19aed5d089c4e"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/localActions/pluginActions.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/localActions/pluginActions.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":40}},"2":{"start":{"line":4,"column":16},"end":{"line":4,"column":38}},"3":{"start":{"line":5,"column":26},"end":{"line":5,"column":72}},"4":{"start":{"line":6,"column":31},"end":{"line":6,"column":75}},"5":{"start":{"line":7,"column":19},"end":{"line":7,"column":51}},"6":{"start":{"line":8,"column":22},"end":{"line":8,"column":57}},"7":{"start":{"line":9,"column":19},"end":{"line":9,"column":51}},"8":{"start":{"line":15,"column":0},"end":{"line":118,"column":3}},"9":{"start":{"line":15,"column":31},"end":{"line":118,"column":1}},"10":{"start":{"line":22,"column":48},"end":{"line":22,"column":53}},"11":{"start":{"line":23,"column":8},"end":{"line":25,"column":9}},"12":{"start":{"line":24,"column":12},"end":{"line":24,"column":141}},"13":{"start":{"line":26,"column":8},"end":{"line":44,"column":9}},"14":{"start":{"line":27,"column":23},"end":{"line":27,"column":56}},"15":{"start":{"line":28,"column":12},"end":{"line":28,"column":49}},"16":{"start":{"line":29,"column":24},"end":{"line":38,"column":13}},"17":{"start":{"line":39,"column":12},"end":{"line":39,"column":56}},"18":{"start":{"line":40,"column":12},"end":{"line":40,"column":56}},"19":{"start":{"line":43,"column":12},"end":{"line":43,"column":182}},"20":{"start":{"line":53,"column":38},"end":{"line":53,"column":43}},"21":{"start":{"line":54,"column":19},"end":{"line":54,"column":46}},"22":{"start":{"line":55,"column":21},"end":{"line":55,"column":36}},"23":{"start":{"line":56,"column":8},"end":{"line":59,"column":9}},"24":{"start":{"line":57,"column":25},"end":{"line":57,"column":55}},"25":{"start":{"line":58,"column":12},"end":{"line":58,"column":44}},"26":{"start":{"line":71,"column":48},"end":{"line":71,"column":53}},"27":{"start":{"line":72,"column":8},"end":{"line":95,"column":9}},"28":{"start":{"line":73,"column":23},"end":{"line":73,"column":50}},"29":{"start":{"line":74,"column":25},"end":{"line":74,"column":40}},"30":{"start":{"line":75,"column":12},"end":{"line":75,"column":49}},"31":{"start":{"line":76,"column":24},"end":{"line":86,"column":13}},"32":{"start":{"line":87,"column":12},"end":{"line":87,"column":68}},"33":{"start":{"line":88,"column":12},"end":{"line":90,"column":29}},"34":{"start":{"line":93,"column":12},"end":{"line":93,"column":80}},"35":{"start":{"line":94,"column":12},"end":{"line":94,"column":33}},"36":{"start":{"line":103,"column":8},"end":{"line":116,"column":9}},"37":{"start":{"line":104,"column":24},"end":{"line":114,"column":13}},"38":{"start":{"line":115,"column":12},"end":{"line":115,"column":60}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":15,"column":24},"end":{"line":15,"column":25}},"loc":{"start":{"line":15,"column":31},"end":{"line":118,"column":1}},"line":15},"1":{"name":"(anonymous_1)","decl":{"start":{"line":21,"column":4},"end":{"line":21,"column":5}},"loc":{"start":{"line":21,"column":68},"end":{"line":45,"column":5}},"line":21},"2":{"name":"(anonymous_2)","decl":{"start":{"line":52,"column":4},"end":{"line":52,"column":5}},"loc":{"start":{"line":52,"column":67},"end":{"line":60,"column":5}},"line":52},"3":{"name":"(anonymous_3)","decl":{"start":{"line":70,"column":4},"end":{"line":70,"column":5}},"loc":{"start":{"line":70,"column":73},"end":{"line":96,"column":5}},"line":70},"4":{"name":"(anonymous_4)","decl":{"start":{"line":102,"column":4},"end":{"line":102,"column":5}},"loc":{"start":{"line":102,"column":105},"end":{"line":117,"column":5}},"line":102}},"branchMap":{"0":{"loc":{"start":{"line":23,"column":8},"end":{"line":25,"column":9}},"type":"if","locations":[{"start":{"line":23,"column":8},"end":{"line":25,"column":9}},{"start":{"line":23,"column":8},"end":{"line":25,"column":9}}],"line":23},"1":{"loc":{"start":{"line":56,"column":8},"end":{"line":59,"column":9}},"type":"if","locations":[{"start":{"line":56,"column":8},"end":{"line":59,"column":9}},{"start":{"line":56,"column":8},"end":{"line":59,"column":9}}],"line":56},"2":{"loc":{"start":{"line":56,"column":12},"end":{"line":56,"column":61}},"type":"binary-expr","locations":[{"start":{"line":56,"column":12},"end":{"line":56,"column":28}},{"start":{"line":56,"column":32},"end":{"line":56,"column":61}}],"line":56},"3":{"loc":{"start":{"line":88,"column":32},"end":{"line":90,"column":27}},"type":"cond-expr","locations":[{"start":{"line":89,"column":18},"end":{"line":89,"column":54}},{"start":{"line":90,"column":18},"end":{"line":90,"column":27}}],"line":88},"4":{"loc":{"start":{"line":89,"column":18},"end":{"line":89,"column":54}},"type":"binary-expr","locations":[{"start":{"line":89,"column":18},"end":{"line":89,"column":41}},{"start":{"line":89,"column":45},"end":{"line":89,"column":54}}],"line":89},"5":{"loc":{"start":{"line":103,"column":8},"end":{"line":116,"column":9}},"type":"if","locations":[{"start":{"line":103,"column":8},"end":{"line":116,"column":9}},{"start":{"line":103,"column":8},"end":{"line":116,"column":9}}],"line":103}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":3,"10":3,"11":3,"12":0,"13":3,"14":3,"15":3,"16":3,"17":3,"18":3,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":3,"27":3,"28":3,"29":3,"30":3,"31":3,"32":3,"33":3,"34":0,"35":0,"36":0,"37":0,"38":0},"f":{"0":3,"1":3,"2":0,"3":3,"4":0},"b":{"0":[0,3],"1":[0,0],"2":[0,0],"3":[0,3],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/localActions/pluginActions.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/store/localActions/pluginActions.ts"],"names":[],"mappings":"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","sourcesContent":["import { FireModel, Record, List, Watch } from \"firemodel\";\nimport { ActionTree } from \"vuex\";\nimport {\n  IFmQueuedAction,\n  IFmLifecycleEvents,\n  IFmEventBase,\n  IFmLoginEventContext,\n  IFiremodelConfig,\n  IFiremodelState,\n  IFmUserChangeEventContext,\n  IFmAuthenticatatedContext,\n  IFmConnectedContext,\n  IFmRouteEventContext\n} from \"../../types/index\";\n\nimport { FmConfigMutation } from \"../../types/mutations/FmConfigMutation\";\nimport { configuration } from \"../../index\";\nimport { FmConfigAction } from \"../../types/actions/FmConfigActions\";\nimport { FireModelPluginError } from \"../../errors/FiremodelPluginError\";\nimport { database } from \"../../shared/database\";\nimport { authChanged } from \"../../shared/authChanges\";\nimport { runQueue } from \"../../shared/runQueue\";\n\n/**\n * **pluginActions**\n *\n * The core services that this plugin provides are exposed as Vuex actions\n */\nexport const pluginActions = <T>() =>\n  ({\n    /**\n     * **connect**\n     *\n     * Connects to the Firebase database\n     */\n    async [FmConfigAction.connect](store, config) {\n      const { commit, dispatch, rootState } = store;\n      if (!config) {\n        throw new FireModelPluginError(\n          `Connecting to database but NO configuration was present!`,\n          \"not-allowed\"\n        );\n      }\n      try {\n        const db = await database(config);\n        FireModel.defaultDb = db;\n        const ctx: IFmConnectedContext<T> = {\n          Watch,\n          Record,\n          List,\n          dispatch,\n          commit,\n          db,\n          config,\n\n          state: rootState as T & { \"@firemodel\": IFiremodelState<T> }\n        };\n\n        await runQueue(ctx, \"connected\");\n\n        commit(FmConfigMutation.configure, config); // set Firebase configuration\n      } catch (e) {\n        throw new FireModelPluginError(\n          `There was an issue connecting to the Firebase database: ${e.message}`,\n          `vuex-plugin-firemodel/connection-problem`\n        );\n      }\n    },\n\n    /**\n     * **anonymousAuth**\n     *\n     * checks to see if already signed in to Firebase but if not\n     * then signs into Firebase as an _anonymous_ user\n     */\n    async [FmConfigAction.anonymousLogin](store) {\n      const { commit, rootState } = store;\n      const db = await database();\n      const auth = await db.auth();\n\n      if (auth.currentUser && !auth.currentUser.isAnonymous) {\n        const anon = await auth.signInAnonymously();\n        commit(\"ANONYMOUS_LOGIN\", anon);\n      }\n    },\n\n    /**\n     * **firebaseAuth**\n     *\n     * Connects to the Firebase Auth API and then registers a callback for any auth\n     * event (login/logout).\n     *\n     * Also enables the appropriate lifecycle hooks: `onLogOut`, `onLogIn`, and\n     * `onUserUpgrade` (when anonymous user logs into a known user)\n     */\n    async [FmConfigAction.firebaseAuth](store, config: IFiremodelConfig<T>) {\n      const { commit, rootState, dispatch } = store;\n\n      try {\n        const db = await database();\n        const auth = await db.auth();\n        FireModel.defaultDb = db;\n\n        const ctx: IFmAuthenticatatedContext<T> = {\n          Watch,\n          Record,\n          List,\n          auth,\n          db,\n          config,\n\n          dispatch,\n          commit,\n          state: rootState as T & { \"@firemodel\": IFiremodelState<T> }\n        };\n\n        auth.onAuthStateChanged(authChanged(ctx));\n        auth.setPersistence(\n          typeof config.auth === \"object\"\n            ? config.auth.persistence || \"session\"\n            : \"session\"\n        );\n      } catch (e) {\n        console.log(\"Problem hooking into onAuthStateChanged: \", e.message);\n        console.log(e.stack);\n      }\n    },\n\n    /**\n     * **watchRouteChanges**\n     *\n     * Enables lifecycle hooks for route changes\n     */\n    async [FmConfigAction.watchRouteChanges](\n      { dispatch, commit, rootState },\n      payload\n    ) {\n      if (configuration.onRouteChange) {\n        const ctx: IFmRouteEventContext<T> = {\n          Watch,\n          Record,\n          List,\n\n          dispatch,\n          commit,\n          state: rootState as T & { \"@firemodel\": IFiremodelState<T> },\n\n          leaving: payload.from.path,\n          entering: payload.to.path,\n          queryParams: payload.to.params\n        };\n        await runQueue(ctx, \"route-changed\");\n      }\n    }\n  } as ActionTree<IFiremodelState<T>, T>);\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3f1404d4b242a8bbdb158bde3809ea9a18e0f198","contentHash":"4500d2d2b9dfbe8816f453e6854d25ce5e2f7b3756417892d97f8a836cddb59e"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/actions/FmConfigActions.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/actions/FmConfigActions.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":4,"column":0},"end":{"line":11,"column":77}},"2":{"start":{"line":5,"column":4},"end":{"line":5,"column":42}},"3":{"start":{"line":6,"column":4},"end":{"line":6,"column":53}},"4":{"start":{"line":7,"column":4},"end":{"line":7,"column":57}},"5":{"start":{"line":8,"column":4},"end":{"line":8,"column":64}},"6":{"start":{"line":9,"column":4},"end":{"line":9,"column":56}},"7":{"start":{"line":10,"column":4},"end":{"line":10,"column":59}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":1},"end":{"line":4,"column":2}},"loc":{"start":{"line":4,"column":27},"end":{"line":11,"column":1}},"line":4}},"branchMap":{"0":{"loc":{"start":{"line":11,"column":20},"end":{"line":11,"column":75}},"type":"binary-expr","locations":[{"start":{"line":11,"column":20},"end":{"line":11,"column":42}},{"start":{"line":11,"column":47},"end":{"line":11,"column":74}}],"line":11}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/actions/FmConfigActions.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/actions/FmConfigActions.ts"],"names":[],"mappings":";;AAAA,IAAY,cAOX;AAPD,WAAY,cAAc;IACxB,qCAAmB,CAAA;IACnB,gDAA8B,CAAA;IAC9B,oDAAkC,CAAA;IAClC,2DAAyC,CAAA;IACzC,mDAAiC,CAAA;IACjC,sDAAoC,CAAA;AACtC,CAAC,EAPW,cAAc,GAAd,sBAAc,KAAd,sBAAc,QAOzB","sourcesContent":["export enum FmConfigAction {\n  connect = \"CONNECT\",\n  firebaseAuth = \"FIREBASE_AUTH\",\n  anonymousLogin = \"ANONYMOUS_LOGIN\",\n  watchRouteChanges = \"WATCH_ROUTE_CHANGES\",\n  routeChanged = \"CALL_ROUTE_HOOKS\",\n  watcherStarting = \"WATCHER_STARTING\"\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9ba21fe03aafe8ec56b59fa89ff76a54a8dc78f3","contentHash":"94ec66f386ccbd5a42cb34324662f59e76298f44b741040d28f8d48b40f96d6a"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/authChanges.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/authChanges.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":19},"end":{"line":3,"column":40}},"2":{"start":{"line":4,"column":12},"end":{"line":4,"column":25}},"3":{"start":{"line":7,"column":0},"end":{"line":44,"column":2}},"4":{"start":{"line":7,"column":35},"end":{"line":44,"column":1}},"5":{"start":{"line":8,"column":4},"end":{"line":43,"column":5}},"6":{"start":{"line":9,"column":8},"end":{"line":18,"column":9}},"7":{"start":{"line":10,"column":12},"end":{"line":10,"column":61}},"8":{"start":{"line":11,"column":12},"end":{"line":11,"column":93}},"9":{"start":{"line":12,"column":12},"end":{"line":15,"column":15}},"10":{"start":{"line":16,"column":12},"end":{"line":16,"column":65}},"11":{"start":{"line":17,"column":12},"end":{"line":17,"column":31}},"12":{"start":{"line":19,"column":8},"end":{"line":19,"column":37}},"13":{"start":{"line":20,"column":8},"end":{"line":20,"column":90}},"14":{"start":{"line":21,"column":8},"end":{"line":21,"column":83}},"15":{"start":{"line":22,"column":8},"end":{"line":22,"column":42}},"16":{"start":{"line":23,"column":22},"end":{"line":23,"column":51}},"17":{"start":{"line":24,"column":8},"end":{"line":24,"column":48}},"18":{"start":{"line":25,"column":8},"end":{"line":25,"column":24}},"19":{"start":{"line":26,"column":8},"end":{"line":26,"column":40}},"20":{"start":{"line":27,"column":8},"end":{"line":27,"column":212}},"21":{"start":{"line":28,"column":8},"end":{"line":28,"column":27}},"22":{"start":{"line":31,"column":8},"end":{"line":31,"column":38}},"23":{"start":{"line":32,"column":8},"end":{"line":32,"column":85}},"24":{"start":{"line":33,"column":8},"end":{"line":33,"column":156}},"25":{"start":{"line":34,"column":8},"end":{"line":34,"column":47}},"26":{"start":{"line":35,"column":8},"end":{"line":41,"column":9}},"27":{"start":{"line":38,"column":12},"end":{"line":38,"column":73}},"28":{"start":{"line":40,"column":12},"end":{"line":40,"column":45}},"29":{"start":{"line":42,"column":8},"end":{"line":42,"column":27}},"30":{"start":{"line":51,"column":4},"end":{"line":75,"column":10}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":7,"column":22},"end":{"line":7,"column":23}},"loc":{"start":{"line":7,"column":35},"end":{"line":44,"column":1}},"line":7},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":35},"end":{"line":7,"column":36}},"loc":{"start":{"line":7,"column":51},"end":{"line":44,"column":1}},"line":7},"2":{"name":"extractUserInfo","decl":{"start":{"line":50,"column":9},"end":{"line":50,"column":24}},"loc":{"start":{"line":50,"column":32},"end":{"line":76,"column":1}},"line":50}},"branchMap":{"0":{"loc":{"start":{"line":8,"column":4},"end":{"line":43,"column":5}},"type":"if","locations":[{"start":{"line":8,"column":4},"end":{"line":43,"column":5}},{"start":{"line":8,"column":4},"end":{"line":43,"column":5}}],"line":8},"1":{"loc":{"start":{"line":9,"column":8},"end":{"line":18,"column":9}},"type":"if","locations":[{"start":{"line":9,"column":8},"end":{"line":18,"column":9}},{"start":{"line":9,"column":8},"end":{"line":18,"column":9}}],"line":9},"2":{"loc":{"start":{"line":9,"column":12},"end":{"line":9,"column":54}},"type":"binary-expr","locations":[{"start":{"line":9,"column":12},"end":{"line":9,"column":29}},{"start":{"line":9,"column":33},"end":{"line":9,"column":54}}],"line":9},"3":{"loc":{"start":{"line":35,"column":8},"end":{"line":41,"column":9}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":41,"column":9}},{"start":{"line":35,"column":8},"end":{"line":41,"column":9}}],"line":35},"4":{"loc":{"start":{"line":35,"column":12},"end":{"line":37,"column":44}},"type":"binary-expr","locations":[{"start":{"line":35,"column":12},"end":{"line":35,"column":34}},{"start":{"line":36,"column":12},"end":{"line":36,"column":54}},{"start":{"line":37,"column":12},"end":{"line":37,"column":44}}],"line":35},"5":{"loc":{"start":{"line":51,"column":11},"end":{"line":75,"column":9}},"type":"cond-expr","locations":[{"start":{"line":52,"column":10},"end":{"line":64,"column":9}},{"start":{"line":65,"column":10},"end":{"line":75,"column":9}}],"line":51}},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":3,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":3,"23":3,"24":3,"25":3,"26":3,"27":0,"28":0,"29":3,"30":3},"f":{"0":3,"1":3,"2":3},"b":{"0":[0,3],"1":[0,0],"2":[0,0],"3":[0,3],"4":[3,3,0],"5":[0,3]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/authChanges.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/authChanges.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  FmConfigMutation,\n  IFmAuthenticatatedContext,\n  ICurrentUser,\n  IFmLoginEventContext,\n  IFmLogoutEventContext\n} from \"../types/index\";\nimport { User } from \"@firebase/auth-types\";\nimport { runQueue } from \"./runQueue\";\nimport { configuration } from \"..\";\n\nlet _uid: string;\nlet _isAnonymous: boolean;\n\nexport const authChanged = <T>(context: IFmAuthenticatatedContext<T>) => async (\n  user: User | null\n) => {\n  if (user) {\n    if (!user.isAnonymous && _isAnonymous === true) {\n      console.group('Starting \"user-abandoned\" event');\n      console.log(\n        `anonymous user ${_uid} was abandoned in favor of user ${user.uid}`\n      );\n      context.commit(FmConfigMutation.userAbandoned, {\n        user: user,\n        priorUid: _uid\n      });\n\n      await runQueue(context, \"user-abandoned\");\n      console.groupEnd();\n    }\n    console.group(\"Login Event\");\n    console.info(\n      `Login detected [uid: ${user.uid}, anonymous: ${user.isAnonymous}]`\n    );\n\n    context.commit(FmConfigMutation.userLoggedIn, extractUserInfo(user));\n\n    console.log(\"Getting auth token\");\n    const token = await user.getIdTokenResult();\n    context.commit(\"SET_AUTH_TOKEN\", token);\n    _uid = user.uid;\n    _isAnonymous = user.isAnonymous;\n    await runQueue(\n      {\n        ...context,\n        isLoggedIn: true,\n        isAnonymous: user.isAnonymous,\n        uid: user.uid,\n        email: user.email,\n        emailVerified: user.emailVerified\n      } as IFmLoginEventContext<T>,\n      \"logged-in\"\n    );\n\n    console.groupEnd();\n  } else {\n    console.group(\"Logout event\");\n    context.commit(FmConfigMutation.userLoggedOut, extractUserInfo(user));\n    await runQueue(\n      {\n        ...context,\n        isLoggedIn: false,\n        isAnonymous: false,\n        emailVerified: false\n      } as IFmLogoutEventContext<T>,\n      \"logged-out\"\n    );\n    console.log(\"finished onLogout queue\");\n\n    if (\n      configuration.auth &&\n      typeof configuration.auth === \"object\" &&\n      configuration.auth.anonymous\n    ) {\n      console.info(\"logging in as a anonymous user (momentarily)\");\n      // async but we don't need to wait for it\n      context.auth.signInAnonymously();\n    }\n\n    console.groupEnd();\n  }\n};\n\n/**\n * Extracts the odd shaped object we're getting back in place of a true\n * `User` object with something useful for putting into the @firemodel\n * Vuex module.\n */\nfunction extractUserInfo(input: User | null): ICurrentUser {\n  return input\n    ? {\n        uid: input.uid,\n        isAnonymous: input.isAnonymous,\n        isLoggedIn: true,\n        displayName: input.displayName,\n        email: input.email,\n        emailVerified: input.emailVerified,\n        phoneNumber: input.phoneNumber,\n        photoUrl: input.photoURL,\n        refreshToken: input.refreshToken,\n        lastSignIn: input.metadata.lastSignInTime,\n        createdAt: input.metadata.creationTime\n      }\n    : {\n        uid: \"\",\n        isAnonymous: false,\n        isLoggedIn: false,\n        displayName: null,\n        email: null,\n        emailVerified: false,\n        phoneNumber: null,\n        photoUrl: null,\n        refreshToken: \"\"\n      };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a3cfa87662176d65c2670fc0d0de5e2b4f325f93","contentHash":"0b810d74482d8d594afd85f9963b69682a1999261319685185b847b841a8a9fe"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/runQueue.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/runQueue.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":24},"end":{"line":6,"column":65}},"4":{"start":{"line":13,"column":32},"end":{"line":13,"column":34}},"5":{"start":{"line":14,"column":19},"end":{"line":14,"column":81}},"6":{"start":{"line":14,"column":62},"end":{"line":14,"column":80}},"7":{"start":{"line":15,"column":17},"end":{"line":15,"column":18}},"8":{"start":{"line":16,"column":20},"end":{"line":16,"column":21}},"9":{"start":{"line":17,"column":4},"end":{"line":44,"column":5}},"10":{"start":{"line":18,"column":8},"end":{"line":43,"column":9}},"11":{"start":{"line":19,"column":12},"end":{"line":19,"column":31}},"12":{"start":{"line":20,"column":12},"end":{"line":20,"column":24}},"13":{"start":{"line":23,"column":12},"end":{"line":23,"column":21}},"14":{"start":{"line":24,"column":12},"end":{"line":36,"column":13}},"15":{"start":{"line":25,"column":31},"end":{"line":25,"column":92}},"16":{"start":{"line":26,"column":30},"end":{"line":31,"column":31}},"17":{"start":{"line":29,"column":20},"end":{"line":29,"column":242}},"18":{"start":{"line":32,"column":16},"end":{"line":32,"column":102}},"19":{"start":{"line":35,"column":16},"end":{"line":35,"column":215}},"20":{"start":{"line":37,"column":12},"end":{"line":41,"column":15}},"21":{"start":{"line":42,"column":12},"end":{"line":42,"column":120}},"22":{"start":{"line":45,"column":4},"end":{"line":47,"column":5}},"23":{"start":{"line":46,"column":8},"end":{"line":46,"column":179}},"24":{"start":{"line":48,"column":4},"end":{"line":51,"column":7}},"25":{"start":{"line":50,"column":44},"end":{"line":50,"column":62}},"26":{"start":{"line":50,"column":73},"end":{"line":50,"column":79}},"27":{"start":{"line":53,"column":0},"end":{"line":53,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"runQueue","decl":{"start":{"line":12,"column":15},"end":{"line":12,"column":23}},"loc":{"start":{"line":12,"column":40},"end":{"line":52,"column":1}},"line":12},"2":{"name":"(anonymous_2)","decl":{"start":{"line":14,"column":57},"end":{"line":14,"column":58}},"loc":{"start":{"line":14,"column":62},"end":{"line":14,"column":80}},"line":14},"3":{"name":"(anonymous_3)","decl":{"start":{"line":27,"column":25},"end":{"line":27,"column":26}},"loc":{"start":{"line":27,"column":30},"end":{"line":30,"column":17}},"line":27},"4":{"name":"(anonymous_4)","decl":{"start":{"line":50,"column":39},"end":{"line":50,"column":40}},"loc":{"start":{"line":50,"column":44},"end":{"line":50,"column":62}},"line":50},"5":{"name":"(anonymous_5)","decl":{"start":{"line":50,"column":68},"end":{"line":50,"column":69}},"loc":{"start":{"line":50,"column":73},"end":{"line":50,"column":79}},"line":50}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":29,"column":33},"end":{"line":29,"column":126}},"type":"cond-expr","locations":[{"start":{"line":29,"column":79},"end":{"line":29,"column":85}},{"start":{"line":29,"column":88},"end":{"line":29,"column":126}}],"line":29},"4":{"loc":{"start":{"line":29,"column":33},"end":{"line":29,"column":76}},"type":"binary-expr","locations":[{"start":{"line":29,"column":33},"end":{"line":29,"column":59}},{"start":{"line":29,"column":63},"end":{"line":29,"column":76}}],"line":29},"5":{"loc":{"start":{"line":29,"column":148},"end":{"line":29,"column":191}},"type":"cond-expr","locations":[{"start":{"line":29,"column":157},"end":{"line":29,"column":186}},{"start":{"line":29,"column":189},"end":{"line":29,"column":191}}],"line":29},"6":{"loc":{"start":{"line":35,"column":147},"end":{"line":35,"column":211}},"type":"cond-expr","locations":[{"start":{"line":35,"column":157},"end":{"line":35,"column":188}},{"start":{"line":35,"column":191},"end":{"line":35,"column":211}}],"line":35},"7":{"loc":{"start":{"line":39,"column":22},"end":{"line":39,"column":38}},"type":"binary-expr","locations":[{"start":{"line":39,"column":22},"end":{"line":39,"column":28}},{"start":{"line":39,"column":32},"end":{"line":39,"column":38}}],"line":39},"8":{"loc":{"start":{"line":45,"column":4},"end":{"line":47,"column":5}},"type":"if","locations":[{"start":{"line":45,"column":4},"end":{"line":47,"column":5}},{"start":{"line":45,"column":4},"end":{"line":47,"column":5}}],"line":45}},"s":{"0":1,"1":1,"2":1,"3":1,"4":6,"5":6,"6":30,"7":6,"8":6,"9":6,"10":6,"11":6,"12":6,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":6,"23":0,"24":6,"25":6,"26":6,"27":1},"f":{"0":1,"1":6,"2":30,"3":0,"4":6,"5":6},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,6]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/runQueue.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/runQueue.ts"],"names":[],"mappings":";;;;;AAQA,kEAAuC;AAEvC;;;;GAIG;AACI,KAAK,UAAU,QAAQ,CAC5B,GAA2B,EAC3B,SAA6B;IAE7B,MAAM,mBAAmB,GAAyB,EAAE,CAAC;IACrD,MAAM,MAAM,GAAG,GAAG,CAAC,KAAK,CAAC,YAAY,CAAC,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,SAAS,CAAC,CAAC;IAE9E,IAAI,MAAM,GAAG,CAAC,CAAC;IACf,IAAI,SAAS,GAAG,CAAC,CAAC;IAElB,KAAK,MAAM,IAAI,IAAI,MAAM,EAAE;QACzB,IAAI;YACF,MAAM,IAAI,CAAC,EAAE,CAAC,GAAG,CAAC,CAAC;YACnB,SAAS,EAAE,CAAC;SACb;QAAC,OAAO,CAAC,EAAE;YACV,MAAM,EAAE,CAAC;YAET,IAAI;gBACF,MAAM,MAAM,GAAG,MAAM,uBAAU,CAAC,SAAS,CAAC,CAAC,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC,CAAC;gBAChE,MAAM,KAAK,GAAG,MAAM,MAAM;qBACvB,GAAG,CACF,CAAC,CAAC,EAAE;;oBACF,OAAA,MAAM,MAAA,CAAC,CAAC,QAAQ,0CAAE,OAAO,CAAC,sBAAsB,EAAE,EAAE,CAAC,IACnD,CAAC,CAAC,YACJ,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,CAAC,GAAG,GAAG,CAAC,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,GAAG,CAAC,CAAC,CAAC,EAAE,aAC7C,CAAC,CAAC,UACJ,SAAS,CAAC,CAAC,YAAY,EAAE,CAAA;iBAAA,CAC5B;qBACA,IAAI,CAAC,IAAI,CAAC,CAAC;gBACd,OAAO,CAAC,KAAK,CACX,YAAY,IAAI,CAAC,IAAI,KAAK,CAAC,CAAC,OAAO,4BAA4B,KAAK,EAAE,CACvE,CAAC;aACH;YAAC,OAAO,EAAE,EAAE;gBACX,OAAO,CAAC,KAAK,CACX,YAAY,IAAI,CAAC,IAAI,KACnB,CAAC,CAAC,OACJ,kFACE,IAAI,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC,EAAE,CAAC,QAAQ,EAAE,CAAC,KAAK,CAAC,CAAC,EAAE,EAAE,CAAC,CAAC,CAAC,CAAC,oBAC9C,EAAE,CACH,CAAC;aACH;YAED,GAAG,CAAC,MAAM,CAAC,OAAO,EAAE;gBAClB,OAAO,EAAE,CAAC,CAAC,OAAO;gBAClB,IAAI,EAAE,CAAC,CAAC,IAAI,IAAI,CAAC,CAAC,IAAI;gBACtB,KAAK,EAAE,CAAC,CAAC,KAAK;aACf,CAAC,CAAC;YACH,mBAAmB,CAAC,IAAI,iCACnB,IAAI,GACJ,EAAE,KAAK,EAAE,CAAC,CAAC,OAAO,EAAE,UAAU,EAAE,CAAC,CAAC,KAAK,EAAE,EAC5C,CAAC;SACJ;KACF;IACD,IAAI,MAAM,GAAG,CAAC,EAAE;QACd,OAAO,CAAC,IAAI,CACV,uBAAuB,SAAS,WAAW,MAAM,8BAA8B,SAAS,oEAAoE,CAC7J,CAAC;KACH;IAED,GAAG,CAAC,MAAM,4DAA2C;QACnD,KAAK,EAAE,SAAS;QAChB,eAAe,EAAE,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,SAAS,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;KACzE,CAAC,CAAC;AACL,CAAC;AA/DD,4BA+DC","sourcesContent":["import {\n  IFmLifecycleEvents,\n  IFmQueuedAction,\n  FmConfigMutation,\n  IFmLifecycleContext,\n  IFiremodelState\n} from \"../types/index\";\n\nimport StackTrace from \"stacktrace-js\";\n\n/**\n * **runQueue**\n *\n * pulls items off the lifecycle queue which match the lifecycle event\n */\nexport async function runQueue<T>(\n  ctx: IFmLifecycleContext<T>,\n  lifecycle: IFmLifecycleEvents\n) {\n  const remainingQueueItems: IFmQueuedAction<T>[] = [];\n  const queued = ctx.state[\"@firemodel\"].queued.filter(i => i.on === lifecycle);\n\n  let errors = 0;\n  let successes = 0;\n\n  for (const item of queued) {\n    try {\n      await item.cb(ctx);\n      successes++;\n    } catch (e) {\n      errors++;\n\n      try {\n        const frames = await StackTrace.fromError(e, { offline: true });\n        const stack = await frames\n          .map(\n            i =>\n              ` - ${i.fileName?.replace(\"webpack-internal:///\", \"\")}:${\n                i.functionName\n              }(${i.args ? \" \" + i.args.join(\", \") + \" \" : \"\"}) at line ${\n                i.lineNumber\n              }, col ${i.columnNumber}`\n          )\n          .join(\"\\n\");\n        console.error(\n          `deQueing ${item.name}: ${e.message}.\\n\\nThe stacktrace is:\\n${stack}`\n        );\n      } catch (se) {\n        console.error(\n          `deQueing ${item.name}: ${\n            e.message\n          }.\\n\\nThe callback which being called when the error occurred starts like this: ${\n            item.cb ? item.cb.toString().slice(0, 50) : \"undefined callback\"\n          }`\n        );\n      }\n\n      ctx.commit(\"error\", {\n        message: e.message,\n        code: e.code || e.name,\n        stack: e.stack\n      });\n      remainingQueueItems.push({\n        ...item,\n        ...{ error: e.message, errorStack: e.stack }\n      });\n    }\n  }\n  if (errors > 0) {\n    console.warn(\n      `- while running the ${lifecycle} event, ${errors} errors were encountered [ ${successes} successful ]; errors will be listed in the @firemodel state tree.`\n    );\n  }\n\n  ctx.commit(FmConfigMutation.lifecycleEventCompleted, {\n    event: lifecycle,\n    actionCallbacks: queued.filter(i => i.on === lifecycle).map(i => i.name)\n  });\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1c276909bd250ab3279b61f0148beaf2d2520727","contentHash":"ed4489235cde209b6e5eef7ddf11578a691f9261b8204803dc12718cf6e0b371"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/addNamespace.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/addNamespace.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":5,"column":4},"end":{"line":5,"column":33}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":36}}},"fnMap":{"0":{"name":"addNamespace","decl":{"start":{"line":4,"column":9},"end":{"line":4,"column":21}},"loc":{"start":{"line":4,"column":29},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":24,"2":1},"f":{"0":24},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/addNamespace.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/addNamespace.ts"],"names":[],"mappings":";;AAAA,mEAAmE;AACnE,SAAgB,YAAY,CAAC,KAAa;IACxC,OAAO,cAAc,KAAK,EAAE,CAAC;AAC/B,CAAC;AAFD,oCAEC","sourcesContent":["/** adds the `@firemodel` namespace in front of a localized name */\nexport function addNamespace(event: string) {\n  return `@firemodel/${event}`;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"0f1d998afddebf1349ef5ba2c797d6cb715ddecc","contentHash":"d07c2a7214d0b1ca6c288aba68ca1527937cf4fb46db8f082e977b8fa69f7368"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/coreServices.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/coreServices.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":23},"end":{"line":3,"column":55}},"2":{"start":{"line":4,"column":18},"end":{"line":4,"column":44}},"3":{"start":{"line":5,"column":16},"end":{"line":5,"column":34}},"4":{"start":{"line":11,"column":21},"end":{"line":11,"column":23}},"5":{"start":{"line":12,"column":4},"end":{"line":16,"column":5}},"6":{"start":{"line":13,"column":8},"end":{"line":13,"column":42}},"7":{"start":{"line":14,"column":8},"end":{"line":14,"column":36}},"8":{"start":{"line":15,"column":8},"end":{"line":15,"column":112}},"9":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"10":{"start":{"line":18,"column":8},"end":{"line":18,"column":114}},"11":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"12":{"start":{"line":21,"column":8},"end":{"line":21,"column":111}},"13":{"start":{"line":23,"column":4},"end":{"line":23,"column":32}},"14":{"start":{"line":24,"column":4},"end":{"line":27,"column":7}},"15":{"start":{"line":29,"column":0},"end":{"line":29,"column":36}}},"fnMap":{"0":{"name":"coreServices","decl":{"start":{"line":10,"column":15},"end":{"line":10,"column":27}},"loc":{"start":{"line":10,"column":43},"end":{"line":28,"column":1}},"line":10}},"branchMap":{"0":{"loc":{"start":{"line":12,"column":4},"end":{"line":16,"column":5}},"type":"if","locations":[{"start":{"line":12,"column":4},"end":{"line":16,"column":5}},{"start":{"line":12,"column":4},"end":{"line":16,"column":5}}],"line":12},"1":{"loc":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},{"start":{"line":17,"column":4},"end":{"line":19,"column":5}}],"line":17},"2":{"loc":{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":22,"column":5}},{"start":{"line":20,"column":4},"end":{"line":22,"column":5}}],"line":20}},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":3,"6":3,"7":3,"8":3,"9":3,"10":3,"11":3,"12":0,"13":3,"14":3,"15":1},"f":{"0":3},"b":{"0":[3,0],"1":[3,0],"2":[0,3]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/coreServices.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/coreServices.ts"],"names":[],"mappings":";;AACA,wDAAqD;AACrD,6CAAiD;AAGjD,mCAAmC;AAEnC;;;GAGG;AACI,KAAK,UAAU,YAAY,CAChC,KAAe,EACf,MAA2B;IAE3B,MAAM,QAAQ,GAAmB,EAAE,CAAC;IACpC,IAAI,MAAM,CAAC,OAAO,EAAE;QAClB,MAAM,gBAAQ,CAAC,MAAM,CAAC,EAAE,CAAC,CAAC;QAC1B,OAAO,CAAC,GAAG,CAAC,cAAc,CAAC,CAAC;QAE5B,QAAQ,CAAC,IAAI,CACX,KAAK,CAAC,QAAQ,CAAC,2BAAY,CAAC,wBAAc,CAAC,OAAO,CAAC,EAAE,MAAM,CAAC,EAAE,CAAC,CAChE,CAAC;KACH;IAED,IAAI,MAAM,CAAC,IAAI,EAAE;QACf,QAAQ,CAAC,IAAI,CACX,KAAK,CAAC,QAAQ,CAAC,2BAAY,CAAC,wBAAc,CAAC,YAAY,CAAC,EAAE,MAAM,CAAC,CAClE,CAAC;KACH;IAED,IAAI,MAAM,CAAC,YAAY,EAAE;QACvB,QAAQ,CAAC,IAAI,CACX,KAAK,CAAC,QAAQ,CAAC,2BAAY,CAAC,wBAAc,CAAC,iBAAiB,CAAC,CAAC,CAC/D,CAAC;KACH;IACD,MAAM,OAAO,CAAC,GAAG,CAAC,QAAQ,CAAC,CAAC;IAE5B,KAAK,CAAC,MAAM,CAAC,2BAAY,mDAAsC,EAAE;QAC/D,OAAO,EAAE,4CAA4C;QACrD,MAAM,EAAE,MAAM,CAAC,EAAE;KAClB,CAAC,CAAC;AACL,CAAC;AA/BD,oCA+BC","sourcesContent":["import { Store } from \"vuex\";\nimport { addNamespace } from \"./shared/addNamespace\";\nimport { FmConfigAction } from \"./types/actions\";\nimport { FmConfigMutation } from \"./types/mutations/FmConfigMutation\";\nimport { IFiremodelConfig } from \"./types/index\";\nimport { database } from \"./store\";\n\n/**\n * Based on the configuration passed in by the consuming app, core\n * services will be started by firing off the appropriate Vuex _action_.\n */\nexport async function coreServices<T>(\n  store: Store<T>,\n  config: IFiremodelConfig<T>\n) {\n  const starting: Promise<any>[] = [];\n  if (config.connect) {\n    await database(config.db);\n    console.log(\"db connected\");\n\n    starting.push(\n      store.dispatch(addNamespace(FmConfigAction.connect), config.db)\n    );\n  }\n\n  if (config.auth) {\n    starting.push(\n      store.dispatch(addNamespace(FmConfigAction.firebaseAuth), config)\n    );\n  }\n\n  if (config.routeChanges) {\n    starting.push(\n      store.dispatch(addNamespace(FmConfigAction.watchRouteChanges))\n    );\n  }\n  await Promise.all(starting);\n\n  store.commit(addNamespace(FmConfigMutation.coreServicesStarted), {\n    message: `all core firemodel plugin services started`,\n    config: config.db\n  });\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"ab1675d8b875862a88ff2342200f35a4eadc420f","contentHash":"8a393e98a3c7f12c15ed047144a2a176502d8068c3a5fffb758b9d77f1081fc8"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/actions/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/actions/index.ts","statementMap":{"0":{"start":{"line":3,"column":4},"end":{"line":3,"column":71}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"2":{"start":{"line":3,"column":53},"end":{"line":3,"column":71}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":39}}},"fnMap":{"0":{"name":"__export","decl":{"start":{"line":2,"column":9},"end":{"line":2,"column":17}},"loc":{"start":{"line":2,"column":21},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"type":"if","locations":[{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},{"start":{"line":3,"column":21},"end":{"line":3,"column":71}}],"line":3}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1},"f":{"0":1},"b":{"0":[1,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/actions/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/actions/index.ts"],"names":[],"mappings":";;;;;AAEA,uCAAkC","sourcesContent":["import { FmConfigAction } from \"./FmConfigActions\";\nimport { FmEvents } from \"firemodel\";\nexport * from \"./FmConfigActions\";\n\nexport type IFmConfigActions = keyof typeof FmConfigAction;\nexport type IFmCrudActions = keyof typeof FmEvents;\nexport type IFmActions = IFmConfigActions & IFmCrudActions;\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"83c6061fc7b7668f07254feb90052e60bce9d748","contentHash":"fbed354364480a70bb56adf7a53fb1023ec3c57626333ad34e398c0532870a2a"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/index.ts","statementMap":{"0":{"start":{"line":3,"column":4},"end":{"line":3,"column":71}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"2":{"start":{"line":3,"column":53},"end":{"line":3,"column":71}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":28}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":27}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":50}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":48}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":37}}},"fnMap":{"0":{"name":"__export","decl":{"start":{"line":2,"column":9},"end":{"line":2,"column":17}},"loc":{"start":{"line":2,"column":21},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"type":"if","locations":[{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},{"start":{"line":3,"column":21},"end":{"line":3,"column":71}}],"line":3}},"s":{"0":5,"1":6,"2":6,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1},"f":{"0":5},"b":{"0":[6,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/index.ts"],"names":[],"mappings":";;;;;AACA,4BAAuB;AACvB,2BAAsB;AAEtB,kDAA6C;AAC7C,gDAA2C;AAC3C,qCAAgC","sourcesContent":["export * from \"./firemodel\";\nexport * from \"./auth\";\nexport * from \"./abc\";\nexport * from \"./config\";\nexport * from \"./mutations/FmConfigMutation\";\nexport * from \"./mutations/FmCrudMutation\";\nexport * from \"./actions/index\";\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9689b315d46278682a86c41976ac26b696379d80","contentHash":"10076ead8ca869d9acadf297201fdeb0946323b9b5d3246b3e8cd26a4a502f9c"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/auth.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/auth.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":4,"column":0},"end":{"line":23,"column":104}},"2":{"start":{"line":11,"column":4},"end":{"line":11,"column":47}},"3":{"start":{"line":17,"column":4},"end":{"line":17,"column":51}},"4":{"start":{"line":22,"column":4},"end":{"line":22,"column":45}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":4,"column":1},"end":{"line":4,"column":2}},"loc":{"start":{"line":4,"column":36},"end":{"line":23,"column":1}},"line":4}},"branchMap":{"0":{"loc":{"start":{"line":23,"column":29},"end":{"line":23,"column":102}},"type":"binary-expr","locations":[{"start":{"line":23,"column":29},"end":{"line":23,"column":60}},{"start":{"line":23,"column":65},"end":{"line":23,"column":101}}],"line":23}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1},"f":{"0":1},"b":{"0":[1,1]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/auth.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/auth.ts"],"names":[],"mappings":";;AAKA,IAAY,uBAmBX;AAnBD,WAAY,uBAAuB;IACjC;;;;;OAKG;IACH,0CAAe,CAAA;IACf;;;;OAIG;IACH,8CAAmB,CAAA;IACnB;;;OAGG;IACH,wCAAa,CAAA;AACf,CAAC,EAnBW,uBAAuB,GAAvB,+BAAuB,KAAvB,+BAAuB,QAmBlC","sourcesContent":["import { Model, Watch, Record } from \"firemodel\";\nimport { Store, Dispatch, Commit } from \"vuex\";\nimport { IFiremodelState } from \"./firemodel\";\nimport { IDictionary } from \"firemock\";\n\nexport enum AuthPersistenceStrategy {\n  /**\n   * Indicates that the state will be persisted even when the browser window is closed\n   * or the activity is destroyed in React Native. An explicit sign out is needed to\n   * clear that state. Note that Firebase Auth web sessions are single host origin\n   * and will be persisted for a single domain only.\n   */\n  local = \"local\",\n  /**\n   * Indicates that the state will only persist in the current session or tab, and will\n   * be cleared when the tab or window in which the user authenticated is closed. Applies\n   * only to web apps.\n   */\n  session = \"session\",\n  /**\n   * Indicates that the state will only be stored in memory and will be cleared when the\n   * window or activity is refreshed.\n   */\n  none = \"none\"\n}\n\nexport type IAuthPersistenceStrategy = keyof typeof AuthPersistenceStrategy;\n\n/**\n * The payload of a `@firemodel/SIGNED_OUT` action and downstream mutations to both\n * `@firemodel` and other stateful modules. The mutations include both _reset_ messages\n * as well as the `[module]/SIGNED_OUT` mutations\n */\nexport interface ISignOutPayload<T extends Model = Model> {\n  /** the `uid` of the user who is being signed out */\n  uid: string;\n  email?: string;\n  /**\n   * An identifier of the **Firemodel** `Model` which stores the user profile. This can either\n   * but the _constructor_ for the model or you can simply pass in a string \"dot\" path to the\n   * local path in the Vuex state tree.\n   */\n  model?: (new () => T) | string;\n}\n\nexport interface IAuthProfile {\n  displayName?: string;\n  photoURL?: string;\n}\n\nexport interface ICurrentUser {\n  uid: string;\n  displayName: string | null;\n  email: string | null;\n  emailVerified: boolean;\n  isAnonymous: boolean;\n  isLoggedIn: boolean;\n  phoneNumber: string | null;\n  photoUrl: string | null;\n  refreshToken: string;\n  lastSignIn?: string;\n  createdAt?: string;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"af43b148319243238bd853839757d85f5c47b3ef","contentHash":"322cfeec1995d63de898f4d82cf8ad4bf1fcbbf1abd5999d8ddbdab5bff6fb64"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/abc.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/abc.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":4,"column":4},"end":{"line":4,"column":41}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":46}},"3":{"start":{"line":8,"column":0},"end":{"line":65,"column":68}},"4":{"start":{"line":15,"column":4},"end":{"line":15,"column":73}},"5":{"start":{"line":20,"column":4},"end":{"line":20,"column":63}},"6":{"start":{"line":24,"column":4},"end":{"line":24,"column":49}},"7":{"start":{"line":28,"column":4},"end":{"line":28,"column":59}},"8":{"start":{"line":32,"column":4},"end":{"line":32,"column":63}},"9":{"start":{"line":36,"column":4},"end":{"line":36,"column":79}},"10":{"start":{"line":40,"column":4},"end":{"line":40,"column":87}},"11":{"start":{"line":46,"column":4},"end":{"line":46,"column":71}},"12":{"start":{"line":50,"column":4},"end":{"line":50,"column":67}},"13":{"start":{"line":54,"column":4},"end":{"line":54,"column":83}},"14":{"start":{"line":59,"column":4},"end":{"line":59,"column":79}},"15":{"start":{"line":64,"column":4},"end":{"line":64,"column":81}},"16":{"start":{"line":67,"column":0},"end":{"line":71,"column":74}},"17":{"start":{"line":68,"column":4},"end":{"line":68,"column":35}},"18":{"start":{"line":69,"column":4},"end":{"line":69,"column":45}},"19":{"start":{"line":70,"column":4},"end":{"line":70,"column":43}},"20":{"start":{"line":73,"column":0},"end":{"line":77,"column":62}},"21":{"start":{"line":74,"column":4},"end":{"line":74,"column":29}},"22":{"start":{"line":75,"column":4},"end":{"line":75,"column":33}},"23":{"start":{"line":76,"column":4},"end":{"line":76,"column":33}}},"fnMap":{"0":{"name":"isDiscreteRequest","decl":{"start":{"line":3,"column":9},"end":{"line":3,"column":26}},"loc":{"start":{"line":3,"column":36},"end":{"line":5,"column":1}},"line":3},"1":{"name":"(anonymous_1)","decl":{"start":{"line":8,"column":1},"end":{"line":8,"column":2}},"loc":{"start":{"line":8,"column":24},"end":{"line":65,"column":1}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":67,"column":1},"end":{"line":67,"column":2}},"loc":{"start":{"line":67,"column":26},"end":{"line":71,"column":1}},"line":67},"3":{"name":"(anonymous_3)","decl":{"start":{"line":73,"column":1},"end":{"line":73,"column":2}},"loc":{"start":{"line":73,"column":22},"end":{"line":77,"column":1}},"line":73}},"branchMap":{"0":{"loc":{"start":{"line":65,"column":17},"end":{"line":65,"column":66}},"type":"binary-expr","locations":[{"start":{"line":65,"column":17},"end":{"line":65,"column":36}},{"start":{"line":65,"column":41},"end":{"line":65,"column":65}}],"line":65},"1":{"loc":{"start":{"line":71,"column":19},"end":{"line":71,"column":72}},"type":"binary-expr","locations":[{"start":{"line":71,"column":19},"end":{"line":71,"column":40}},{"start":{"line":71,"column":45},"end":{"line":71,"column":71}}],"line":71},"2":{"loc":{"start":{"line":77,"column":15},"end":{"line":77,"column":60}},"type":"binary-expr","locations":[{"start":{"line":77,"column":15},"end":{"line":77,"column":32}},{"start":{"line":77,"column":37},"end":{"line":77,"column":59}}],"line":77}},"s":{"0":1,"1":0,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1},"f":{"0":0,"1":1,"2":1,"3":1},"b":{"0":[1,1],"1":[1,1],"2":[1,1]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/abc.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/abc.ts"],"names":[],"mappings":";;AAiFA,SAAgB,iBAAiB,CAC/B,OAAqB;IAErB,OAAO,OAAO,OAAO,KAAK,UAAU,CAAC;AACvC,CAAC;AAJD,8CAIC;AAqHD,IAAY,WAyDX;AAzDD,WAAY,WAAW;IACrB;;;;;OAKG;IACH,oEAAqD,CAAA;IACrD;;;OAGG;IACH,0DAA2C,CAAA;IAC3C;;OAEG;IACH,4CAA6B,CAAA;IAC7B;;OAEG;IACH,sDAAuC,CAAA;IACvC;;OAEG;IACH,0DAA2C,CAAA;IAC3C;;OAEG;IACH,0EAA2D,CAAA;IAC3D;;OAEG;IACH,kFAAmE,CAAA;IACnE;;;;OAIG;IACH,kEAAmD,CAAA;IACnD;;OAEG;IACH,8DAA+C,CAAA;IAC/C;;OAEG;IACH,8EAA+D,CAAA;IAC/D;;;OAGG;IACH,0EAA2D,CAAA;IAC3D;;;OAGG;IACH,4EAA6D,CAAA;AAC/D,CAAC,EAzDW,WAAW,GAAX,mBAAW,KAAX,mBAAW,QAyDtB;AAED,IAAY,aAIX;AAJD,WAAY,aAAa;IACvB,8BAAa,CAAA;IACb,wCAAuB,CAAA;IACvB,sCAAqB,CAAA;AACvB,CAAC,EAJW,aAAa,GAAb,qBAAa,KAAb,qBAAa,QAIxB;AAED,IAAY,SAIX;AAJD,WAAY,SAAS;IACnB,wBAAW,CAAA;IACX,4BAAe,CAAA;IACf,4BAAe,CAAA;AACjB,CAAC,EAJW,SAAS,GAAT,iBAAS,KAAT,iBAAS,QAIpB","sourcesContent":["import { IFmModelConstructor } from \"./config\";\nimport { Model, IPrimaryKey, fk, ICompositeKey } from \"firemodel\";\nimport { IDictionary } from \"firemock\";\nimport { AbcApi } from \"../abc/api/AbcApi\";\nimport { DB } from \"abstracted-client\";\nimport { AbcResult } from \"../abc\";\nimport { epochWithMilliseconds } from \"common-types\";\n\nexport interface IAbcApiConfig<T extends Model> {\n  /**\n   * indicates whether the Vuex store is storing a _list_\n   * of this type of `Model` or just a single _record_.\n   */\n  isList?: boolean;\n  /**\n   * indicates whether this API instantiation should cache data\n   * in the **IndexedDB** or not.\n   */\n  useIndexedDb?: boolean;\n  /**\n   * indicates that the underlying `Model` of this API has _some_\n   * properties which are sensitive and these should be encrypted\n   * and decrypted when saving to **IndexedDB**.\n   *\n   * The properties which are encrypted will be those which have\n   * the `@encrypt` decorator in their model definition.\n   */\n  encrypt?: boolean;\n  /**\n   * You can explicitly set the database access; if not set as an\n   * option then it will rely on **Firemodel**'s _defaultDb_ being\n   * set.\n   */\n  db?: DB;\n\n  /**\n   * Firemodel typically determines the local path for you but\n   * if you need to you can override this path a whatever you like.\n   *\n   * **Note:** this path will be used not only in the **ABC** API but also when\n   * responding to Firemodel mutations as well.\n   */\n  moduleName?: string;\n}\n\n/**\n * Any of the provided Query Helpers which include\n * `all`, `since`, and `where`\n */\nexport interface IAbcQueryHelper<T> {\n  (defn: IAbcAllQueryDefinition<T>): IAbcQueryRequest<T>;\n  isQueryHelper: true;\n}\n\n/**\n * Recieves a _list_ of type T and returns either the same\n * list or a subset of it.\n */\nexport interface IAbcPostWatcher<T extends Model> {\n  (results: T[]): T[];\n}\n\n/** An **ABC** request for discrete primary keys */\nexport interface IAbcDiscreteRequest<T extends Model> extends IAbcRequest<T> {\n  (pks: IPrimaryKey<T>[], options?: IAbcOptions<T>): Promise<AbcResult<T>>;\n}\n\nexport type IAbcParam<T> = IPrimaryKey<T>[] | IAbcQueryRequest<T>;\n\n/** An **ABC** request for records using a Query Helper */\nexport interface IAbcQueryRequest<T extends Model> {\n  (command: AbcRequestCommand, ctx: AbcApi<T>): Promise<AbcResult<T>>;\n}\n\n/**\n * Any valid ABC request including both Discrete and Query based requests\n */\nexport interface IAbcRequest<T> {\n  (param: IAbcParam<T>, options?: IAbcOptions<T>): Promise<AbcResult<T>>;\n}\n\nexport function isDiscreteRequest<T>(\n  request: IAbcParam<T>\n): request is IPrimaryKey<T>[] {\n  return typeof request !== \"function\";\n}\n\n/** The specific **ABC** request command */\nexport type AbcRequestCommand = \"get\" | \"load\";\n\nexport interface IQueryLocalResults<T, K = IDictionary> {\n  records: T[];\n  localPks: string[];\n  vuexPks: string[];\n  indexedDbPks: string[];\n}\n\n/**\n * Results from a Query request to Firebase server\n */\nexport interface IQueryServerResults<T, K = IDictionary> {\n  records: T[];\n  /** all of the primary keys which were received by the Firebase query */\n  serverPks: string[];\n  /** the primary keys which were found by Firebase but not known by local state */\n  newPks: string[];\n  /** the primary keys which had been correctly represented in local/cache state */\n  cacheHits: string[];\n  /** the primary keys which had stale data in local state */\n  stalePks: string[];\n  /** pks removed from IndexedDB */\n  removeFromIdx: string[];\n  /** pks removed from Vuex */\n  removeFromVuex: string[];\n  overallCachePerformance: ICachePerformance;\n}\n\n/**\n * Results from an ABC get/load which were retrieved from\n * the combined knowledge of Vuex and IndexedDB. The records\n * presented will favor data in Vuex over IndexedDB if there\n * is ever a conflict.\n */\nexport interface IDiscreteLocalResults<T, K = IDictionary>\n  extends IAbcResultsMeta<T> {\n  /** How many of the records _were_ found locally */\n  cacheHits: number;\n  /**\n   * How many of the records were not found locally\n   */\n  cacheMisses: number;\n\n  /**\n   * Boolean flag indicating whether all requested foreign keys\n   * were found locally\n   */\n  allFoundLocally: boolean;\n  /**\n   * The array of primary keys which were found in **Vuex**\n   */\n  foundInVuex: string[];\n  /**\n   * The array of primary keys which were found in **IndexedDb**\n   */\n  foundInIndexedDb: string[];\n  /**\n   * Those primary keys which were _not_ in Vuex but were found in\n   * **IndexedDB**\n   */\n  foundExclusivelyInIndexedDb: string[];\n  /**\n   * The records which were gotten from the Vuex and IndexedDB\n   */\n  records: T[];\n  /**\n   * The primary keys (in string form) which were NOT\n   * found in the local caches.\n   */\n  missing: string[];\n}\n\nexport interface ICachePerformance {\n  hits: number;\n  misses: number;\n  ignores: number;\n}\n\nexport interface IDiscreteServerResults<T extends Model, K = IDictionary>\n  extends IAbcResultsMeta<T> {\n  /**\n   * The primary keys being requested from the server\n   */\n  pks: string[];\n  /**\n   * The full set of primary keys that were requested from the ABC API (this is either equivalent\n   * to `fks` or a superset if local caching removed some entries)\n   */\n  allPks: string[];\n  /**\n   * Any keys which were NOT found on the server\n   */\n  missing: string[];\n  records: T[];\n}\n\nexport interface IAbcResultsMeta<T> {\n  /**\n   * The overall cache performance for the given `Model` to date\n   */\n\n  overallCachePerformance: ICachePerformance;\n  /**\n   * The **ABC** API command used when originating this request\n   */\n  apiCommand: AbcRequestCommand;\n  /**\n   * The combination of the `Model`'s ABC configuration merged\n   * with the options included in the API call\n   */\n  modelConfig: IAbcApiConfig<T>;\n}\n\nexport enum AbcMutation {\n  /**\n   * An update to a Vuex module's primary state that originated\n   * from cached information in IndexedDB. This would be the full\n   * array of records in the case of a _list_ and a hash replacement\n   * in the case of singular _record_ based module.\n   */\n  ABC_VUEX_UPDATE_FROM_IDX = \"ABC_VUEX_UPDATE_FROM_IDX\",\n  /**\n   * Attempt to get additional information from IndexedDB but currently\n   * Vuex has all of the records that IndexedDB has\n   */\n  ABC_INDEXED_SKIPPED = \"ABC_INDEXED_SKIPPED\",\n  /**\n   * Neither Vuex nor IndexedDB had any cached data on the records requested\n   */\n  ABC_NO_CACHE = \"ABC_NO_CACHE\",\n  /**\n   * The given Vuex module has been cleared from Vuex\n   */\n  ABC_MODULE_CLEARED = \"ABC_MODULE_CLEAR\",\n  /**\n   * The given `Model` has been cleared from IndexedDB\n   */\n  ABC_INDEXED_CLEARED = \"ABC_INDEXED_CLEARED\",\n  /**\n   * Vuex was updated from the server results\n   */\n  ABC_FIREBASE_TO_VUEX_UPDATE = \"ABC_FIREBASE_TO_VUEX_UPDATE\",\n  /**\n   * The IndexedDB was updated from Firebase\n   */\n  ABC_FIREBASE_REFRESH_INDEXED_DB = \"ABC_FIREBASE_REFRESH_INDEXED_DB\",\n  /**\n   * A Query was run against IndexedDB and it's results will be added/updated\n   * into the current Vuex state (until/if the server provides an updated set of\n   * records)\n   */\n  ABC_LOCAL_QUERY_TO_VUEX = \"ABC_LOCAL_QUERY_TO_VUEX\",\n  /**\n   * A Query was run against IndexedDB but no results were returned\n   */\n  ABC_LOCAL_QUERY_EMPTY = \"ABC_LOCAL_QUERY_EMPTY\",\n  /**\n   * An attempt to refresh the IndexedDB failed\n   */\n  ABC_INDEXED_DB_REFRESH_FAILED = \"ABC_INDEXED_DB_REFRESH_FAILED\",\n  /**\n   * when a query from IndexedDb returns id's which the server doesn't return\n   * then these records are assumed to be \"stale\" and are removed from IndexedDb\n   */\n  ABC_PRUNE_STALE_IDX_RECORDS = \"ABC_PRUNE_STALE_IDX_RECORDS\",\n  /**\n   * when a record is detected as no longer available (on the back of a server response), this\n   * mutation will remove the record from Vuex.\n   */\n  ABC_PRUNE_STALE_VUEX_RECORDS = \"ABC_PRUNE_STALE_VUEX_RECORDS\"\n}\n\nexport enum AbcDataSource {\n  vuex = \"vuex\",\n  indexedDb = \"indexedDb\",\n  firebase = \"firebase\"\n}\n\nexport enum QueryType {\n  all = \"all\",\n  where = \"where\",\n  since = \"since\"\n}\n\nexport type IAbcQueryDefinition<T> =\n  | IAbcAllQueryDefinition<T>\n  | IAbcWhereQueryDefinition<T>\n  | IAbcSinceQueryDefinition<T>;\n\nexport interface IAbcAllQueryDefinition<T> extends IAbcQueryBaseDefinition {\n  queryType: QueryType.all;\n}\n\nexport interface IAbcWhereQueryEquals<T extends Model>\n  extends IAbcQueryBaseDefinition {\n  // queryType: QueryType.where;\n  property: keyof T & string;\n  equals: any;\n  lessThan?: never;\n  greaterThan?: never;\n}\nexport interface IAbcWhereQueryGreaterThan<T extends Model>\n  extends IAbcQueryBaseDefinition {\n  // queryType: QueryType.where;\n  property: keyof T & string;\n  equals?: never;\n  lessThan?: never;\n  greaterThan: any;\n}\nexport interface IAbcWhereQueryLessThan<T extends Model>\n  extends IAbcQueryBaseDefinition {\n  // queryType: QueryType.where;\n  property: keyof T & string;\n  equals?: never;\n  lessThan: any;\n  greaterThan?: never;\n}\n\n/**\n * Allows definition of a _property_ on the model and an operation\n * to use for comparison/filtering purposes\n */\nexport type IAbcWhereQueryDefinition<T extends Model> =\n  | IAbcWhereQueryEquals<T>\n  | IAbcWhereQueryGreaterThan<T>\n  | IAbcWhereQueryLessThan<T>;\n\nexport interface IAbcSinceQueryDefinition<T> extends IAbcQueryBaseDefinition {\n  queryType: QueryType.since;\n  /**\n   * Look for records which have been modified since the given timestamp;\n   * if left _undefined_ the value will be\n   */\n  timestamp?: epochWithMilliseconds;\n}\n\nexport interface IAbcQueryBaseDefinition {\n  queryType?: string;\n  limit?: number;\n  offset?: number;\n}\n\n/**\n * A discrete request's result (`IDiscreteLocalResults`) which definitely has\n * a \"local\" response and optionally also includes a \"server\" response. Also\n * includes meta for Vuex.\n */\nexport interface IDiscreteResult<T, K = any> {\n  type: \"discrete\";\n  local: IDiscreteLocalResults<T, K>;\n  server?: IDiscreteServerResults<T, K>;\n  options: IDiscreteOptions<T>;\n}\n\n/**\n * A query result (`IQueryLocalResults`) which definitely has a \"local\" response\n * and optionally also includes a \"server\" response. Also includes meta for Vuex.\n */\nexport interface IQueryResult<T, K = any> {\n  type: \"query\";\n  queryDefn: IAbcQueryDefinition<T>;\n  local: IQueryLocalResults<T, K>;\n  server?: IQueryServerResults<T, K>;\n  options: IQueryOptions<T>;\n}\n\n/**\n * The results from either a Discrete or Query-based request.\n */\nexport type IAbcResult<T, K = any> = IDiscreteResult<T, K> | IQueryResult<T, K>;\n\nexport interface IQueryOptions<T> extends IUniversalOptions<T> {\n  /**\n   * If the `Model` being queries has a dynamic path then you will need to\n   * state the dynamic path segments so the the database path for Firebase\n   * can be determined (and so IndexedDB can use a more involved query)\n   */\n  offsets?: Partial<T>;\n}\n\nexport interface IDiscreteOptions<T> extends IUniversalOptions<T> {\n  /**\n   * If the `Model` involved has dynamic paths, you can state the dynamic properties\n   * as an option and then just state the `id` properties for the records you want.\n   *\n   * **Note:** you may also ignore this option but you must then state the full Composite Key\n   * involved in identifying the various Pks.\n   */\n  offsets?: Partial<T>;\n}\n\nexport interface IUniversalOptions<T> {\n  /**\n   * When set, this flag tells any local & server based response to merge\n   * the combined knowledge into the `AbcResult.records` array. By default\n   * this option is `false`.\n   */\n  mergeRecords?: boolean;\n}\n\n// export interface IAbcOptions<T> {\n//   watch?: IAbcPostWatcher<T>;\n//   watchNew?: boolean;\n//   /**\n//    * If you are using a Query Helper you can state that you\n//    * want to have ALL locally cached state in IndexedDB\n//    */\n//   allLocally?: boolean;\n// }\n\nexport type IAbcOptions<T> = IDiscreteOptions<T> | IQueryOptions<T>;\n\n/** the shape of the get/load endpoints for Discrete requests */\nexport interface IAbcDiscreteApi<T> {\n  get: (\n    props: IPrimaryKey<T>[],\n    options: IDiscreteOptions<T>\n  ) => Promise<AbcResult<T>>;\n  load: (\n    props: IPrimaryKey<T>[],\n    options: IDiscreteOptions<T>\n  ) => Promise<AbcResult<T>>;\n}\n\n/** the shape of the get/load endpoints for Query requests */\nexport interface IAbcQueryApi<T> {\n  get: (\n    defn: IAbcQueryDefinition<T>,\n    options: IQueryOptions<T>\n  ) => Promise<AbcResult<T>>;\n  load: (\n    props: IAbcQueryDefinition<T>,\n    options: IQueryOptions<T>\n  ) => Promise<AbcResult<T>>;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"62f416dd8fccdd8db204b7c01a781e939628f3af","contentHash":"e093ca3ee8beaf9ea77d965edb3652250a97183c829837480d48359d06777616"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/mutations/FmConfigMutation.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/mutations/FmConfigMutation.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}}},"fnMap":{},"branchMap":{},"s":{"0":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/mutations/FmConfigMutation.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/mutations/FmConfigMutation.ts"],"names":[],"mappings":"","sourcesContent":["export const enum FmConfigMutation {\n  queueHook = \"QUEUE_EVENT_HOOK\",\n  queueWatcher = \"QUEUE_WATCHER\",\n  /** the DB configuration */\n  configure = \"CONFIGURE\",\n  /** starting the DB connection process */\n  connecting = \"CONNECTING\",\n  /** the DB has been connected to */\n  connected = \"CONNECTED\",\n  /** the DB has been disconnected from */\n  disconnected = \"DISCONNECTED\",\n  /** there was a connection error while performing an operation */\n  connectionError = \"CONNECTION_ERROR\",\n  /** there was an application error */\n  appErr = \"APP_ERROR\",\n  /** clear the errors which were being stored locally */\n  clearErrors = \"CLEAR_ERRORS\",\n  /** the \"current user\" has changed, user identity details have been set */\n  setCurrentUser = \"SET_CURRENT_USER\",\n  /** a user has logged in */\n  userLoggedIn = \"USER_LOGGED_IN\",\n  /** a user who was previously an \"anonymous\" user was _upgraded_ to a **known** user */\n  userUpgraded = \"USER_UPGRADED\",\n  /** an anonymous user was abaandoned in favor of a logged in user */\n  userAbandoned = \"USER_ABANDONED\",\n  /** a user has logged out */\n  userLoggedOut = \"USER_LOGGED_OUT\",\n  /** a lifecycle event's hooks have all fired */\n  lifecycleEventCompleted = \"LIFECYCLE_EVENT_COMPLETED\",\n  /** all core plugin services have started */\n  coreServicesStarted = \"CORE_SERVICES_STARTED\",\n\n  // watchers\n\n  /** Firebase -- via Firemodel -- has been asked to watch a new path in DB */\n  watcherStarting = \"WATCHER_STARTING\",\n  /** Firebase -- via Firemodel -- has started watching a new path in the DB */\n  watcherStarted = \"WATCHER_STARTED\",\n  /** When attempting to start a watcher there was a failure (usually permission based) */\n  watcherFailed = \"WATCHER_FAILED\",\n  /** Firebase -- via Firemodel -- has stopped watching a new path in the DB */\n  watcherStopped = \"WATCHER_STOPPED\",\n  //** All Firebase watchers have been stopped */\n  watcherAllStopped = \"WATCHER_STOPPED_ALL\",\n  /**\n   * When a \"largePayload\" has been declared, all SERVER_ADD events from the given\n   * watcher are muted for a short period to ensure that Vuex is not bombarded with\n   * a mutation for every record.\n   */\n  watcherMuted = \"WATCHER_MUTED\",\n  /**\n   * Once the initial set of SERVER_ADD events, the watcher must be _un_muted to\n   * the SERVER_ADD mutations.\n   */\n  watcherUnmuted = \"WATCHER_UNMUTED\"\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"1306f6030302cf47be164fed85a01241aee3745b","contentHash":"1d5c5d80901921abecbf1ea8436e75cf3dcf95611a897692cb84b9e2bb564a45"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/mutations/FmCrudMutation.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/mutations/FmCrudMutation.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}}},"fnMap":{},"branchMap":{},"s":{"0":1},"f":{},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/mutations/FmCrudMutation.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/types/mutations/FmCrudMutation.ts"],"names":[],"mappings":"","sourcesContent":["export const enum FmCrudMutation {\n  // Client originated changes\n  changedLocally = \"CHANGED_LOCALLY\",\n  addedLocally = \"ADDED_LOCALLY\",\n  removedLocally = \"REMOVED_LOCALLY\",\n\n  relationshipAddedLocally = \"RELATIONSHIP_ADDED_LOCALLY\",\n  relationshipRemovedLocally = \"RELATIONSHIP_REMOVED_LOCALLY\",\n  relationshipSetLocally = \"RELATIONSHIP_SET_LOCALLY\",\n\n  relationshipAddConfirmation = \"RELATIONSHIP_ADDED_CONFIRMATION\",\n  relationshipRemovedConfirmation = \"RELATIONSHIP_REMOVED_CONFIRMATION\",\n  relationshipSetConfirmation = \"RELATIONSHIP_SET_CONFIRMATION\",\n\n  relationshipAddRollback = \"RELATIONSHIP_ADDED_ROLLBACK\",\n  relationshipRemovedRollback = \"RELATIONSHIP_REMOVED_ROLLBACK\",\n  relationshipSetRollback = \"RELATIONSHIP_SET_ROLLBACK\",\n\n  // Client originated changes CONFIRMED\n  serverAddConfirm = \"ADD_CONFIRMATION\",\n  serverChangeConfirm = \"CHANGE_CONFIRMATION\",\n  serverRemoveConfirm = \"REMOVE_CONFIRMATION\",\n  // ROLLBACKS\n  serverAddRollback = \"ROLLBACK_ADD\",\n  serverChangeRollback = \"ROLLBACK_CHANGE\",\n  serverRemoveRollback = \"ROLLBACK_REMOVE\",\n\n  // Server originated changes\n  serverAdd = \"SERVER_ADD\",\n  serverChange = \"SERVER_CHANGE\",\n  serverRemove = \"SERVER_REMOVE\",\n  /**\n   * when a watcher -- which was configured with `largePayload` -- starts,\n   * it first sends an array of values that exist on the server so that the\n   * server and client are in _sync_.\n   */\n  serverStateSync = \"SERVER_STATE_SYNC\",\n\n  /**\n   * Allows state modules to be \"reset\" which involves removing the data\n   * in the given module.\n   */\n  reset = \"RESET\"\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8d55132e6e36336a99ee21edb3c0253111b2da00","contentHash":"e657dc27d64c37ef83f7f254fc76e5bb7a11e1f47b98a420dd7ac34d9f60cf45"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/index.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":23},"end":{"line":3,"column":48}},"2":{"start":{"line":4,"column":23},"end":{"line":4,"column":48}},"3":{"start":{"line":5,"column":26},"end":{"line":5,"column":54}},"4":{"start":{"line":6,"column":25},"end":{"line":6,"column":52}},"5":{"start":{"line":7,"column":16},"end":{"line":7,"column":34}},"6":{"start":{"line":8,"column":14},"end":{"line":8,"column":30}},"7":{"start":{"line":9,"column":22},"end":{"line":9,"column":46}},"8":{"start":{"line":45,"column":14},"end":{"line":45,"column":384}},"9":{"start":{"line":46,"column":4},"end":{"line":46,"column":13}},"10":{"start":{"line":48,"column":0},"end":{"line":48,"column":48}}},"fnMap":{"0":{"name":"firemodelMutations","decl":{"start":{"line":32,"column":9},"end":{"line":32,"column":27}},"loc":{"start":{"line":44,"column":12},"end":{"line":47,"column":1}},"line":44}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":3,"9":3,"10":1},"f":{"0":3},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/index.ts"],"names":[],"mappings":";;AAEA,iDAA8C;AAC9C,iDAA8C;AAC9C,uDAAoD;AACpD,qDAAkD;AAClD,mCAAgC;AAChC,+BAA4B;AAE5B,+CAA4C;AAO5C;;;;;;;;;;;;;;;;;;;;;GAqBG;AACH,SAAgB,kBAAkB;AAChC;;;;;;;;;;GAUG;AACH,UAA6B;IAE7B,MAAM,CAAC,yGACF,2BAAY,CAAI,UAAU,CAAC,GAC3B,SAAG,CAAI,UAAU,CAAC,GAClB,2BAAY,CAAI,UAAU,CAAC,GAC3B,iCAAe,CAAI,UAAU,CAAC,GAC9B,+BAAc,CAAI,UAAU,CAAC,GAC7B,yBAAW,CAAI,UAAU,CAAC,GAC1B,aAAK,CAAI,UAAU,CAAC,CACxB,CAAC;IAEF,OAAO,CAAC,CAAC;AACX,CAAC;AAzBD,gDAyBC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { Model } from \"firemodel\";\nimport { addedLocally } from \"./addedLocally\";\nimport { serverEvents } from \"./serverEvents\";\nimport { serverRollbacks } from \"./serverRollbacks\";\nimport { serverConfirms } from \"./serverConfirms\";\nimport { reset } from \"./reset\";\nimport { abc } from \"./abc\";\nimport { IDictionary } from \"firemock\";\nimport { watchEvents } from \"./watchEvents\";\n\nexport type ListPropertyCandidates<T> = Pick<\n  T,\n  { [K in keyof T]: T[K] extends Model[] ? K : never }[keyof T]\n>;\n\n/**\n * **firebaseMutations**\n *\n * A prepacked set of mutations which will handle all the mutations\n * which the **Firemodel Vuex Plugin** will send relating to CRUD based\n * changes to the underlying Firebase database.\n *\n * These mutations can/should be brought into parts of the state tree which\n * are managed by a Firemodel `Model` (and are being \"watched\" by your frontend).\n * This export is able to manage the mutations for both `record` and `list` based\n * watchers.\n * \n * An example of how to incorporate into your state tree:\n```typescript\nconst vuexModule: Module<IMyStateModule, IRootState> = {\n    state,\n    ...firemodelMutations(),\n    getters,\n    namespaced: true\n}\n```\n */\nexport function firemodelMutations<T extends IDictionary>(\n  /**\n   * If you are using a **list** based watcher you will almost always want\n   * the list of records to be \"offset\" from the root of the local state\n   * module. If not stated, this property will be offset to `all` but you can\n   * explicitly set it to whatever you like including an empty string which will\n   * in effect put the list onto the root of the local state module.\n   *\n   * In the case of a **record** based watcher you should typically leave this property\n   * `undefined` but if you have an edge case then you can set it to whatever you like\n   * and it will honored.\n   */\n  propOffset?: keyof T & string\n): MutationTree<T> {\n  const a: MutationTree<T> = {\n    ...addedLocally<T>(propOffset),\n    ...abc<T>(propOffset),\n    ...serverEvents<T>(propOffset),\n    ...serverRollbacks<T>(propOffset),\n    ...serverConfirms<T>(propOffset),\n    ...watchEvents<T>(propOffset),\n    ...reset<T>(propOffset)\n  };\n\n  return a;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6b12efacf95492f9174afbce47c90a3b1ed81d34","contentHash":"5ba93d57f7b299a156f23511fc67a1582b6a082cf04c96eac934d3b21021d7b2"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/addedLocally.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/addedLocally.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":52}},"2":{"start":{"line":4,"column":21},"end":{"line":4,"column":52}},"3":{"start":{"line":5,"column":19},"end":{"line":5,"column":48}},"4":{"start":{"line":7,"column":19},"end":{"line":7,"column":51}},"5":{"start":{"line":8,"column":4},"end":{"line":33,"column":6}},"6":{"start":{"line":10,"column":12},"end":{"line":15,"column":13}},"7":{"start":{"line":11,"column":16},"end":{"line":11,"column":81}},"8":{"start":{"line":14,"column":16},"end":{"line":14,"column":70}},"9":{"start":{"line":18,"column":12},"end":{"line":23,"column":13}},"10":{"start":{"line":19,"column":16},"end":{"line":19,"column":81}},"11":{"start":{"line":22,"column":16},"end":{"line":22,"column":70}},"12":{"start":{"line":26,"column":12},"end":{"line":31,"column":13}},"13":{"start":{"line":27,"column":16},"end":{"line":27,"column":72}},"14":{"start":{"line":30,"column":16},"end":{"line":30,"column":61}},"15":{"start":{"line":35,"column":0},"end":{"line":35,"column":36}}},"fnMap":{"0":{"name":"addedLocally","decl":{"start":{"line":6,"column":9},"end":{"line":6,"column":21}},"loc":{"start":{"line":6,"column":34},"end":{"line":34,"column":1}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":8},"end":{"line":9,"column":9}},"loc":{"start":{"line":9,"column":61},"end":{"line":16,"column":9}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":17,"column":8},"end":{"line":17,"column":9}},"loc":{"start":{"line":17,"column":65},"end":{"line":24,"column":9}},"line":17},"3":{"name":"(anonymous_3)","decl":{"start":{"line":25,"column":8},"end":{"line":25,"column":9}},"loc":{"start":{"line":25,"column":65},"end":{"line":32,"column":9}},"line":25}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":19},"end":{"line":7,"column":51}},"type":"cond-expr","locations":[{"start":{"line":7,"column":33},"end":{"line":7,"column":38}},{"start":{"line":7,"column":41},"end":{"line":7,"column":51}}],"line":7},"1":{"loc":{"start":{"line":10,"column":12},"end":{"line":15,"column":13}},"type":"if","locations":[{"start":{"line":10,"column":12},"end":{"line":15,"column":13}},{"start":{"line":10,"column":12},"end":{"line":15,"column":13}}],"line":10},"2":{"loc":{"start":{"line":18,"column":12},"end":{"line":23,"column":13}},"type":"if","locations":[{"start":{"line":18,"column":12},"end":{"line":23,"column":13}},{"start":{"line":18,"column":12},"end":{"line":23,"column":13}}],"line":18},"3":{"loc":{"start":{"line":26,"column":12},"end":{"line":31,"column":13}},"type":"if","locations":[{"start":{"line":26,"column":12},"end":{"line":31,"column":13}},{"start":{"line":26,"column":12},"end":{"line":31,"column":13}}],"line":26}},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":3,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1},"f":{"0":3,"1":0,"2":0,"3":0},"b":{"0":[2,1],"1":[0,0],"2":[0,0],"3":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/addedLocally.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/addedLocally.ts"],"names":[],"mappings":";;AAEA,qDAAkD;AAClD,qDAAkD;AAGlD,iDAA8C;AAE9C,SAAgB,YAAY,CAC1B,UAA6B;IAE7B,MAAM,MAAM,GAAG,CAAC,UAAU,CAAC,CAAC,CAAE,KAA0B,CAAC,CAAC,CAAC,UAAU,CAAC;IAEtE,OAAO;QACL,oCAA6B,CAC3B,KAA2B,EAC3B,OAAyB;YAEzB,IAAI,mBAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE;gBAC5B,uBAAU,CAAI,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;aACxD;iBAAM;gBACL,uBAAU,CAAI,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;aAC7C;QACH,CAAC;QAED,wCAA+B,CAAC,KAAK,EAAE,OAAyB;YAC9D,IAAI,mBAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE;gBAC5B,uBAAU,CAAI,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;aACxD;iBAAM;gBACL,uBAAU,CAAI,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;aAC7C;QACH,CAAC;QAED,wCAA+B,CAAC,KAAQ,EAAE,OAAyB;YACjE,IAAI,mBAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE;gBAC5B,uBAAU,CAAI,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;aAC/C;iBAAM;gBACL,uBAAU,CAAI,KAAK,EAAE,MAAM,EAAE,IAAI,CAAC,CAAC;aACpC;QACH,CAAC;KACF,CAAC;AACJ,CAAC;AAjCD,oCAiCC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { FmCrudMutation } from \"../types/mutations/FmCrudMutation\";\nimport { changeRoot } from \"../shared/changeRoot\";\nimport { updateList } from \"../shared/updateList\";\nimport { IFmWatchEvent } from \"firemodel\";\nimport { IDictionary } from \"firemock\";\nimport { isRecord } from \"../shared/isRecord\";\n\nexport function addedLocally<T>(\n  propOffset?: keyof T & string\n): MutationTree<T> {\n  const offset = !propOffset ? (\"all\" as keyof T & string) : propOffset;\n\n  return {\n    [FmCrudMutation.addedLocally](\n      state: T | IDictionary<T[]>,\n      payload: IFmWatchEvent<T>\n    ) {\n      if (isRecord(state, payload)) {\n        changeRoot<T>(state, payload.value, payload.localPath);\n      } else {\n        updateList<T>(state, offset, payload.value);\n      }\n    },\n\n    [FmCrudMutation.changedLocally](state, payload: IFmWatchEvent<T>) {\n      if (isRecord(state, payload)) {\n        changeRoot<T>(state, payload.value, payload.localPath);\n      } else {\n        updateList<T>(state, offset, payload.value);\n      }\n    },\n\n    [FmCrudMutation.removedLocally](state: T, payload: IFmWatchEvent<T>) {\n      if (isRecord(state, payload)) {\n        changeRoot<T>(state, null, payload.localPath);\n      } else {\n        updateList<T>(state, offset, null);\n      }\n    }\n  };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"5c4e5fe642f2b097742bdcb7b8a9260f03f0cf02","contentHash":"0ca38b28477ac778dc32b1be9c4170ebd30b74d68706f66650937d3e08ef3742"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/changeRoot.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/changeRoot.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":14},"end":{"line":6,"column":45}},"4":{"start":{"line":7,"column":12},"end":{"line":7,"column":25}},"5":{"start":{"line":8,"column":31},"end":{"line":8,"column":72}},"6":{"start":{"line":19,"column":0},"end":{"line":33,"column":2}},"7":{"start":{"line":21,"column":23},"end":{"line":21,"column":116}},"8":{"start":{"line":22,"column":4},"end":{"line":24,"column":5}},"9":{"start":{"line":23,"column":8},"end":{"line":23,"column":266}},"10":{"start":{"line":25,"column":4},"end":{"line":31,"column":7}},"11":{"start":{"line":26,"column":25},"end":{"line":26,"column":65}},"12":{"start":{"line":27,"column":25},"end":{"line":27,"column":36}},"13":{"start":{"line":28,"column":29},"end":{"line":28,"column":63}},"14":{"start":{"line":29,"column":8},"end":{"line":29,"column":84}},"15":{"start":{"line":32,"column":4},"end":{"line":32,"column":17}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"(anonymous_1)","decl":{"start":{"line":19,"column":21},"end":{"line":19,"column":22}},"loc":{"start":{"line":19,"column":58},"end":{"line":33,"column":1}},"line":19},"2":{"name":"(anonymous_2)","decl":{"start":{"line":25,"column":23},"end":{"line":25,"column":24}},"loc":{"start":{"line":25,"column":31},"end":{"line":31,"column":5}},"line":25}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":21,"column":68},"end":{"line":21,"column":113}},"type":"cond-expr","locations":[{"start":{"line":21,"column":83},"end":{"line":21,"column":108}},{"start":{"line":21,"column":111},"end":{"line":21,"column":113}}],"line":21},"4":{"loc":{"start":{"line":22,"column":4},"end":{"line":24,"column":5}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":24,"column":5}},{"start":{"line":22,"column":4},"end":{"line":24,"column":5}}],"line":22},"5":{"loc":{"start":{"line":26,"column":25},"end":{"line":26,"column":65}},"type":"cond-expr","locations":[{"start":{"line":26,"column":40},"end":{"line":26,"column":58}},{"start":{"line":26,"column":61},"end":{"line":26,"column":65}}],"line":26},"6":{"loc":{"start":{"line":29,"column":39},"end":{"line":29,"column":82}},"type":"cond-expr","locations":[{"start":{"line":29,"column":59},"end":{"line":29,"column":71}},{"start":{"line":29,"column":74},"end":{"line":29,"column":82}}],"line":29}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0},"f":{"0":1,"1":0,"2":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/changeRoot.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/changeRoot.ts"],"names":[],"mappings":";;;;;AACA,8CAAsB;AAEtB,0BAAkC;AAClC,yEAAsE;AAEtE;;;;;;;;;GASG;AACU,QAAA,UAAU,GAAG,CACxB,KAAQ,EACR,YAAsB,EACtB,UAAkB,EAClB,EAAE;IACF,kEAAkE;IAClE,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAC3B,IAAI,GAAG,CACL,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,MAAM,CAAC,YAAY,CAAC,CAAC,CAAC,MAAM,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC,CAAC,CAAC,EAAE,CAAC,CACzE,CACF,CAAC;IAEF,IAAI,gBAAY,CAAC,UAAU,CAAC,KAAK,SAAS,EAAE;QAC1C,MAAM,IAAI,2CAAoB,CAC5B,mDAAmD,UAAU,6IAA6I,CAC3M,CAAC;KACH;IAED,UAAU,CAAC,OAAO,CAAC,IAAI,CAAC,EAAE;QACxB,MAAM,QAAQ,GAAG,YAAY,CAAC,CAAC,CAAC,YAAY,CAAC,IAAe,CAAC,CAAC,CAAC,CAAC,IAAI,CAAC;QACrE,MAAM,QAAQ,GAAG,KAAK,CAAC,IAAe,CAAC,CAAC;QACxC,MAAM,YAAY,GAAG,gBAAY,CAAC,UAAU,CAAC,CAAC,IAAI,CAAC,CAAC;QAEpD,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,IAAI,EAAE,QAAQ,KAAK,IAAI,CAAC,CAAC,CAAC,YAAY,CAAC,CAAC,CAAC,QAAQ,CAAC,CAAC;QAClE,wEAAwE;IAC1E,CAAC,CAAC,CAAC;IAEH,OAAO,KAAK,CAAC;AACf,CAAC,CAAC","sourcesContent":["import { IDictionary } from \"common-types\";\nimport Vue from \"vue\";\nimport { Model } from \"firemodel\";\nimport { initialState } from \"..\";\nimport { FireModelPluginError } from \"../errors/FiremodelPluginError\";\n\n/**\n * **changeRoot**\n *\n * Allows a mutation to reset the root object of a module's\n * state tree while avoiding the classic object \"de-referencing\"\n * which can result in the state tree not being updated.\n *\n * @param state\n * @param updatedProps\n */\nexport const changeRoot = <T extends Model = Model>(\n  state: T,\n  updatedProps: T | null,\n  moduleName: string\n) => {\n  /** the full set of props defined by both current and new state */\n  const properties = Array.from(\n    new Set(\n      Object.keys(state).concat(updatedProps ? Object.keys(updatedProps) : [])\n    )\n  );\n\n  if (initialState[moduleName] === undefined) {\n    throw new FireModelPluginError(\n      `Attempt to change the state of the Vuex module \"${moduleName}\" failed because there was no initial state defined for that module. Please check that the spelling is correct as this is typically a typo.`\n    );\n  }\n\n  properties.forEach(prop => {\n    const newState = updatedProps ? updatedProps[prop as keyof T] : null;\n    const oldState = state[prop as keyof T];\n    const defaultState = initialState[moduleName][prop];\n\n    Vue.set(state, prop, newState === null ? defaultState : newState);\n    // state[prop as keyof T] = newState === null ? defaultState : newState;\n  });\n\n  return state;\n};\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"3e9863bc871b5a962148e93a576f1b336135fbc6","contentHash":"e818cdf861ad52d5e8d7a5ac3f0a48cafe4c40e74a0ffe1db9d069d547a99316"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/updateList.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/updateList.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":14},"end":{"line":6,"column":45}},"4":{"start":{"line":7,"column":31},"end":{"line":7,"column":72}},"5":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"6":{"start":{"line":25,"column":8},"end":{"line":25,"column":163}},"7":{"start":{"line":27,"column":19},"end":{"line":27,"column":44}},"8":{"start":{"line":28,"column":16},"end":{"line":28,"column":21}},"9":{"start":{"line":29,"column":18},"end":{"line":34,"column":6}},"10":{"start":{"line":30,"column":8},"end":{"line":32,"column":9}},"11":{"start":{"line":31,"column":12},"end":{"line":31,"column":25}},"12":{"start":{"line":33,"column":8},"end":{"line":33,"column":54}},"13":{"start":{"line":35,"column":4},"end":{"line":35,"column":85}},"14":{"start":{"line":42,"column":0},"end":{"line":42,"column":32}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"updateList","decl":{"start":{"line":21,"column":9},"end":{"line":21,"column":19}},"loc":{"start":{"line":23,"column":7},"end":{"line":41,"column":1}},"line":23},"2":{"name":"(anonymous_2)","decl":{"start":{"line":29,"column":31},"end":{"line":29,"column":32}},"loc":{"start":{"line":29,"column":36},"end":{"line":34,"column":5}},"line":29}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},"type":"if","locations":[{"start":{"line":24,"column":4},"end":{"line":26,"column":5}},{"start":{"line":24,"column":4},"end":{"line":26,"column":5}}],"line":24},"4":{"loc":{"start":{"line":27,"column":19},"end":{"line":27,"column":44}},"type":"binary-expr","locations":[{"start":{"line":27,"column":19},"end":{"line":27,"column":38}},{"start":{"line":27,"column":42},"end":{"line":27,"column":44}}],"line":27},"5":{"loc":{"start":{"line":30,"column":8},"end":{"line":32,"column":9}},"type":"if","locations":[{"start":{"line":30,"column":8},"end":{"line":32,"column":9}},{"start":{"line":30,"column":8},"end":{"line":32,"column":9}}],"line":30},"6":{"loc":{"start":{"line":30,"column":12},"end":{"line":30,"column":38}},"type":"binary-expr","locations":[{"start":{"line":30,"column":12},"end":{"line":30,"column":17}},{"start":{"line":30,"column":21},"end":{"line":30,"column":38}}],"line":30},"7":{"loc":{"start":{"line":33,"column":15},"end":{"line":33,"column":53}},"type":"cond-expr","locations":[{"start":{"line":33,"column":44},"end":{"line":33,"column":49}},{"start":{"line":33,"column":52},"end":{"line":33,"column":53}}],"line":33},"8":{"loc":{"start":{"line":33,"column":15},"end":{"line":33,"column":41}},"type":"binary-expr","locations":[{"start":{"line":33,"column":15},"end":{"line":33,"column":20}},{"start":{"line":33,"column":24},"end":{"line":33,"column":41}}],"line":33},"9":{"loc":{"start":{"line":35,"column":43},"end":{"line":35,"column":83}},"type":"cond-expr","locations":[{"start":{"line":35,"column":51},"end":{"line":35,"column":58}},{"start":{"line":35,"column":61},"end":{"line":35,"column":83}}],"line":35}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1},"f":{"0":1,"1":0,"2":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/updateList.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/updateList.ts"],"names":[],"mappings":";;;;;AACA,8CAAsB;AACtB,yEAAsE;AAOtE;;;;;;;;;;;;GAYG;AACH,SAAgB,UAAU,CAIxB,WAAc,EACd,MAAwB;AACxB,4DAA4D;AAC5D,KAAe;IAEf,IAAI,CAAC,MAAM,EAAE;QACX,MAAM,IAAI,2CAAoB,CAC5B,oFAAoF,EACpF,aAAa,CACd,CAAC;KACH;IAED,IAAI,QAAQ,GAAU,WAAW,CAAC,MAAM,CAAqB,IAAI,EAAE,CAAC;IAEpE,IAAI,KAAK,GAAG,KAAK,CAAC;IAClB,IAAI,OAAO,GAAQ,QAAQ,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE;QAClC,IAAI,KAAK,IAAI,CAAC,CAAC,EAAE,KAAK,KAAK,CAAC,EAAE,EAAE;YAC9B,KAAK,GAAG,IAAI,CAAC;SACd;QACD,OAAO,KAAK,IAAI,CAAC,CAAC,EAAE,KAAK,KAAK,CAAC,EAAE,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;IAChD,CAAC,CAAC,CAAC;IAEH,aAAG,CAAC,GAAG,CACL,WAAkB,EAClB,MAAM,EACN,KAAK,CAAC,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,QAAQ,CAAC,MAAM,CAAC,KAAU,CAAC,CAC9C,CAAC;IAEF,0BAA0B;IAC1B,iBAAiB;IACjB,YAAY;IACZ,kEAAkE;IAClE,KAAK;AACP,CAAC;AArCD,gCAqCC","sourcesContent":["import { IDictionary } from \"common-types\";\nimport Vue from \"vue\";\nimport { FireModelPluginError } from \"../errors/FiremodelPluginError\";\nimport { Model } from \"firemodel\";\n\ninterface IDictionaryWithId extends IDictionary {\n  id: string;\n}\n\n/**\n * **updateList**\n *\n * Updates a module's state tree for a property which is based on a \"list watcher\";\n * the actual _list_ data will be based off the root of module state if no `moduleState`\n * is passed in; in other cases it will use the `moduleState` as an offset to arrive\n * at the root of the array.\n *\n * @param moduleState the module state tree\n * @param offset the offset from the root where the data is stored;\n * by default it is \"all\" but can be anything including _undefined_ (aka, no offset)\n * @param value the value of the record which has changed\n */\nexport function updateList<\n  T extends Model,\n  M extends IDictionary = IDictionary<T[]>\n>(\n  moduleState: M,\n  offset: keyof M & string,\n  /** the new record value OR \"null\" if removing the record */\n  value: T | null\n): void {\n  if (!offset) {\n    throw new FireModelPluginError(\n      '\"updateList\" was passed a falsy value for an offset; this is not currently allowed',\n      \"not-allowed\"\n    );\n  }\n\n  let existing: T[] = ((moduleState[offset] as unknown) as T[]) || [];\n\n  let found = false;\n  let updated: T[] = existing.map(i => {\n    if (value && i.id === value.id) {\n      found = true;\n    }\n    return value && i.id === value.id ? value : i;\n  });\n\n  Vue.set(\n    moduleState as any,\n    offset,\n    found ? updated : existing.concat(value as T)\n  );\n\n  // set<IDictionaryWithId>(\n  //   moduleState,\n  //   offset,\n  //   found ? updated : existing.concat(value as IDictionaryWithId)\n  // );\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c3a740fac7abbf6471ef95b2f794c7e5ee83d2a0","contentHash":"06c7cc194af5943132b8fb80c80295aae573eeaf3dc010c6e428ae6e66ba66b3"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/isRecord.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/isRecord.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":9,"column":4},"end":{"line":9,"column":46}},"2":{"start":{"line":11,"column":0},"end":{"line":11,"column":28}}},"fnMap":{"0":{"name":"isRecord","decl":{"start":{"line":8,"column":9},"end":{"line":8,"column":17}},"loc":{"start":{"line":8,"column":34},"end":{"line":10,"column":1}},"line":8}},"branchMap":{},"s":{"0":1,"1":0,"2":1},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/isRecord.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/isRecord.ts"],"names":[],"mappings":";;AAGA;;;;GAIG;AACH,SAAgB,QAAQ,CACtB,KAA2B,EAC3B,OAA2B;IAE3B,OAAO,OAAO,CAAC,aAAa,KAAK,QAAQ,CAAC;AAC5C,CAAC;AALD,4BAKC","sourcesContent":["import { IDictionary } from \"common-types\";\nimport { IFmWatchEvent } from \"firemodel\";\n\n/**\n * Detects whether the change is a `Record` or a `List` and ensures\n * that the **state** parameter is typed correctly as well as passing\n * back a boolean flag at runtime.\n */\nexport function isRecord<T>(\n  state: T | IDictionary<T[]>,\n  payload: IFmWatchEvent<any>\n): state is T {\n  return payload.watcherSource === \"record\";\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"56895c17805936d1dd911e3b4e1d335556078d3d","contentHash":"db8e76517699f9c9b5e9c570a52df919ea9536079d4195dbe70965b2493eefd9"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverEvents.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverEvents.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":52}},"2":{"start":{"line":4,"column":21},"end":{"line":4,"column":52}},"3":{"start":{"line":5,"column":19},"end":{"line":5,"column":48}},"4":{"start":{"line":7,"column":19},"end":{"line":7,"column":51}},"5":{"start":{"line":8,"column":4},"end":{"line":55,"column":6}},"6":{"start":{"line":15,"column":12},"end":{"line":20,"column":13}},"7":{"start":{"line":16,"column":16},"end":{"line":16,"column":81}},"8":{"start":{"line":19,"column":16},"end":{"line":19,"column":70}},"9":{"start":{"line":28,"column":12},"end":{"line":34,"column":13}},"10":{"start":{"line":33,"column":16},"end":{"line":33,"column":23}},"11":{"start":{"line":35,"column":12},"end":{"line":40,"column":13}},"12":{"start":{"line":36,"column":16},"end":{"line":36,"column":81}},"13":{"start":{"line":39,"column":16},"end":{"line":39,"column":70}},"14":{"start":{"line":48,"column":12},"end":{"line":53,"column":13}},"15":{"start":{"line":49,"column":16},"end":{"line":49,"column":72}},"16":{"start":{"line":52,"column":16},"end":{"line":52,"column":70}},"17":{"start":{"line":57,"column":0},"end":{"line":57,"column":36}}},"fnMap":{"0":{"name":"serverEvents","decl":{"start":{"line":6,"column":9},"end":{"line":6,"column":21}},"loc":{"start":{"line":6,"column":34},"end":{"line":56,"column":1}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":8},"end":{"line":9,"column":9}},"loc":{"start":{"line":14,"column":24},"end":{"line":21,"column":9}},"line":14},"2":{"name":"(anonymous_2)","decl":{"start":{"line":22,"column":8},"end":{"line":22,"column":9}},"loc":{"start":{"line":27,"column":24},"end":{"line":41,"column":9}},"line":27},"3":{"name":"(anonymous_3)","decl":{"start":{"line":42,"column":8},"end":{"line":42,"column":9}},"loc":{"start":{"line":47,"column":24},"end":{"line":54,"column":9}},"line":47}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":19},"end":{"line":7,"column":51}},"type":"cond-expr","locations":[{"start":{"line":7,"column":33},"end":{"line":7,"column":38}},{"start":{"line":7,"column":41},"end":{"line":7,"column":51}}],"line":7},"1":{"loc":{"start":{"line":15,"column":12},"end":{"line":20,"column":13}},"type":"if","locations":[{"start":{"line":15,"column":12},"end":{"line":20,"column":13}},{"start":{"line":15,"column":12},"end":{"line":20,"column":13}}],"line":15},"2":{"loc":{"start":{"line":28,"column":12},"end":{"line":34,"column":13}},"type":"if","locations":[{"start":{"line":28,"column":12},"end":{"line":34,"column":13}},{"start":{"line":28,"column":12},"end":{"line":34,"column":13}}],"line":28},"3":{"loc":{"start":{"line":35,"column":12},"end":{"line":40,"column":13}},"type":"if","locations":[{"start":{"line":35,"column":12},"end":{"line":40,"column":13}},{"start":{"line":35,"column":12},"end":{"line":40,"column":13}}],"line":35},"4":{"loc":{"start":{"line":48,"column":12},"end":{"line":53,"column":13}},"type":"if","locations":[{"start":{"line":48,"column":12},"end":{"line":53,"column":13}},{"start":{"line":48,"column":12},"end":{"line":53,"column":13}}],"line":48}},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":3,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":1},"f":{"0":3,"1":0,"2":0,"3":0},"b":{"0":[2,1],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverEvents.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverEvents.ts"],"names":[],"mappings":";;AAGA,qDAAkD;AAClD,qDAAkD;AAClD,iDAA8C;AAE9C,SAAgB,YAAY,CAC1B,UAA6B;IAE7B,MAAM,MAAM,GAAG,CAAC,UAAU,CAAC,CAAC,CAAE,KAA0B,CAAC,CAAC,CAAC,UAAU,CAAC;IACtE,OAAO;QACL,8BAA0B;QACxB;;;WAGG;QACH,KAAQ,EACR,OAAyB;YAEzB,IAAI,mBAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE;gBAC5B,uBAAU,CAAI,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;aACxD;iBAAM;gBACL,uBAAU,CAAI,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;aAC7C;QACH,CAAC;QAED,oCAA6B;QAC3B;;;WAGG;QACH,KAAQ,EACR,OAA6B;YAE7B,IAAI,OAAO,CAAC,KAAK,KAAK,IAAI,EAAE;gBAC1B,gEAAgE;gBAChE,6DAA6D;gBAC7D,8DAA8D;gBAC9D,UAAU;gBACV,OAAO;aACR;YACD,IAAI,mBAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE;gBAC5B,uBAAU,CAAI,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;aACxD;iBAAM;gBACL,uBAAU,CAAI,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;aAC7C;QACH,CAAC;QAED,oCAA6B;QAC3B;;;WAGG;QACH,KAAQ,EACR,OAA6B;YAE7B,IAAI,mBAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE;gBAC5B,uBAAU,CAAC,KAAK,EAAE,IAAI,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;aAC5C;iBAAM;gBACL,uBAAU,CAAI,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;aAC7C;QACH,CAAC;KACF,CAAC;AACJ,CAAC;AAzDD,oCAyDC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { FmCrudMutation } from \"../types/mutations/FmCrudMutation\";\nimport { Model, IFmWatchEvent } from \"firemodel\";\nimport { changeRoot } from \"../shared/changeRoot\";\nimport { updateList } from \"../shared/updateList\";\nimport { isRecord } from \"../shared/isRecord\";\n\nexport function serverEvents<T>(\n  propOffset?: keyof T & string\n): MutationTree<T> {\n  const offset = !propOffset ? (\"all\" as keyof T & string) : propOffset;\n  return {\n    [FmCrudMutation.serverAdd](\n      /**\n       * either a dictionary which includes the \"offsetProp\" or the array\n       * of records at the root of the state structure\n       */\n      state: T,\n      payload: IFmWatchEvent<T>\n    ) {\n      if (isRecord(state, payload)) {\n        changeRoot<T>(state, payload.value, payload.localPath);\n      } else {\n        updateList<T>(state, offset, payload.value);\n      }\n    },\n\n    [FmCrudMutation.serverChange](\n      /**\n       * Either a dictionary which includes the \"offsetProp\" or the array\n       * of records at the root of the state structure\n       */\n      state: T,\n      payload: IFmWatchEvent<Model>\n    ) {\n      if (payload.value === null) {\n        // a \"remove\" event will also be picked up by the \"change\" event\n        // passed by Firebase. This mutation will be ignored with the\n        // assumption that the \"remove\" mutation will handle the state\n        // change.\n        return;\n      }\n      if (isRecord(state, payload)) {\n        changeRoot<T>(state, payload.value, payload.localPath);\n      } else {\n        updateList<T>(state, offset, payload.value);\n      }\n    },\n\n    [FmCrudMutation.serverRemove](\n      /**\n       * either a dictionary which includes the \"offsetProp\" or the array\n       * of records at the root of the state structure\n       */\n      state: T,\n      payload: IFmWatchEvent<Model>\n    ) {\n      if (isRecord(state, payload)) {\n        changeRoot(state, null, payload.localPath);\n      } else {\n        updateList<T>(state, offset, payload.value);\n      }\n    }\n  };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"abac1951187493c9aadf72f7916dfba4033f6be9","contentHash":"427c752483929e59fec59603adf5bc41dc6160062463ee4e3e9c3c5d970fa6c7"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverRollbacks.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverRollbacks.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":52}},"2":{"start":{"line":4,"column":21},"end":{"line":4,"column":52}},"3":{"start":{"line":5,"column":19},"end":{"line":5,"column":48}},"4":{"start":{"line":19,"column":19},"end":{"line":21,"column":20}},"5":{"start":{"line":22,"column":4},"end":{"line":47,"column":6}},"6":{"start":{"line":24,"column":12},"end":{"line":29,"column":13}},"7":{"start":{"line":25,"column":16},"end":{"line":25,"column":81}},"8":{"start":{"line":28,"column":16},"end":{"line":28,"column":70}},"9":{"start":{"line":32,"column":12},"end":{"line":37,"column":13}},"10":{"start":{"line":33,"column":16},"end":{"line":33,"column":81}},"11":{"start":{"line":36,"column":16},"end":{"line":36,"column":70}},"12":{"start":{"line":40,"column":12},"end":{"line":45,"column":13}},"13":{"start":{"line":41,"column":16},"end":{"line":41,"column":81}},"14":{"start":{"line":44,"column":16},"end":{"line":44,"column":70}},"15":{"start":{"line":49,"column":0},"end":{"line":49,"column":42}}},"fnMap":{"0":{"name":"serverRollbacks","decl":{"start":{"line":17,"column":9},"end":{"line":17,"column":24}},"loc":{"start":{"line":17,"column":37},"end":{"line":48,"column":1}},"line":17},"1":{"name":"(anonymous_1)","decl":{"start":{"line":23,"column":8},"end":{"line":23,"column":9}},"loc":{"start":{"line":23,"column":65},"end":{"line":30,"column":9}},"line":23},"2":{"name":"(anonymous_2)","decl":{"start":{"line":31,"column":8},"end":{"line":31,"column":9}},"loc":{"start":{"line":31,"column":71},"end":{"line":38,"column":9}},"line":31},"3":{"name":"(anonymous_3)","decl":{"start":{"line":39,"column":8},"end":{"line":39,"column":9}},"loc":{"start":{"line":39,"column":71},"end":{"line":46,"column":9}},"line":39}},"branchMap":{"0":{"loc":{"start":{"line":19,"column":19},"end":{"line":21,"column":20}},"type":"cond-expr","locations":[{"start":{"line":20,"column":10},"end":{"line":20,"column":15}},{"start":{"line":21,"column":10},"end":{"line":21,"column":20}}],"line":19},"1":{"loc":{"start":{"line":24,"column":12},"end":{"line":29,"column":13}},"type":"if","locations":[{"start":{"line":24,"column":12},"end":{"line":29,"column":13}},{"start":{"line":24,"column":12},"end":{"line":29,"column":13}}],"line":24},"2":{"loc":{"start":{"line":32,"column":12},"end":{"line":37,"column":13}},"type":"if","locations":[{"start":{"line":32,"column":12},"end":{"line":37,"column":13}},{"start":{"line":32,"column":12},"end":{"line":37,"column":13}}],"line":32},"3":{"loc":{"start":{"line":40,"column":12},"end":{"line":45,"column":13}},"type":"if","locations":[{"start":{"line":40,"column":12},"end":{"line":45,"column":13}},{"start":{"line":40,"column":12},"end":{"line":45,"column":13}}],"line":40}},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":3,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1},"f":{"0":3,"1":0,"2":0,"3":0},"b":{"0":[2,1],"1":[0,0],"2":[0,0],"3":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverRollbacks.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverRollbacks.ts"],"names":[],"mappings":";;AAKA,qDAAkD;AAClD,qDAAkD;AAClD,iDAA8C;AAE9C;;;;;;;;;;GAUG;AACH,SAAgB,eAAe,CAC7B,UAA6B;IAE7B,mBAAmB;IACnB,MAAM,MAAM,GAAqB,CAAC,UAAU;QAC1C,CAAC,CAAE,KAA0B;QAC7B,CAAC,CAAC,UAAU,CAAC;IAEf,OAAO;QACL,wCAAkC,CAAC,KAAK,EAAE,OAA6B;YACrE,IAAI,mBAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE;gBAC5B,uBAAU,CAAI,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;aACxD;iBAAM;gBACL,uBAAU,CAAI,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;aAC7C;QACH,CAAC;QAED,8CAAqC,CACnC,KAAK,EACL,OAA6B;YAE7B,IAAI,mBAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE;gBAC5B,uBAAU,CAAI,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;aACxD;iBAAM;gBACL,uBAAU,CAAI,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;aAC7C;QACH,CAAC;QAED,8CAAqC,CACnC,KAAK,EACL,OAA6B;YAE7B,IAAI,mBAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE;gBAC5B,uBAAU,CAAI,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;aACxD;iBAAM;gBACL,uBAAU,CAAI,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;aAC7C;QACH,CAAC;KACF,CAAC;AACJ,CAAC;AAvCD,0CAuCC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { IDictionary } from \"firemock\";\nimport { FmCrudMutation } from \"../types/mutations/FmCrudMutation\";\nimport { Model, IFmWatchEvent } from \"firemodel\";\nimport { IFiremodelState } from \"../types\";\nimport { changeRoot } from \"../shared/changeRoot\";\nimport { updateList } from \"../shared/updateList\";\nimport { isRecord } from \"../shared/isRecord\";\n\n/**\n * **serverConfirms**\n *\n * When the client originates an event, it first triggers `local` mutations\n * as the first part of the \"two phased commit\", then when this action is\n * validated by the Firebase DB it sends a confirm message.\n *\n * The goal of this plugin for _rollbacks_ is to immediately change the state\n * back to what it had been before it had been optimistically set by the `local`\n * mutation.\n */\nexport function serverRollbacks<T extends Model>(\n  propOffset?: keyof T & string\n): MutationTree<T> {\n  // default to \"all\"\n  const offset: keyof T & string = !propOffset\n    ? (\"all\" as keyof T & string)\n    : propOffset;\n\n  return {\n    [FmCrudMutation.serverAddRollback](state, payload: IFmWatchEvent<Model>) {\n      if (isRecord(state, payload)) {\n        changeRoot<T>(state, payload.value, payload.localPath);\n      } else {\n        updateList<T>(state, offset, payload.value);\n      }\n    },\n\n    [FmCrudMutation.serverChangeRollback](\n      state,\n      payload: IFmWatchEvent<Model>\n    ) {\n      if (isRecord(state, payload)) {\n        changeRoot<T>(state, payload.value, payload.localPath);\n      } else {\n        updateList<T>(state, offset, payload.value);\n      }\n    },\n\n    [FmCrudMutation.serverRemoveRollback](\n      state,\n      payload: IFmWatchEvent<Model>\n    ) {\n      if (isRecord(state, payload)) {\n        changeRoot<T>(state, payload.value, payload.localPath);\n      } else {\n        updateList<T>(state, offset, payload.value);\n      }\n    }\n  };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c5c4b5777c1889a40a6f14d8ab0026c807e1f223","contentHash":"6e72b7f587eb548a7d6b04fb375d6452e7856ef9191cb7e516ab767f48357898"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverConfirms.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverConfirms.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":15,"column":4},"end":{"line":25,"column":6}},"2":{"start":{"line":27,"column":0},"end":{"line":27,"column":40}}},"fnMap":{"0":{"name":"serverConfirms","decl":{"start":{"line":14,"column":9},"end":{"line":14,"column":23}},"loc":{"start":{"line":14,"column":36},"end":{"line":26,"column":1}},"line":14},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":8},"end":{"line":16,"column":9}},"loc":{"start":{"line":16,"column":68},"end":{"line":18,"column":9}},"line":16},"2":{"name":"(anonymous_2)","decl":{"start":{"line":19,"column":8},"end":{"line":19,"column":9}},"loc":{"start":{"line":19,"column":74},"end":{"line":21,"column":9}},"line":19},"3":{"name":"(anonymous_3)","decl":{"start":{"line":22,"column":8},"end":{"line":22,"column":9}},"loc":{"start":{"line":22,"column":74},"end":{"line":24,"column":9}},"line":22}},"branchMap":{},"s":{"0":1,"1":3,"2":1},"f":{"0":3,"1":0,"2":0,"3":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverConfirms.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/serverConfirms.ts"],"names":[],"mappings":";;AAIA;;;;;;;;;;GAUG;AACH,SAAgB,cAAc,CAC5B,UAAoB;IAEpB,OAAO;QACL,2CAAiC,CAAC,KAAK,EAAE,OAA6B;YACpE,yDAAyD;QAC3D,CAAC;QAED,iDAAoC,CAAC,KAAK,EAAE,OAA6B;YACvE,EAAE;QACJ,CAAC;QAED,iDAAoC,CAAC,KAAK,EAAE,OAA6B;YACvE,mDAAmD;QACrD,CAAC;KACF,CAAC;AACJ,CAAC;AAhBD,wCAgBC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { FmCrudMutation } from \"../types/mutations/FmCrudMutation\";\nimport { Model, IFmWatchEvent } from \"firemodel\";\n\n/**\n * **serverConfirms**\n *\n * When the client originates an event, it first triggers `local` mutations\n * as the first part of the \"two phased commit\", then when this action is\n * validated by the Firebase DB it sends a confirm message.\n *\n * The goal of this plugin for _confirms_ is to do nothing more than handle the\n * event. If for some reason the consuming application wants to go further, they\n * may override the confirm funtions.\n */\nexport function serverConfirms<T extends Model>(\n  propOffset?: keyof T\n): MutationTree<T> {\n  return {\n    [FmCrudMutation.serverAddConfirm](state, payload: IFmWatchEvent<Model>) {\n      // console.log(\"server add confirmed\", payload.value.id);\n    },\n\n    [FmCrudMutation.serverChangeConfirm](state, payload: IFmWatchEvent<Model>) {\n      //\n    },\n\n    [FmCrudMutation.serverRemoveConfirm](state, payload: IFmWatchEvent<Model>) {\n      // console.log(\"server remove confirmed\", payload);\n    }\n  };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c252db8966534c301e61fcef3e1ce83ea311b737","contentHash":"8694506f2342153d7e741e39bf712ff788f4a9d2299a681f7eca4c956df11b3c"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/reset.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/reset.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":14},"end":{"line":6,"column":45}},"4":{"start":{"line":7,"column":12},"end":{"line":7,"column":25}},"5":{"start":{"line":9,"column":19},"end":{"line":9,"column":51}},"6":{"start":{"line":10,"column":4},"end":{"line":20,"column":6}},"7":{"start":{"line":12,"column":12},"end":{"line":18,"column":13}},"8":{"start":{"line":13,"column":16},"end":{"line":13,"column":53}},"9":{"start":{"line":17,"column":16},"end":{"line":17,"column":110}},"10":{"start":{"line":17,"column":55},"end":{"line":17,"column":108}},"11":{"start":{"line":22,"column":0},"end":{"line":22,"column":22}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"reset","decl":{"start":{"line":8,"column":9},"end":{"line":8,"column":14}},"loc":{"start":{"line":8,"column":27},"end":{"line":21,"column":1}},"line":8},"2":{"name":"(anonymous_2)","decl":{"start":{"line":11,"column":8},"end":{"line":11,"column":9}},"loc":{"start":{"line":11,"column":42},"end":{"line":19,"column":9}},"line":11},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":50},"end":{"line":17,"column":51}},"loc":{"start":{"line":17,"column":55},"end":{"line":17,"column":108}},"line":17}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":9,"column":19},"end":{"line":9,"column":51}},"type":"cond-expr","locations":[{"start":{"line":9,"column":33},"end":{"line":9,"column":38}},{"start":{"line":9,"column":41},"end":{"line":9,"column":51}}],"line":9},"4":{"loc":{"start":{"line":12,"column":12},"end":{"line":18,"column":13}},"type":"if","locations":[{"start":{"line":12,"column":12},"end":{"line":18,"column":13}},{"start":{"line":12,"column":12},"end":{"line":18,"column":13}}],"line":12},"5":{"loc":{"start":{"line":12,"column":16},"end":{"line":12,"column":54}},"type":"binary-expr","locations":[{"start":{"line":12,"column":16},"end":{"line":12,"column":22}},{"start":{"line":12,"column":26},"end":{"line":12,"column":54}}],"line":12}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":3,"6":3,"7":0,"8":0,"9":0,"10":0,"11":1},"f":{"0":1,"1":3,"2":0,"3":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[2,1],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/reset.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/reset.ts"],"names":[],"mappings":";;;;;AAEA,8CAAsB;AAEtB,0BAAkC;AAElC,SAAgB,KAAK,CACnB,UAA6B;IAE7B,MAAM,MAAM,GAAG,CAAC,UAAU,CAAC,CAAC,CAAE,KAA0B,CAAC,CAAC,CAAC,UAAU,CAAC;IACtE,OAAO;QACL,qBAAsB,CAAC,KAAU,EAAE,GAAW;YAC5C,IAAI,MAAM,IAAI,KAAK,CAAC,OAAO,CAAC,KAAK,CAAC,MAAM,CAAC,CAAC,EAAE;gBAC1C,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,MAAM,EAAE,EAAE,CAAC,CAAC;aAC5B;iBAAM;gBACL,2DAA2D;gBAC3D,OAAO,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CACpC,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,CAAC,EAAE,gBAAY,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CACxC,CAAC;aACH;QACH,CAAC;KACF,CAAC;AACJ,CAAC;AAhBD,sBAgBC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { Model } from \"firemodel\";\nimport Vue from \"vue\";\nimport { FmCrudMutation } from \"../types\";\nimport { initialState } from \"..\";\n\nexport function reset<T extends Model>(\n  propOffset?: keyof T & string\n): MutationTree<T> {\n  const offset = !propOffset ? (\"all\" as keyof T & string) : propOffset;\n  return {\n    [FmCrudMutation.reset](state: any, mod: string) {\n      if (offset && Array.isArray(state[offset])) {\n        Vue.set(state, offset, []);\n      } else {\n        // TODO: make this reset to \"default state\" not empty state\n        return Object.keys(state).forEach(p =>\n          Vue.set(state, p, initialState[mod][p])\n        );\n      }\n    }\n  };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"86c7dc4d7963f429a007f506a68073b0e95abe5b","contentHash":"c51510aad14fd5b11901fc4291bad7f9f40e913fd005793e9dc748ee84042ab3"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/abc.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/abc.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":21},"end":{"line":6,"column":52}},"4":{"start":{"line":7,"column":28},"end":{"line":7,"column":56}},"5":{"start":{"line":8,"column":14},"end":{"line":8,"column":45}},"6":{"start":{"line":9,"column":16},"end":{"line":9,"column":35}},"7":{"start":{"line":10,"column":12},"end":{"line":10,"column":33}},"8":{"start":{"line":12,"column":4},"end":{"line":79,"column":6}},"9":{"start":{"line":14,"column":12},"end":{"line":22,"column":13}},"10":{"start":{"line":15,"column":16},"end":{"line":15,"column":81}},"11":{"start":{"line":18,"column":16},"end":{"line":20,"column":17}},"12":{"start":{"line":19,"column":20},"end":{"line":19,"column":27}},"13":{"start":{"line":21,"column":16},"end":{"line":21,"column":92}},"14":{"start":{"line":28,"column":12},"end":{"line":38,"column":13}},"15":{"start":{"line":29,"column":36},"end":{"line":29,"column":69}},"16":{"start":{"line":30,"column":32},"end":{"line":30,"column":205}},"17":{"start":{"line":31,"column":16},"end":{"line":31,"column":98}},"18":{"start":{"line":34,"column":16},"end":{"line":36,"column":17}},"19":{"start":{"line":35,"column":20},"end":{"line":35,"column":27}},"20":{"start":{"line":37,"column":16},"end":{"line":37,"column":92}},"21":{"start":{"line":44,"column":12},"end":{"line":44,"column":48}},"22":{"start":{"line":45,"column":12},"end":{"line":45,"column":84}},"23":{"start":{"line":46,"column":12},"end":{"line":46,"column":62}},"24":{"start":{"line":47,"column":12},"end":{"line":47,"column":64}},"25":{"start":{"line":48,"column":12},"end":{"line":48,"column":31}},"26":{"start":{"line":57,"column":12},"end":{"line":65,"column":13}},"27":{"start":{"line":58,"column":16},"end":{"line":58,"column":86}},"28":{"start":{"line":61,"column":16},"end":{"line":63,"column":17}},"29":{"start":{"line":62,"column":20},"end":{"line":62,"column":27}},"30":{"start":{"line":64,"column":16},"end":{"line":64,"column":92}},"31":{"start":{"line":71,"column":12},"end":{"line":77,"column":13}},"32":{"start":{"line":72,"column":32},"end":{"line":72,"column":74}},"33":{"start":{"line":73,"column":16},"end":{"line":73,"column":116}},"34":{"start":{"line":73,"column":89},"end":{"line":73,"column":113}},"35":{"start":{"line":76,"column":16},"end":{"line":76,"column":78}},"36":{"start":{"line":81,"column":0},"end":{"line":81,"column":18}},"37":{"start":{"line":83,"column":20},"end":{"line":83,"column":35}},"38":{"start":{"line":84,"column":4},"end":{"line":87,"column":5}},"39":{"start":{"line":85,"column":8},"end":{"line":85,"column":345}},"40":{"start":{"line":86,"column":8},"end":{"line":86,"column":21}},"41":{"start":{"line":88,"column":4},"end":{"line":91,"column":5}},"42":{"start":{"line":89,"column":8},"end":{"line":89,"column":336}},"43":{"start":{"line":90,"column":8},"end":{"line":90,"column":21}},"44":{"start":{"line":92,"column":4},"end":{"line":92,"column":16}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"abc","decl":{"start":{"line":11,"column":9},"end":{"line":11,"column":12}},"loc":{"start":{"line":11,"column":25},"end":{"line":80,"column":1}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":13,"column":8},"end":{"line":13,"column":9}},"loc":{"start":{"line":13,"column":71},"end":{"line":23,"column":9}},"line":13},"3":{"name":"(anonymous_3)","decl":{"start":{"line":24,"column":8},"end":{"line":24,"column":9}},"loc":{"start":{"line":24,"column":66},"end":{"line":26,"column":9}},"line":24},"4":{"name":"(anonymous_4)","decl":{"start":{"line":27,"column":8},"end":{"line":27,"column":9}},"loc":{"start":{"line":27,"column":74},"end":{"line":39,"column":9}},"line":27},"5":{"name":"(anonymous_5)","decl":{"start":{"line":40,"column":8},"end":{"line":40,"column":9}},"loc":{"start":{"line":40,"column":78},"end":{"line":42,"column":9}},"line":40},"6":{"name":"(anonymous_6)","decl":{"start":{"line":43,"column":8},"end":{"line":43,"column":9}},"loc":{"start":{"line":43,"column":76},"end":{"line":49,"column":9}},"line":43},"7":{"name":"(anonymous_7)","decl":{"start":{"line":50,"column":8},"end":{"line":50,"column":9}},"loc":{"start":{"line":50,"column":59},"end":{"line":52,"column":9}},"line":50},"8":{"name":"(anonymous_8)","decl":{"start":{"line":53,"column":8},"end":{"line":53,"column":9}},"loc":{"start":{"line":53,"column":68},"end":{"line":55,"column":9}},"line":53},"9":{"name":"(anonymous_9)","decl":{"start":{"line":56,"column":8},"end":{"line":56,"column":9}},"loc":{"start":{"line":56,"column":70},"end":{"line":66,"column":9}},"line":56},"10":{"name":"(anonymous_10)","decl":{"start":{"line":67,"column":8},"end":{"line":67,"column":9}},"loc":{"start":{"line":67,"column":74},"end":{"line":69,"column":9}},"line":67},"11":{"name":"(anonymous_11)","decl":{"start":{"line":70,"column":8},"end":{"line":70,"column":9}},"loc":{"start":{"line":70,"column":75},"end":{"line":78,"column":9}},"line":70},"12":{"name":"(anonymous_12)","decl":{"start":{"line":73,"column":84},"end":{"line":73,"column":85}},"loc":{"start":{"line":73,"column":89},"end":{"line":73,"column":113}},"line":73},"13":{"name":"validResultSize","decl":{"start":{"line":82,"column":9},"end":{"line":82,"column":24}},"loc":{"start":{"line":82,"column":52},"end":{"line":93,"column":1}},"line":82}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":14,"column":12},"end":{"line":22,"column":13}},"type":"if","locations":[{"start":{"line":14,"column":12},"end":{"line":22,"column":13}},{"start":{"line":14,"column":12},"end":{"line":22,"column":13}}],"line":14},"4":{"loc":{"start":{"line":18,"column":16},"end":{"line":20,"column":17}},"type":"if","locations":[{"start":{"line":18,"column":16},"end":{"line":20,"column":17}},{"start":{"line":18,"column":16},"end":{"line":20,"column":17}}],"line":18},"5":{"loc":{"start":{"line":28,"column":12},"end":{"line":38,"column":13}},"type":"if","locations":[{"start":{"line":28,"column":12},"end":{"line":38,"column":13}},{"start":{"line":28,"column":12},"end":{"line":38,"column":13}}],"line":28},"6":{"loc":{"start":{"line":30,"column":128},"end":{"line":30,"column":145}},"type":"binary-expr","locations":[{"start":{"line":30,"column":128},"end":{"line":30,"column":139}},{"start":{"line":30,"column":143},"end":{"line":30,"column":145}}],"line":30},"7":{"loc":{"start":{"line":30,"column":181},"end":{"line":30,"column":202}},"type":"binary-expr","locations":[{"start":{"line":30,"column":181},"end":{"line":30,"column":196}},{"start":{"line":30,"column":200},"end":{"line":30,"column":202}}],"line":30},"8":{"loc":{"start":{"line":34,"column":16},"end":{"line":36,"column":17}},"type":"if","locations":[{"start":{"line":34,"column":16},"end":{"line":36,"column":17}},{"start":{"line":34,"column":16},"end":{"line":36,"column":17}}],"line":34},"9":{"loc":{"start":{"line":57,"column":12},"end":{"line":65,"column":13}},"type":"if","locations":[{"start":{"line":57,"column":12},"end":{"line":65,"column":13}},{"start":{"line":57,"column":12},"end":{"line":65,"column":13}}],"line":57},"10":{"loc":{"start":{"line":61,"column":16},"end":{"line":63,"column":17}},"type":"if","locations":[{"start":{"line":61,"column":16},"end":{"line":63,"column":17}},{"start":{"line":61,"column":16},"end":{"line":63,"column":17}}],"line":61},"11":{"loc":{"start":{"line":71,"column":12},"end":{"line":77,"column":13}},"type":"if","locations":[{"start":{"line":71,"column":12},"end":{"line":77,"column":13}},{"start":{"line":71,"column":12},"end":{"line":77,"column":13}}],"line":71},"12":{"loc":{"start":{"line":82,"column":34},"end":{"line":82,"column":50}},"type":"default-arg","locations":[{"start":{"line":82,"column":42},"end":{"line":82,"column":50}}],"line":82},"13":{"loc":{"start":{"line":84,"column":4},"end":{"line":87,"column":5}},"type":"if","locations":[{"start":{"line":84,"column":4},"end":{"line":87,"column":5}},{"start":{"line":84,"column":4},"end":{"line":87,"column":5}}],"line":84},"14":{"loc":{"start":{"line":88,"column":4},"end":{"line":91,"column":5}},"type":"if","locations":[{"start":{"line":88,"column":4},"end":{"line":91,"column":5}},{"start":{"line":88,"column":4},"end":{"line":91,"column":5}}],"line":88}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":3,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":1,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0},"f":{"0":1,"1":3,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0],"10":[0,0],"11":[0,0],"12":[0],"13":[0,0],"14":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/abc.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/abc.ts"],"names":[],"mappings":"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","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { changeRoot } from \"../shared/changeRoot\";\nimport { arrayToHash, hashToArray } from \"typed-conversions\";\n\nimport Vue from \"vue\";\nimport {\n  AbcMutation,\n  IDiscreteLocalResults,\n  IDiscreteServerResults,\n  IAbcResult,\n  IDiscreteResult\n} from \"../types\";\nimport { IDictionary } from \"common-types\";\nimport { AbcResult } from \"../abc/api/AbcResult\";\nimport { AbcApi } from \"../abc/api/AbcApi\";\nimport set = require(\"lodash.set\");\nimport get = require(\"lodash.get\");\n\nexport function abc<T>(propOffset?: keyof T & string): MutationTree<T> {\n  return {\n    [AbcMutation.ABC_VUEX_UPDATE_FROM_IDX]<T extends IDictionary>(\n      state: T,\n      payload: AbcResult<any>\n    ) {\n      if (payload.vuex.isList) {\n        Vue.set(state, payload.vuex.fullPath, payload.records);\n      } else {\n        if (!validResultSize(payload, \"local\")) {\n          return;\n        }\n        changeRoot<T>(state, payload.records[0], payload.vuex.moduleName);\n      }\n    },\n\n    [AbcMutation.ABC_INDEXED_SKIPPED]<T extends IDictionary>(\n      state: T,\n      payload: IDiscreteLocalResults<any>\n    ) {\n      // nothing to do; mutation is purely for informational/debugging purposes\n    },\n\n    [AbcMutation.ABC_FIREBASE_TO_VUEX_UPDATE]<T extends IDictionary>(\n      state: T,\n      payload: AbcResult<T>\n    ) {\n      if (payload.vuex.isList) {\n        const vuexRecords = state[payload.vuex.modulePostfix];\n        const updated = hashToArray({\n          ...arrayToHash(vuexRecords || []),\n          ...arrayToHash(payload.records || [])\n        });\n\n        Vue.set(state, payload.vuex.modulePostfix.replace(/\\//g, \".\"), updated);\n      } else {\n        if (!validResultSize(payload, \"server\")) {\n          return;\n        }\n        changeRoot<T>(state, payload.records[0], payload.vuex.moduleName);\n      }\n    },\n\n    [AbcMutation.ABC_FIREBASE_REFRESH_INDEXED_DB]<T>(\n      state: T,\n      payload: IDiscreteServerResults<any>\n    ) {\n      // nothing to do; mutation is purely for informational/debugging purposes\n    },\n\n    [AbcMutation.ABC_INDEXED_DB_REFRESH_FAILED]<T extends IDictionary>(\n      state: T,\n      payload: IDiscreteServerResults<any> & {\n        errorMessage: string;\n        errorStack: any;\n      }\n    ) {\n      console.group(\"Indexed DB Problem\");\n      console.warn(\"Failure to refresh the IndexedDB!\", payload.errorMessage);\n      console.warn(\"Stack Trace: \", payload.errorStack);\n      console.warn(\"Records attempted:\", payload.missing);\n      console.groupEnd();\n    },\n\n    [AbcMutation.ABC_NO_CACHE]<T>(state: T, payload: IDiscreteResult<any>) {\n      // nothing to do; mutation is purely for informational/debugging purposes\n    },\n    [AbcMutation.ABC_LOCAL_QUERY_EMPTY]<T>(\n      state: T,\n      payload: IDiscreteResult<any>\n    ) {\n      // nothing to do; mutation is purely for informational/debugging purposes\n    },\n\n    [AbcMutation.ABC_LOCAL_QUERY_TO_VUEX]<T extends IDictionary>(\n      state: T,\n      payload: AbcResult<T>\n    ) {\n      if (payload.vuex.isList) {\n        Vue.set(state, payload.vuex.modulePostfix, payload.records);\n      } else {\n        if (!validResultSize(payload)) {\n          return;\n        }\n        changeRoot<T>(state, payload.records[0], payload.vuex.moduleName);\n      }\n    },\n\n    [AbcMutation.ABC_PRUNE_STALE_IDX_RECORDS]<T extends IDictionary>(\n      state: T,\n      payload: { pks: string[]; vuex: AbcApi<T>[\"vuex\"] }\n    ) {\n      // nothing to do; mutation is purely for informational/debugging purposes\n    },\n\n    [AbcMutation.ABC_PRUNE_STALE_VUEX_RECORDS]<T extends IDictionary>(\n      state: T,\n      payload: { pks: string[]; vuex: AbcApi<T>[\"vuex\"] }\n    ) {\n      if (payload.vuex.isList) {\n        const current: any[] = get(state, payload.vuex.modulePostfix, []);\n        Vue.set(\n          state,\n          payload.vuex.modulePostfix,\n          current.filter(i => !payload.pks.includes(i))\n        );\n      } else {\n        changeRoot<T>(state, null, payload.vuex.moduleName);\n      }\n    }\n  };\n}\n\nfunction validResultSize<T>(\n  payload: AbcResult<T>,\n  where: (\"local\" | \"server\") & keyof IAbcResult<T, any> = \"server\"\n) {\n  const records = payload.records;\n  if (records.length > 1) {\n    console.warn(\n      `There were ${records.length} records in the payload of the ${AbcMutation.ABC_VUEX_UPDATE_FROM_IDX} mutation for the ${payload.vuex.moduleName} Vuex module; this module is configured as for storage of a SINGULAR record not a list of records! This mutation will be ignored until this problem is corrected.`,\n      records\n    );\n    return false;\n  }\n  if (records.length === 0) {\n    console.warn(\n      `There were zero records in the payload of the ${AbcMutation.ABC_VUEX_UPDATE_FROM_IDX} mutation for the ${payload.vuex.moduleName} Vuex module! This mutation will be ignored; use the ${AbcMutation.ABC_MODULE_CLEARED} mutation if your intent is to remove state from a Vuex module with the ABC API.`\n    );\n    return false;\n  }\n\n  return true;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b22d4f50e25df103a4560f2523d0b2d7e7af2dcc","contentHash":"4b0542b23014fd5cb2900691314c9017f4f830bd6f5cc482d4ea2b9268673ecf"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/watchEvents.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/watchEvents.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":19},"end":{"line":6,"column":48}},"4":{"start":{"line":7,"column":21},"end":{"line":7,"column":52}},"5":{"start":{"line":8,"column":14},"end":{"line":8,"column":45}},"6":{"start":{"line":10,"column":19},"end":{"line":10,"column":51}},"7":{"start":{"line":11,"column":4},"end":{"line":24,"column":6}},"8":{"start":{"line":17,"column":12},"end":{"line":22,"column":13}},"9":{"start":{"line":18,"column":16},"end":{"line":18,"column":81}},"10":{"start":{"line":21,"column":16},"end":{"line":21,"column":64}},"11":{"start":{"line":26,"column":0},"end":{"line":26,"column":34}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"watchEvents","decl":{"start":{"line":9,"column":9},"end":{"line":9,"column":20}},"loc":{"start":{"line":9,"column":33},"end":{"line":25,"column":1}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":16,"column":8},"end":{"line":16,"column":9}},"loc":{"start":{"line":16,"column":68},"end":{"line":23,"column":9}},"line":16}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":10,"column":19},"end":{"line":10,"column":51}},"type":"cond-expr","locations":[{"start":{"line":10,"column":33},"end":{"line":10,"column":38}},{"start":{"line":10,"column":41},"end":{"line":10,"column":51}}],"line":10},"4":{"loc":{"start":{"line":17,"column":12},"end":{"line":22,"column":13}},"type":"if","locations":[{"start":{"line":17,"column":12},"end":{"line":22,"column":13}},{"start":{"line":17,"column":12},"end":{"line":22,"column":13}}],"line":17}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":3,"7":3,"8":0,"9":0,"10":0,"11":1},"f":{"0":1,"1":3,"2":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[2,1],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/watchEvents.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/firemodelMutations/watchEvents.ts"],"names":[],"mappings":";;;;;AAIA,iDAA8C;AAC9C,qDAAkD;AAClD,8CAAsB;AAEtB,SAAgB,WAAW,CAAI,UAA6B;IAC1D,MAAM,MAAM,GAAG,CAAC,UAAU,CAAC,CAAC,CAAE,KAA0B,CAAC,CAAC,CAAC,UAAU,CAAC;IAEtE,OAAO;QACL;;;WAGG;QACH,2CAAgC,CAC9B,KAA2B,EAC3B,OAAyB;YAEzB,IAAI,mBAAQ,CAAC,KAAK,EAAE,OAAO,CAAC,EAAE;gBAC5B,uBAAU,CAAI,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,SAAS,CAAC,CAAC;aACxD;iBAAM;gBACL,aAAG,CAAC,GAAG,CAAC,KAAK,EAAE,MAAM,EAAE,OAAO,CAAC,KAAK,CAAC,CAAC;aACvC;QACH,CAAC;KACF,CAAC;AACJ,CAAC;AAnBD,kCAmBC","sourcesContent":["import { MutationTree } from \"vuex\";\nimport { FmCrudMutation } from \"../types\";\nimport { IFmWatchEvent } from \"firemodel\";\nimport { IDictionary } from \"common-types\";\nimport { isRecord } from \"../shared/isRecord\";\nimport { changeRoot } from \"../shared/changeRoot\";\nimport Vue from \"vue\";\n\nexport function watchEvents<T>(propOffset?: keyof T & string): MutationTree<T> {\n  const offset = !propOffset ? (\"all\" as keyof T & string) : propOffset;\n\n  return {\n    /**\n     * Bring in the server's current state at the point that a\n     * watcher has been setup.\n     */\n    [FmCrudMutation.serverStateSync](\n      state: T | IDictionary<T[]>,\n      payload: IFmWatchEvent<T>\n    ) {\n      if (isRecord(state, payload)) {\n        changeRoot<T>(state, payload.value, payload.localPath);\n      } else {\n        Vue.set(state, offset, payload.value);\n      }\n    }\n  };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"0aff6faf791735334c02bcbe7e7776f3199537a0","contentHash":"ee89332b8a39a7a5cad4ae85173132f4cd0a2c3dadca4aaadc87dd5d45a913b9"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/index.ts","statementMap":{"0":{"start":{"line":3,"column":4},"end":{"line":3,"column":71}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"2":{"start":{"line":3,"column":53},"end":{"line":3,"column":71}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":28}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":29}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":51}}},"fnMap":{"0":{"name":"__export","decl":{"start":{"line":2,"column":9},"end":{"line":2,"column":17}},"loc":{"start":{"line":2,"column":21},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"type":"if","locations":[{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},{"start":{"line":3,"column":21},"end":{"line":3,"column":71}}],"line":3}},"s":{"0":3,"1":15,"2":15,"3":1,"4":1,"5":1,"6":1},"f":{"0":3},"b":{"0":[15,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/index.ts"],"names":[],"mappings":";;;;;AAAA,4BAAuB;AACvB,6BAAwB;AACxB,mDAA8C","sourcesContent":["export * from \"./auth\";\nexport * from \"./other\";\nexport * from \"./providers/EmailAuthProvider\";\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"88f7eb2073589e1fe6e8e471965b7e626a5cb5ee","contentHash":"368844e2ceaf32db45663e1ebed4410eca9a992b025fb4e5ba1eca40394702ba"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/auth.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/auth.ts","statementMap":{"0":{"start":{"line":7,"column":0},"end":{"line":7,"column":62}},"1":{"start":{"line":8,"column":16},"end":{"line":8,"column":38}},"2":{"start":{"line":9,"column":31},"end":{"line":9,"column":75}},"3":{"start":{"line":15,"column":4},"end":{"line":19,"column":7}},"4":{"start":{"line":21,"column":0},"end":{"line":21,"column":64}},"5":{"start":{"line":28,"column":4},"end":{"line":32,"column":7}},"6":{"start":{"line":34,"column":0},"end":{"line":34,"column":72}},"7":{"start":{"line":41,"column":4},"end":{"line":44,"column":7}},"8":{"start":{"line":46,"column":0},"end":{"line":46,"column":26}},"9":{"start":{"line":49,"column":20},"end":{"line":49,"column":58}},"10":{"start":{"line":50,"column":4},"end":{"line":52,"column":5}},"11":{"start":{"line":51,"column":8},"end":{"line":51,"column":29}},"12":{"start":{"line":53,"column":17},"end":{"line":53,"column":40}},"13":{"start":{"line":54,"column":25},"end":{"line":54,"column":119}},"14":{"start":{"line":55,"column":4},"end":{"line":58,"column":5}},"15":{"start":{"line":56,"column":22},"end":{"line":56,"column":40}},"16":{"start":{"line":57,"column":8},"end":{"line":57,"column":21}},"17":{"start":{"line":59,"column":4},"end":{"line":61,"column":117}},"18":{"start":{"line":63,"column":0},"end":{"line":63,"column":32}},"19":{"start":{"line":71,"column":4},"end":{"line":75,"column":7}},"20":{"start":{"line":77,"column":0},"end":{"line":77,"column":56}},"21":{"start":{"line":83,"column":4},"end":{"line":87,"column":7}},"22":{"start":{"line":89,"column":0},"end":{"line":89,"column":52}},"23":{"start":{"line":95,"column":4},"end":{"line":98,"column":7}},"24":{"start":{"line":100,"column":0},"end":{"line":100,"column":58}},"25":{"start":{"line":106,"column":4},"end":{"line":109,"column":7}},"26":{"start":{"line":111,"column":0},"end":{"line":111,"column":34}},"27":{"start":{"line":119,"column":4},"end":{"line":122,"column":7}},"28":{"start":{"line":124,"column":0},"end":{"line":124,"column":40}},"29":{"start":{"line":130,"column":4},"end":{"line":133,"column":7}},"30":{"start":{"line":135,"column":0},"end":{"line":135,"column":38}},"31":{"start":{"line":140,"column":4},"end":{"line":142,"column":7}},"32":{"start":{"line":144,"column":0},"end":{"line":144,"column":54}},"33":{"start":{"line":146,"column":4},"end":{"line":149,"column":7}},"34":{"start":{"line":151,"column":0},"end":{"line":151,"column":68}},"35":{"start":{"line":153,"column":4},"end":{"line":156,"column":7}},"36":{"start":{"line":158,"column":0},"end":{"line":158,"column":48}}},"fnMap":{"0":{"name":"signInWithEmailAndPassword","decl":{"start":{"line":14,"column":15},"end":{"line":14,"column":41}},"loc":{"start":{"line":14,"column":59},"end":{"line":20,"column":1}},"line":14},"1":{"name":"createUserWithEmailAndPassword","decl":{"start":{"line":27,"column":15},"end":{"line":27,"column":45}},"loc":{"start":{"line":27,"column":63},"end":{"line":33,"column":1}},"line":27},"2":{"name":"signOut","decl":{"start":{"line":40,"column":15},"end":{"line":40,"column":22}},"loc":{"start":{"line":40,"column":32},"end":{"line":45,"column":1}},"line":40},"3":{"name":"getIdToken","decl":{"start":{"line":47,"column":15},"end":{"line":47,"column":25}},"loc":{"start":{"line":47,"column":40},"end":{"line":62,"column":1}},"line":47},"4":{"name":"sendPasswordResetEmail","decl":{"start":{"line":70,"column":15},"end":{"line":70,"column":37}},"loc":{"start":{"line":70,"column":65},"end":{"line":76,"column":1}},"line":70},"5":{"name":"confirmPasswordReset","decl":{"start":{"line":82,"column":15},"end":{"line":82,"column":35}},"loc":{"start":{"line":82,"column":55},"end":{"line":88,"column":1}},"line":82},"6":{"name":"verifyPasswordResetCode","decl":{"start":{"line":94,"column":15},"end":{"line":94,"column":38}},"loc":{"start":{"line":94,"column":45},"end":{"line":99,"column":1}},"line":94},"7":{"name":"updateEmail","decl":{"start":{"line":105,"column":15},"end":{"line":105,"column":26}},"loc":{"start":{"line":105,"column":37},"end":{"line":110,"column":1}},"line":105},"8":{"name":"updatePassword","decl":{"start":{"line":118,"column":15},"end":{"line":118,"column":29}},"loc":{"start":{"line":118,"column":40},"end":{"line":123,"column":1}},"line":118},"9":{"name":"updateProfile","decl":{"start":{"line":129,"column":15},"end":{"line":129,"column":28}},"loc":{"start":{"line":129,"column":38},"end":{"line":134,"column":1}},"line":129},"10":{"name":"sendEmailVerification","decl":{"start":{"line":139,"column":15},"end":{"line":139,"column":36}},"loc":{"start":{"line":139,"column":39},"end":{"line":143,"column":1}},"line":139},"11":{"name":"reauthenticateWithCredential","decl":{"start":{"line":145,"column":15},"end":{"line":145,"column":43}},"loc":{"start":{"line":145,"column":56},"end":{"line":150,"column":1}},"line":145},"12":{"name":"linkWithCredential","decl":{"start":{"line":152,"column":15},"end":{"line":152,"column":33}},"loc":{"start":{"line":152,"column":46},"end":{"line":157,"column":1}},"line":152}},"branchMap":{"0":{"loc":{"start":{"line":50,"column":4},"end":{"line":52,"column":5}},"type":"if","locations":[{"start":{"line":50,"column":4},"end":{"line":52,"column":5}},{"start":{"line":50,"column":4},"end":{"line":52,"column":5}}],"line":50},"1":{"loc":{"start":{"line":50,"column":8},"end":{"line":50,"column":46}},"type":"binary-expr","locations":[{"start":{"line":50,"column":8},"end":{"line":50,"column":21}},{"start":{"line":50,"column":25},"end":{"line":50,"column":46}}],"line":50},"2":{"loc":{"start":{"line":54,"column":25},"end":{"line":54,"column":119}},"type":"cond-expr","locations":[{"start":{"line":54,"column":77},"end":{"line":54,"column":83}},{"start":{"line":54,"column":86},"end":{"line":54,"column":119}}],"line":54},"3":{"loc":{"start":{"line":54,"column":25},"end":{"line":54,"column":74}},"type":"binary-expr","locations":[{"start":{"line":54,"column":25},"end":{"line":54,"column":57}},{"start":{"line":54,"column":61},"end":{"line":54,"column":74}}],"line":54},"4":{"loc":{"start":{"line":55,"column":4},"end":{"line":58,"column":5}},"type":"if","locations":[{"start":{"line":55,"column":4},"end":{"line":58,"column":5}},{"start":{"line":55,"column":4},"end":{"line":58,"column":5}}],"line":55},"5":{"loc":{"start":{"line":59,"column":100},"end":{"line":61,"column":81}},"type":"cond-expr","locations":[{"start":{"line":60,"column":10},"end":{"line":60,"column":12}},{"start":{"line":61,"column":10},"end":{"line":61,"column":81}}],"line":59}},"s":{"0":1,"1":1,"2":1,"3":0,"4":1,"5":0,"6":1,"7":0,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":1,"21":0,"22":1,"23":0,"24":1,"25":0,"26":1,"27":0,"28":1,"29":0,"30":1,"31":0,"32":1,"33":0,"34":1,"35":0,"36":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/auth.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/auth.ts"],"names":[],"mappings":"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","sourcesContent":["/**\n * These functions are really just wrappers around the available actions\n * which Firemodel provides but are type-safe and often are a more easily\n * used means to achieve **Firebase** _auth_ functions\n */\n\nimport { getStore, getAuth } from \"../../index\";\nimport {\n  ActionCodeSettings,\n  UserCredential,\n  IdTokenResult,\n  AuthCredential\n} from \"@firebase/auth-types\";\nimport { IAuthProfile, IFiremodelState } from \"../../types\";\nimport { IModelConstructor } from \"firemodel\";\nimport { FireModelPluginError } from \"../../errors/FiremodelPluginError\";\n\n/**\n * Log into the Firebase AUTH sytem using email/password. If successful it returns\n * a Firebase \"user credential\".\n */\nexport async function signInWithEmailAndPassword(\n  email: string,\n  password: string\n): Promise<UserCredential> {\n  return getStore().dispatch({\n    type: \"@firemodel/signInWithEmailAndPassword\",\n    email,\n    password\n  });\n}\n\n/**\n * Allows a frontend app to create a new user for email and password\n * authentication. The account will initially be set to _un-verified_ but\n * the email used will be sent a link to make the account verified.\n */\nexport async function createUserWithEmailAndPassword(\n  email: string,\n  password: string\n): Promise<UserCredential> {\n  return getStore().dispatch({\n    type: \"@firemodel/createUserWithEmailAndPassword\",\n    email,\n    password\n  });\n}\n\n/**\n * Signs out the current user from Firebase; it will also\n * optionally send a **reset** to the `Model` which stores the\n * user profile of the user.\n */\nexport async function signOut(payload: {\n  uid?: string;\n  email?: string;\n  /** model constructor or db path */\n  model?: IModelConstructor | string;\n}) {\n  return getStore().dispatch({\n    type: \"@firemodel/signOut\",\n    payload\n  });\n}\n\nexport async function getIdToken(\n  forceRefresh?: boolean\n): Promise<IdTokenResult> {\n  const fmState = getStore().state[\"@firemodel\"] as IFiremodelState<any>;\n  if (fmState.token && forceRefresh !== true) {\n    return fmState.token;\n  }\n  const auth = await getAuth();\n  const tokenPromise = auth.currentUser?.getIdTokenResult(forceRefresh);\n  if (tokenPromise) {\n    const token = await tokenPromise;\n    return token;\n  }\n\n  throw new FireModelPluginError(\n    `Call to getIdToken() returned nothing! ${\n      auth.currentUser\n        ? \"\"\n        : 'This was because -- for some reason -- the \"userProfile\" was not set!'\n    }`,\n    \"firemodel-plugin/not-allowed\"\n  );\n}\n\n/**\n * Sends a password reset email to the given email address.\n * To complete the password reset, dispatch `confirmPasswordReset` with\n * the code supplied in the email sent to the user, along with the new password\n * specified by the user.\n */\nexport async function sendPasswordResetEmail(\n  email: string,\n  actionCodeSettings?: ActionCodeSettings\n): Promise<void> {\n  return getStore().dispatch({\n    type: \"@firemodel/sendPasswordResetEmail\",\n    email,\n    actionCodeSettings\n  });\n}\n\n/**\n * Completes the password reset process, given a _confirmation code_\n * and new _password_.\n */\nexport async function confirmPasswordReset(\n  code: string,\n  newPassword: string\n): Promise<void> {\n  return getStore().dispatch({\n    type: \"@firemodel/confirmPassordReset\",\n    code,\n    newPassword\n  });\n}\n\n/**\n * Checks a password reset code sent to the user by email or other\n * out-of-band mechanism. Returns the user's email address if valid.\n */\nexport async function verifyPasswordResetCode(code: string): Promise<string> {\n  return getStore().dispatch({\n    type: \"@firemodel/verifyPasswordResetCode\",\n    code\n  });\n}\n\n/**\n * Updates the user's email address. An email will be sent to the original email address\n * that allows owner of that email address to revoke the email address change.\n */\nexport async function updateEmail(newEmail: string): Promise<void> {\n  return getStore().dispatch({\n    type: \"@firemodel/updateEmail\",\n    payload: newEmail\n  });\n}\n\n/**\n * Updates the user's password. In order to allow this operation a user\n * must have logged in recently. If this requirement isn't met a\n * `auth/requires-recent-login` error will be thrown. You will then have to\n * call the `reauthenticateWithCredential` to resolve this.\n */\nexport async function updatePassword(password: string): Promise<void> {\n  return getStore().dispatch({\n    type: \"@firemodel/updatePassword\",\n    password\n  });\n}\n\n/**\n * Update a user's basic profile information with name and/or\n * photo URL.\n */\nexport async function updateProfile(profile: IAuthProfile) {\n  return getStore().dispatch({\n    type: \"@firemodel/updateProfile\",\n    profile\n  });\n}\n\n/**\n * Sends a verification email to the currently logged in user\n */\nexport async function sendEmailVerification(): Promise<void> {\n  return getStore().dispatch({\n    type: \"@firemodel/sendEmailVerification\"\n  });\n}\n\nexport async function reauthenticateWithCredential(\n  credential: AuthCredential\n): Promise<void> {\n  return getStore().dispatch({\n    type: \"@firemodel/reauthenticateWithCredential\",\n    credential\n  });\n}\n\nexport async function linkWithCredential(credential: AuthCredential) {\n  return getStore().dispatch({\n    type: \"@firemodel/linkWithCredential\",\n    credential\n  });\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"8bf60495138e46a1c4ac0fcadf6fbe45d04a0c8d","contentHash":"b387bf08ff0a4ea8e31031f5d026ff7cc8b173c7f811841ea143c081cebb3e4c"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/other.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/other.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":16},"end":{"line":3,"column":38}},"2":{"start":{"line":5,"column":4},"end":{"line":5,"column":64}},"3":{"start":{"line":7,"column":0},"end":{"line":7,"column":34}}},"fnMap":{"0":{"name":"resetModule","decl":{"start":{"line":4,"column":9},"end":{"line":4,"column":20}},"loc":{"start":{"line":4,"column":29},"end":{"line":6,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":0,"3":1},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/other.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/other.ts"],"names":[],"mappings":";;AAAA,uCAAuC;AAEvC,SAAgB,WAAW,CAAC,MAAc;IACxC,OAAO,gBAAQ,EAAE,CAAC,MAAM,CAAC,GAAG,MAAM,QAAQ,EAAE,MAAM,CAAC,CAAC;AACtD,CAAC;AAFD,kCAEC","sourcesContent":["import { getStore } from \"../../index\";\n\nexport function resetModule(module: string) {\n  return getStore().commit(`${module}/RESET`, module);\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"e5b35f1ade00e94c96495e51215897a85a532504","contentHash":"fdde98d5a3169bb1746634fd7b8c179cd673fd350b04b41df8d3766e805ec977"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/providers/EmailAuthProvider.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/providers/EmailAuthProvider.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":19},"end":{"line":3,"column":54}},"2":{"start":{"line":4,"column":31},"end":{"line":4,"column":78}},"3":{"start":{"line":7,"column":19},"end":{"line":7,"column":46}},"4":{"start":{"line":8,"column":8},"end":{"line":10,"column":9}},"5":{"start":{"line":9,"column":12},"end":{"line":9,"column":225}},"6":{"start":{"line":11,"column":8},"end":{"line":11,"column":78}},"7":{"start":{"line":14,"column":0},"end":{"line":14,"column":46}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":6,"column":4},"end":{"line":6,"column":5}},"loc":{"start":{"line":6,"column":45},"end":{"line":12,"column":5}},"line":6}},"branchMap":{"0":{"loc":{"start":{"line":8,"column":8},"end":{"line":10,"column":9}},"type":"if","locations":[{"start":{"line":8,"column":8},"end":{"line":10,"column":9}},{"start":{"line":8,"column":8},"end":{"line":10,"column":9}}],"line":8}},"s":{"0":1,"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":1},"f":{"0":0},"b":{"0":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/providers/EmailAuthProvider.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/auth/api/providers/EmailAuthProvider.ts"],"names":[],"mappings":";;AAAA,uDAAoD;AACpD,+EAA4E;AAE5E,MAAa,iBAAiB;IAC5B,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,KAAa,EAAE,QAAgB;QACrD,MAAM,EAAE,GAAG,MAAM,mBAAQ,EAAE,CAAC;QAC5B,IAAI,CAAC,EAAE,CAAC,aAAa,EAAE;YACrB,MAAM,IAAI,2CAAoB,CAC5B,6JAA6J,CAC9J,CAAC;SACH;QACD,OAAO,EAAE,CAAC,aAAa,CAAC,iBAAiB,CAAC,UAAU,CAAC,KAAK,EAAE,QAAQ,CAAC,CAAC;IACxE,CAAC;CACF;AAVD,8CAUC","sourcesContent":["import { database } from \"../../../shared/database\";\nimport { FireModelPluginError } from \"../../../errors/FiremodelPluginError\";\n\nexport class EmailAuthProvider {\n  static async credential(email: string, password: string) {\n    const db = await database();\n    if (!db.authProviders) {\n      throw new FireModelPluginError(\n        `Attempt to call connect() was not possible because the current DB connection -- via abstracted-client -- does not have a \"authProviders\" API available yet.`\n      );\n    }\n    return db.authProviders.EmailAuthProvider.credential(email, password);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"f406a74b07f6e52fba2a5c01aa19e0fd307207ed","contentHash":"6a6724a75c33fa22b0637ce7bbcb9997f89022ebc41755dd104b372fa49764fc"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/index.ts","statementMap":{"0":{"start":{"line":3,"column":4},"end":{"line":3,"column":71}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"2":{"start":{"line":3,"column":53},"end":{"line":3,"column":71}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":41}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":47}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":27}}},"fnMap":{"0":{"name":"__export","decl":{"start":{"line":2,"column":9},"end":{"line":2,"column":17}},"loc":{"start":{"line":2,"column":21},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"type":"if","locations":[{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},{"start":{"line":3,"column":21},"end":{"line":3,"column":71}}],"line":3}},"s":{"0":3,"1":8,"2":8,"3":1,"4":1,"5":1,"6":1},"f":{"0":3},"b":{"0":[8,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/index.ts"],"names":[],"mappings":";;;;;AAAA,yCAAoC;AACpC,+CAA0C;AAC1C,2BAAqB","sourcesContent":["export * from './configuration/abc';\nexport * from './configuration/configApi';\nexport * from './api'"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b75801a88c6659b0ddcc6ab3e2074ce6049e67a8","contentHash":"c7684694172db7f58c7fbcbbe43c49513aea8a3169fdc044c034a4b213ad5da7"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/configuration/abc.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/configuration/abc.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":17},"end":{"line":3,"column":41}},"2":{"start":{"line":8,"column":16},"end":{"line":8,"column":50}},"3":{"start":{"line":9,"column":4},"end":{"line":9,"column":72}},"4":{"start":{"line":11,"column":0},"end":{"line":11,"column":18}}},"fnMap":{"0":{"name":"abc","decl":{"start":{"line":7,"column":9},"end":{"line":7,"column":12}},"loc":{"start":{"line":7,"column":33},"end":{"line":10,"column":1}},"line":7}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":20},"end":{"line":7,"column":31}},"type":"default-arg","locations":[{"start":{"line":7,"column":29},"end":{"line":7,"column":31}}],"line":7}},"s":{"0":1,"1":1,"2":8,"3":6,"4":1},"f":{"0":8},"b":{"0":[5]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/configuration/abc.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/configuration/abc.ts"],"names":[],"mappings":";;AAAA,0CAAuC;AAKvC;;GAEG;AACH,SAAgB,GAAG,CACjB,KAA6B,EAC7B,SAA2B,EAAE;IAE7B,MAAM,GAAG,GAAG,IAAI,eAAM,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;IAEtC,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,EAAE,GAAG,CAAC,KAAK,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC,CAAC;AACtE,CAAC;AAPD,kBAOC","sourcesContent":["import { AbcApi } from \"../api/AbcApi\";\nimport { IAbcApiConfig } from \"../../types/abc\";\nimport { IFmModelConstructor } from \"../../types\";\nimport { Model } from \"firemodel\";\n\n/**\n * Returns an array of **AbcApi** API's: `get`, `load`, and `watch`\n */\nexport function abc<T extends Model>(\n  model: IFmModelConstructor<T>,\n  config: IAbcApiConfig<T> = {}\n): [AbcApi<T>[\"get\"], AbcApi<T>[\"load\"], AbcApi<T>[\"watch\"]] {\n  const api = new AbcApi(model, config);\n\n  return [api.get.bind(api), api.load.bind(api), api.watch.bind(api)];\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"bbc335cad0e5c7520c29f78feda6daa29b970790","contentHash":"40d8cef8dfecebf5e287e298704e32f941ddf9a4d6a57c47005d40f5e1d57013"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/AbcApi.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/AbcApi.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":40}},"2":{"start":{"line":4,"column":14},"end":{"line":4,"column":40}},"3":{"start":{"line":5,"column":20},"end":{"line":5,"column":57}},"4":{"start":{"line":6,"column":17},"end":{"line":6,"column":40}},"5":{"start":{"line":7,"column":17},"end":{"line":7,"column":40}},"6":{"start":{"line":8,"column":23},"end":{"line":8,"column":58}},"7":{"start":{"line":9,"column":16},"end":{"line":9,"column":45}},"8":{"start":{"line":10,"column":20},"end":{"line":10,"column":42}},"9":{"start":{"line":11,"column":24},"end":{"line":11,"column":57}},"10":{"start":{"line":12,"column":23},"end":{"line":12,"column":46}},"11":{"start":{"line":20,"column":8},"end":{"line":20,"column":28}},"12":{"start":{"line":21,"column":8},"end":{"line":21,"column":30}},"13":{"start":{"line":22,"column":8},"end":{"line":22,"column":31}},"14":{"start":{"line":26,"column":8},"end":{"line":26,"column":39}},"15":{"start":{"line":27,"column":8},"end":{"line":27,"column":99}},"16":{"start":{"line":28,"column":20},"end":{"line":28,"column":69}},"17":{"start":{"line":29,"column":8},"end":{"line":31,"column":20}},"18":{"start":{"line":32,"column":8},"end":{"line":32,"column":38}},"19":{"start":{"line":33,"column":8},"end":{"line":37,"column":10}},"20":{"start":{"line":38,"column":8},"end":{"line":38,"column":35}},"21":{"start":{"line":39,"column":8},"end":{"line":39,"column":30}},"22":{"start":{"line":46,"column":8},"end":{"line":46,"column":74}},"23":{"start":{"line":52,"column":26},"end":{"line":52,"column":50}},"24":{"start":{"line":53,"column":8},"end":{"line":55,"column":9}},"25":{"start":{"line":54,"column":12},"end":{"line":54,"column":142}},"26":{"start":{"line":56,"column":8},"end":{"line":56,"column":49}},"27":{"start":{"line":57,"column":8},"end":{"line":57,"column":21}},"28":{"start":{"line":64,"column":8},"end":{"line":64,"column":50}},"29":{"start":{"line":70,"column":8},"end":{"line":72,"column":66}},"30":{"start":{"line":71,"column":25},"end":{"line":71,"column":69}},"31":{"start":{"line":72,"column":22},"end":{"line":72,"column":64}},"32":{"start":{"line":78,"column":18},"end":{"line":78,"column":50}},"33":{"start":{"line":79,"column":21},"end":{"line":79,"column":53}},"34":{"start":{"line":80,"column":8},"end":{"line":82,"column":9}},"35":{"start":{"line":81,"column":12},"end":{"line":81,"column":151}},"36":{"start":{"line":83,"column":8},"end":{"line":83,"column":43}},"37":{"start":{"line":89,"column":24},"end":{"line":89,"column":26}},"38":{"start":{"line":90,"column":8},"end":{"line":95,"column":11}},"39":{"start":{"line":91,"column":24},"end":{"line":91,"column":88}},"40":{"start":{"line":92,"column":12},"end":{"line":94,"column":13}},"41":{"start":{"line":93,"column":16},"end":{"line":93,"column":53}},"42":{"start":{"line":96,"column":8},"end":{"line":96,"column":35}},"43":{"start":{"line":97,"column":8},"end":{"line":97,"column":35}},"44":{"start":{"line":98,"column":8},"end":{"line":100,"column":9}},"45":{"start":{"line":99,"column":12},"end":{"line":99,"column":32}},"46":{"start":{"line":103,"column":8},"end":{"line":103,"column":39}},"47":{"start":{"line":110,"column":23},"end":{"line":110,"column":56}},"48":{"start":{"line":111,"column":8},"end":{"line":119,"column":9}},"49":{"start":{"line":112,"column":12},"end":{"line":112,"column":76}},"50":{"start":{"line":113,"column":12},"end":{"line":115,"column":13}},"51":{"start":{"line":114,"column":16},"end":{"line":114,"column":45}},"52":{"start":{"line":118,"column":12},"end":{"line":118,"column":66}},"53":{"start":{"line":126,"column":8},"end":{"line":126,"column":106}},"54":{"start":{"line":133,"column":8},"end":{"line":145,"column":10}},"55":{"start":{"line":151,"column":8},"end":{"line":180,"column":10}},"56":{"start":{"line":187,"column":8},"end":{"line":194,"column":10}},"57":{"start":{"line":202,"column":8},"end":{"line":207,"column":9}},"58":{"start":{"line":203,"column":12},"end":{"line":203,"column":61}},"59":{"start":{"line":206,"column":12},"end":{"line":206,"column":40}},"60":{"start":{"line":213,"column":22},"end":{"line":213,"column":40}},"61":{"start":{"line":214,"column":27},"end":{"line":214,"column":106}},"62":{"start":{"line":214,"column":44},"end":{"line":214,"column":105}},"63":{"start":{"line":215,"column":22},"end":{"line":215,"column":91}},"64":{"start":{"line":216,"column":8},"end":{"line":216,"column":45}},"65":{"start":{"line":217,"column":8},"end":{"line":217,"column":49}},"66":{"start":{"line":218,"column":22},"end":{"line":218,"column":115}},"67":{"start":{"line":219,"column":8},"end":{"line":221,"column":9}},"68":{"start":{"line":220,"column":12},"end":{"line":220,"column":312}},"69":{"start":{"line":222,"column":28},"end":{"line":226,"column":10}},"70":{"start":{"line":227,"column":8},"end":{"line":239,"column":9}},"71":{"start":{"line":229,"column":12},"end":{"line":229,"column":99}},"72":{"start":{"line":231,"column":13},"end":{"line":239,"column":9}},"73":{"start":{"line":233,"column":12},"end":{"line":238,"column":13}},"74":{"start":{"line":234,"column":16},"end":{"line":234,"column":115}},"75":{"start":{"line":237,"column":16},"end":{"line":237,"column":110}},"76":{"start":{"line":240,"column":8},"end":{"line":242,"column":9}},"77":{"start":{"line":241,"column":12},"end":{"line":241,"column":31}},"78":{"start":{"line":243,"column":23},"end":{"line":243,"column":100}},"79":{"start":{"line":244,"column":30},"end":{"line":249,"column":10}},"80":{"start":{"line":251,"column":8},"end":{"line":253,"column":9}},"81":{"start":{"line":252,"column":12},"end":{"line":252,"column":116}},"82":{"start":{"line":255,"column":8},"end":{"line":269,"column":9}},"83":{"start":{"line":256,"column":12},"end":{"line":268,"column":13}},"84":{"start":{"line":257,"column":32},"end":{"line":257,"column":34}},"85":{"start":{"line":258,"column":28},"end":{"line":258,"column":48}},"86":{"start":{"line":259,"column":16},"end":{"line":262,"column":19}},"87":{"start":{"line":260,"column":35},"end":{"line":260,"column":133}},"88":{"start":{"line":261,"column":20},"end":{"line":261,"column":62}},"89":{"start":{"line":263,"column":16},"end":{"line":263,"column":43}},"90":{"start":{"line":264,"column":16},"end":{"line":264,"column":124}},"91":{"start":{"line":267,"column":16},"end":{"line":267,"column":206}},"92":{"start":{"line":270,"column":8},"end":{"line":275,"column":11}},"93":{"start":{"line":281,"column":19},"end":{"line":281,"column":68}},"94":{"start":{"line":282,"column":8},"end":{"line":284,"column":9}},"95":{"start":{"line":283,"column":12},"end":{"line":283,"column":211}},"96":{"start":{"line":285,"column":8},"end":{"line":285,"column":18}},"97":{"start":{"line":291,"column":8},"end":{"line":291,"column":28}},"98":{"start":{"line":294,"column":8},"end":{"line":294,"column":38}},"99":{"start":{"line":300,"column":8},"end":{"line":300,"column":56}},"100":{"start":{"line":306,"column":8},"end":{"line":306,"column":57}},"101":{"start":{"line":312,"column":8},"end":{"line":312,"column":55}},"102":{"start":{"line":315,"column":8},"end":{"line":317,"column":9}},"103":{"start":{"line":316,"column":12},"end":{"line":316,"column":208}},"104":{"start":{"line":318,"column":8},"end":{"line":320,"column":9}},"105":{"start":{"line":319,"column":12},"end":{"line":319,"column":224}},"106":{"start":{"line":321,"column":8},"end":{"line":321,"column":31}},"107":{"start":{"line":327,"column":8},"end":{"line":327,"column":41}},"108":{"start":{"line":335,"column":8},"end":{"line":340,"column":9}},"109":{"start":{"line":336,"column":12},"end":{"line":336,"column":62}},"110":{"start":{"line":339,"column":12},"end":{"line":339,"column":40}},"111":{"start":{"line":346,"column":8},"end":{"line":346,"column":18}},"112":{"start":{"line":349,"column":8},"end":{"line":353,"column":10}},"113":{"start":{"line":356,"column":8},"end":{"line":356,"column":141}},"114":{"start":{"line":359,"column":0},"end":{"line":359,"column":24}},"115":{"start":{"line":364,"column":0},"end":{"line":364,"column":27}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":18,"column":4},"end":{"line":18,"column":5}},"loc":{"start":{"line":18,"column":36},"end":{"line":40,"column":5}},"line":18},"1":{"name":"(anonymous_1)","decl":{"start":{"line":45,"column":4},"end":{"line":45,"column":5}},"loc":{"start":{"line":45,"column":36},"end":{"line":47,"column":5}},"line":45},"2":{"name":"(anonymous_2)","decl":{"start":{"line":51,"column":4},"end":{"line":51,"column":5}},"loc":{"start":{"line":51,"column":27},"end":{"line":58,"column":5}},"line":51},"3":{"name":"(anonymous_3)","decl":{"start":{"line":63,"column":4},"end":{"line":63,"column":5}},"loc":{"start":{"line":63,"column":43},"end":{"line":65,"column":5}},"line":63},"4":{"name":"(anonymous_4)","decl":{"start":{"line":69,"column":4},"end":{"line":69,"column":5}},"loc":{"start":{"line":69,"column":44},"end":{"line":73,"column":5}},"line":69},"5":{"name":"(anonymous_5)","decl":{"start":{"line":71,"column":20},"end":{"line":71,"column":21}},"loc":{"start":{"line":71,"column":25},"end":{"line":71,"column":69}},"line":71},"6":{"name":"(anonymous_6)","decl":{"start":{"line":72,"column":17},"end":{"line":72,"column":18}},"loc":{"start":{"line":72,"column":22},"end":{"line":72,"column":64}},"line":72},"7":{"name":"(anonymous_7)","decl":{"start":{"line":77,"column":4},"end":{"line":77,"column":5}},"loc":{"start":{"line":77,"column":30},"end":{"line":84,"column":5}},"line":77},"8":{"name":"(anonymous_8)","decl":{"start":{"line":88,"column":4},"end":{"line":88,"column":5}},"loc":{"start":{"line":88,"column":25},"end":{"line":101,"column":5}},"line":88},"9":{"name":"(anonymous_9)","decl":{"start":{"line":90,"column":51},"end":{"line":90,"column":52}},"loc":{"start":{"line":90,"column":58},"end":{"line":95,"column":9}},"line":90},"10":{"name":"(anonymous_10)","decl":{"start":{"line":102,"column":4},"end":{"line":102,"column":5}},"loc":{"start":{"line":102,"column":24},"end":{"line":104,"column":5}},"line":102},"11":{"name":"(anonymous_11)","decl":{"start":{"line":109,"column":4},"end":{"line":109,"column":5}},"loc":{"start":{"line":109,"column":36},"end":{"line":120,"column":5}},"line":109},"12":{"name":"(anonymous_12)","decl":{"start":{"line":125,"column":4},"end":{"line":125,"column":5}},"loc":{"start":{"line":125,"column":16},"end":{"line":127,"column":5}},"line":125},"13":{"name":"(anonymous_13)","decl":{"start":{"line":132,"column":4},"end":{"line":132,"column":5}},"loc":{"start":{"line":132,"column":16},"end":{"line":146,"column":5}},"line":132},"14":{"name":"(anonymous_14)","decl":{"start":{"line":150,"column":4},"end":{"line":150,"column":5}},"loc":{"start":{"line":150,"column":15},"end":{"line":181,"column":5}},"line":150},"15":{"name":"(anonymous_15)","decl":{"start":{"line":186,"column":4},"end":{"line":186,"column":5}},"loc":{"start":{"line":186,"column":27},"end":{"line":195,"column":5}},"line":186},"16":{"name":"(anonymous_16)","decl":{"start":{"line":201,"column":4},"end":{"line":201,"column":5}},"loc":{"start":{"line":201,"column":37},"end":{"line":208,"column":5}},"line":201},"17":{"name":"(anonymous_17)","decl":{"start":{"line":212,"column":4},"end":{"line":212,"column":5}},"loc":{"start":{"line":212,"column":54},"end":{"line":276,"column":5}},"line":212},"18":{"name":"(anonymous_18)","decl":{"start":{"line":214,"column":39},"end":{"line":214,"column":40}},"loc":{"start":{"line":214,"column":44},"end":{"line":214,"column":105}},"line":214},"19":{"name":"(anonymous_19)","decl":{"start":{"line":259,"column":39},"end":{"line":259,"column":40}},"loc":{"start":{"line":259,"column":49},"end":{"line":262,"column":17}},"line":259},"20":{"name":"(anonymous_20)","decl":{"start":{"line":280,"column":4},"end":{"line":280,"column":5}},"loc":{"start":{"line":280,"column":13},"end":{"line":286,"column":5}},"line":280},"21":{"name":"(anonymous_21)","decl":{"start":{"line":290,"column":4},"end":{"line":290,"column":5}},"loc":{"start":{"line":290,"column":17},"end":{"line":292,"column":5}},"line":290},"22":{"name":"(anonymous_22)","decl":{"start":{"line":293,"column":4},"end":{"line":293,"column":5}},"loc":{"start":{"line":293,"column":22},"end":{"line":295,"column":5}},"line":293},"23":{"name":"(anonymous_23)","decl":{"start":{"line":299,"column":4},"end":{"line":299,"column":5}},"loc":{"start":{"line":299,"column":21},"end":{"line":301,"column":5}},"line":299},"24":{"name":"(anonymous_24)","decl":{"start":{"line":305,"column":4},"end":{"line":305,"column":5}},"loc":{"start":{"line":305,"column":22},"end":{"line":307,"column":5}},"line":305},"25":{"name":"(anonymous_25)","decl":{"start":{"line":311,"column":4},"end":{"line":311,"column":5}},"loc":{"start":{"line":311,"column":20},"end":{"line":313,"column":5}},"line":311},"26":{"name":"(anonymous_26)","decl":{"start":{"line":314,"column":4},"end":{"line":314,"column":5}},"loc":{"start":{"line":314,"column":16},"end":{"line":322,"column":5}},"line":314},"27":{"name":"(anonymous_27)","decl":{"start":{"line":326,"column":4},"end":{"line":326,"column":5}},"loc":{"start":{"line":326,"column":25},"end":{"line":328,"column":5}},"line":326},"28":{"name":"(anonymous_28)","decl":{"start":{"line":334,"column":4},"end":{"line":334,"column":5}},"loc":{"start":{"line":334,"column":38},"end":{"line":341,"column":5}},"line":334},"29":{"name":"(anonymous_29)","decl":{"start":{"line":345,"column":4},"end":{"line":345,"column":5}},"loc":{"start":{"line":345,"column":18},"end":{"line":347,"column":5}},"line":345},"30":{"name":"(anonymous_30)","decl":{"start":{"line":348,"column":4},"end":{"line":348,"column":5}},"loc":{"start":{"line":348,"column":13},"end":{"line":354,"column":5}},"line":348},"31":{"name":"(anonymous_31)","decl":{"start":{"line":355,"column":4},"end":{"line":355,"column":5}},"loc":{"start":{"line":355,"column":15},"end":{"line":357,"column":5}},"line":355}},"branchMap":{"0":{"loc":{"start":{"line":18,"column":23},"end":{"line":18,"column":34}},"type":"default-arg","locations":[{"start":{"line":18,"column":32},"end":{"line":18,"column":34}}],"line":18},"1":{"loc":{"start":{"line":29,"column":38},"end":{"line":31,"column":19}},"type":"cond-expr","locations":[{"start":{"line":30,"column":14},"end":{"line":30,"column":39}},{"start":{"line":31,"column":14},"end":{"line":31,"column":19}}],"line":29},"2":{"loc":{"start":{"line":46,"column":15},"end":{"line":46,"column":73}},"type":"cond-expr","locations":[{"start":{"line":46,"column":61},"end":{"line":46,"column":65}},{"start":{"line":46,"column":68},"end":{"line":46,"column":73}}],"line":46},"3":{"loc":{"start":{"line":46,"column":15},"end":{"line":46,"column":58}},"type":"binary-expr","locations":[{"start":{"line":46,"column":15},"end":{"line":46,"column":30}},{"start":{"line":46,"column":34},"end":{"line":46,"column":58}}],"line":46},"4":{"loc":{"start":{"line":53,"column":8},"end":{"line":55,"column":9}},"type":"if","locations":[{"start":{"line":53,"column":8},"end":{"line":55,"column":9}},{"start":{"line":53,"column":8},"end":{"line":55,"column":9}}],"line":53},"5":{"loc":{"start":{"line":80,"column":8},"end":{"line":82,"column":9}},"type":"if","locations":[{"start":{"line":80,"column":8},"end":{"line":82,"column":9}},{"start":{"line":80,"column":8},"end":{"line":82,"column":9}}],"line":80},"6":{"loc":{"start":{"line":92,"column":12},"end":{"line":94,"column":13}},"type":"if","locations":[{"start":{"line":92,"column":12},"end":{"line":94,"column":13}},{"start":{"line":92,"column":12},"end":{"line":94,"column":13}}],"line":92},"7":{"loc":{"start":{"line":98,"column":8},"end":{"line":100,"column":9}},"type":"if","locations":[{"start":{"line":98,"column":8},"end":{"line":100,"column":9}},{"start":{"line":98,"column":8},"end":{"line":100,"column":9}}],"line":98},"8":{"loc":{"start":{"line":111,"column":8},"end":{"line":119,"column":9}},"type":"if","locations":[{"start":{"line":111,"column":8},"end":{"line":119,"column":9}},{"start":{"line":111,"column":8},"end":{"line":119,"column":9}}],"line":111},"9":{"loc":{"start":{"line":113,"column":12},"end":{"line":115,"column":13}},"type":"if","locations":[{"start":{"line":113,"column":12},"end":{"line":115,"column":13}},{"start":{"line":113,"column":12},"end":{"line":115,"column":13}}],"line":113},"10":{"loc":{"start":{"line":160,"column":24},"end":{"line":160,"column":84}},"type":"cond-expr","locations":[{"start":{"line":160,"column":45},"end":{"line":160,"column":62}},{"start":{"line":160,"column":65},"end":{"line":160,"column":84}}],"line":160},"11":{"loc":{"start":{"line":165,"column":25},"end":{"line":167,"column":53}},"type":"cond-expr","locations":[{"start":{"line":166,"column":18},"end":{"line":166,"column":41}},{"start":{"line":167,"column":18},"end":{"line":167,"column":53}}],"line":165},"12":{"loc":{"start":{"line":165,"column":25},"end":{"line":165,"column":69}},"type":"binary-expr","locations":[{"start":{"line":165,"column":25},"end":{"line":165,"column":47}},{"start":{"line":165,"column":51},"end":{"line":165,"column":69}}],"line":165},"13":{"loc":{"start":{"line":171,"column":27},"end":{"line":173,"column":20}},"type":"cond-expr","locations":[{"start":{"line":172,"column":18},"end":{"line":172,"column":55}},{"start":{"line":173,"column":18},"end":{"line":173,"column":20}}],"line":171},"14":{"loc":{"start":{"line":172,"column":18},"end":{"line":172,"column":55}},"type":"binary-expr","locations":[{"start":{"line":172,"column":18},"end":{"line":172,"column":46}},{"start":{"line":172,"column":50},"end":{"line":172,"column":55}}],"line":172},"15":{"loc":{"start":{"line":177,"column":22},"end":{"line":179,"column":37}},"type":"cond-expr","locations":[{"start":{"line":178,"column":18},"end":{"line":178,"column":99}},{"start":{"line":179,"column":18},"end":{"line":179,"column":37}}],"line":177},"16":{"loc":{"start":{"line":178,"column":61},"end":{"line":178,"column":98}},"type":"binary-expr","locations":[{"start":{"line":178,"column":61},"end":{"line":178,"column":89}},{"start":{"line":178,"column":93},"end":{"line":178,"column":98}}],"line":178},"17":{"loc":{"start":{"line":201,"column":23},"end":{"line":201,"column":35}},"type":"default-arg","locations":[{"start":{"line":201,"column":33},"end":{"line":201,"column":35}}],"line":201},"18":{"loc":{"start":{"line":202,"column":8},"end":{"line":207,"column":9}},"type":"if","locations":[{"start":{"line":202,"column":8},"end":{"line":207,"column":9}},{"start":{"line":202,"column":8},"end":{"line":207,"column":9}}],"line":202},"19":{"loc":{"start":{"line":212,"column":40},"end":{"line":212,"column":52}},"type":"default-arg","locations":[{"start":{"line":212,"column":50},"end":{"line":212,"column":52}}],"line":212},"20":{"loc":{"start":{"line":219,"column":8},"end":{"line":221,"column":9}},"type":"if","locations":[{"start":{"line":219,"column":8},"end":{"line":221,"column":9}},{"start":{"line":219,"column":8},"end":{"line":221,"column":9}}],"line":219},"21":{"loc":{"start":{"line":219,"column":12},"end":{"line":219,"column":59}},"type":"binary-expr","locations":[{"start":{"line":219,"column":12},"end":{"line":219,"column":37}},{"start":{"line":219,"column":41},"end":{"line":219,"column":59}}],"line":219},"22":{"loc":{"start":{"line":227,"column":8},"end":{"line":239,"column":9}},"type":"if","locations":[{"start":{"line":227,"column":8},"end":{"line":239,"column":9}},{"start":{"line":227,"column":8},"end":{"line":239,"column":9}}],"line":227},"23":{"loc":{"start":{"line":231,"column":13},"end":{"line":239,"column":9}},"type":"if","locations":[{"start":{"line":231,"column":13},"end":{"line":239,"column":9}},{"start":{"line":231,"column":13},"end":{"line":239,"column":9}}],"line":231},"24":{"loc":{"start":{"line":233,"column":12},"end":{"line":238,"column":13}},"type":"if","locations":[{"start":{"line":233,"column":12},"end":{"line":238,"column":13}},{"start":{"line":233,"column":12},"end":{"line":238,"column":13}}],"line":233},"25":{"loc":{"start":{"line":240,"column":8},"end":{"line":242,"column":9}},"type":"if","locations":[{"start":{"line":240,"column":8},"end":{"line":242,"column":9}},{"start":{"line":240,"column":8},"end":{"line":242,"column":9}}],"line":240},"26":{"loc":{"start":{"line":251,"column":8},"end":{"line":253,"column":9}},"type":"if","locations":[{"start":{"line":251,"column":8},"end":{"line":253,"column":9}},{"start":{"line":251,"column":8},"end":{"line":253,"column":9}}],"line":251},"27":{"loc":{"start":{"line":255,"column":8},"end":{"line":269,"column":9}},"type":"if","locations":[{"start":{"line":255,"column":8},"end":{"line":269,"column":9}},{"start":{"line":255,"column":8},"end":{"line":269,"column":9}}],"line":255},"28":{"loc":{"start":{"line":260,"column":107},"end":{"line":260,"column":130}},"type":"binary-expr","locations":[{"start":{"line":260,"column":107},"end":{"line":260,"column":123}},{"start":{"line":260,"column":127},"end":{"line":260,"column":130}}],"line":260},"29":{"loc":{"start":{"line":281,"column":19},"end":{"line":281,"column":68}},"type":"binary-expr","locations":[{"start":{"line":281,"column":19},"end":{"line":281,"column":33}},{"start":{"line":281,"column":37},"end":{"line":281,"column":68}}],"line":281},"30":{"loc":{"start":{"line":282,"column":8},"end":{"line":284,"column":9}},"type":"if","locations":[{"start":{"line":282,"column":8},"end":{"line":284,"column":9}},{"start":{"line":282,"column":8},"end":{"line":284,"column":9}}],"line":282},"31":{"loc":{"start":{"line":315,"column":8},"end":{"line":317,"column":9}},"type":"if","locations":[{"start":{"line":315,"column":8},"end":{"line":317,"column":9}},{"start":{"line":315,"column":8},"end":{"line":317,"column":9}}],"line":315},"32":{"loc":{"start":{"line":318,"column":8},"end":{"line":320,"column":9}},"type":"if","locations":[{"start":{"line":318,"column":8},"end":{"line":320,"column":9}},{"start":{"line":318,"column":8},"end":{"line":320,"column":9}}],"line":318},"33":{"loc":{"start":{"line":334,"column":24},"end":{"line":334,"column":36}},"type":"default-arg","locations":[{"start":{"line":334,"column":34},"end":{"line":334,"column":36}}],"line":334},"34":{"loc":{"start":{"line":335,"column":8},"end":{"line":340,"column":9}},"type":"if","locations":[{"start":{"line":335,"column":8},"end":{"line":340,"column":9}},{"start":{"line":335,"column":8},"end":{"line":340,"column":9}}],"line":335}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":15,"12":15,"13":15,"14":15,"15":15,"16":15,"17":15,"18":15,"19":15,"20":15,"21":15,"22":11,"23":15,"24":15,"25":2,"26":13,"27":13,"28":4,"29":5,"30":9,"31":6,"32":9,"33":9,"34":9,"35":0,"36":9,"37":9,"38":9,"39":6,"40":6,"41":4,"42":9,"43":7,"44":7,"45":0,"46":0,"47":5,"48":5,"49":5,"50":5,"51":5,"52":0,"53":37,"54":31,"55":0,"56":2,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":1,"94":1,"95":0,"96":1,"97":16,"98":0,"99":7,"100":3,"101":4,"102":14,"103":1,"104":13,"105":0,"106":13,"107":0,"108":0,"109":0,"110":0,"111":0,"112":0,"113":0,"114":1,"115":1},"f":{"0":15,"1":11,"2":15,"3":4,"4":5,"5":9,"6":6,"7":9,"8":9,"9":6,"10":0,"11":5,"12":37,"13":31,"14":0,"15":2,"16":0,"17":0,"18":0,"19":0,"20":1,"21":16,"22":0,"23":7,"24":3,"25":4,"26":14,"27":0,"28":0,"29":0,"30":0,"31":0},"b":{"0":[5],"1":[0,15],"2":[2,9],"3":[11,6],"4":[2,13],"5":[0,9],"6":[4,2],"7":[0,7],"8":[5,0],"9":[5,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0],"14":[0,0],"15":[0,0],"16":[0,0],"17":[0],"18":[0,0],"19":[0],"20":[0,0],"21":[0,0],"22":[0,0],"23":[0,0],"24":[0,0],"25":[0,0],"26":[0,0],"27":[0,0],"28":[0,0],"29":[1,1],"30":[0,1],"31":[1,13],"32":[0,13],"33":[0],"34":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/AbcApi.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/AbcApi.ts"],"names":[],"mappings":"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","sourcesContent":["import {\n  Model,\n  Record,\n  IFmModelMeta,\n  FireModel,\n  DexieDb,\n  IPrimaryKey\n} from \"firemodel\";\nimport {\n  IAbcApiConfig,\n  IAbcOptions,\n  isDiscreteRequest,\n  AbcMutation,\n  IDiscreteLocalResults,\n  IAbcParam,\n  AbcRequestCommand,\n  IDiscreteOptions\n} from \"../../types/abc\";\nimport { getDefaultApiConfig } from \"../configuration/configApi\";\nimport { capitalize } from \"../../shared\";\nimport { IDictionary } from \"firemock\";\nimport { IFmModelConstructor } from \"../../types\";\nimport { AbcError } from \"../../errors\";\nimport { localRecords } from \"./api-parts/localRecords\";\nimport { getStore } from \"../../../src/index\";\nimport { AbcResult } from \"./AbcResult\";\nimport { serverRecords } from \"./shared/serverRecords\";\nimport { pathJoin } from \"common-types\";\n\n/**\n * Provides the full **ABC** API, including `get`, `load`, and `watch` but also\n * including meta-data properties too.\n */\nexport class AbcApi<T extends Model> {\n  /**\n   * keeps tabs on all of the `Model`'s which have been configured\n   * for the **ABC** API.\n   */\n  private static _modelsManaged: IDictionary<AbcApi<any>> = {};\n\n  /**\n   * The connection to the IndexedDB is not done until the first\n   * get/load command is executed. At this point the ABC API will\n   * connect to IndexedDB and keep this connection open for all\n   * subsequent calls.\n   */\n  private static _dexieDb: DexieDb;\n\n  /**\n   * Boolean flag which indicates whether the IndexedDB is connected\n   * for use with the **ABC** API.\n   */\n  public static get indexedDbConnected() {\n    return AbcApi._dexieDb && AbcApi._dexieDb.isOpen() ? true : false;\n  }\n\n  /**\n   * Adds a model to the managed models dictionary that AbcApi manages.\n   */\n  public static addModel(model: AbcApi<any>) {\n    const modelName = model.about.model.pascal;\n    if (AbcApi._modelsManaged[modelName]) {\n      throw new AbcError(\n        `You have attempted to register the model ${modelName} twice!`,\n        `abc-api/invalid-model-registration`\n      );\n    }\n\n    AbcApi._modelsManaged[modelName] = model;\n\n    return model;\n  }\n\n  /**\n   * Returns a list of `Model`'s that have been configured\n   * for use with the **ABC** API.\n   */\n  public static get configuredFiremodelModels() {\n    return Object.keys(AbcApi._modelsManaged);\n  }\n\n  /**\n   * Returns constructors for the `Model`s which will be managed by the IndexedDB\n   */\n  protected static get indexedDbModelConstructors(): IFmModelConstructor<\n    any\n  >[] {\n    return Object.keys(AbcApi._modelsManaged)\n      .filter(m => AbcApi._modelsManaged[m].config.useIndexedDb)\n      .map(m => AbcApi._modelsManaged[m]._modelConstructor);\n  }\n\n  /**\n   * returns an `AbcApi` instance for a given `Model`\n   */\n  public static getModelApi<T extends Model>(model: IFmModelConstructor<T>) {\n    const r = Record.create(model);\n    const name = capitalize(r.modelName);\n    if (!AbcApi._modelsManaged[name]) {\n      throw new AbcError(\n        `You attempted to get an AbcApi for the model ${name} but it is not yet configured!`,\n        \"abc-api/invalid-model\"\n      );\n    }\n    return AbcApi._modelsManaged[name] as AbcApi<T>;\n  }\n\n  /**\n   * Clears the **ABC** API from all models that are being managed and disconnects for IndexedDB\n   */\n  public static async clear() {\n    const waitFor: any[] = [];\n    Object.keys(AbcApi._modelsManaged).forEach(key => {\n      const ref = AbcApi.getModelApi(\n        AbcApi._modelsManaged[key].model.constructor\n      );\n      if (ref.config.useIndexedDb) {\n        waitFor.push(ref.dexieTable.clear());\n      }\n    });\n    await Promise.all(waitFor);\n    AbcApi._modelsManaged = {};\n    if (AbcApi.indexedDbConnected) {\n      AbcApi.disconnect();\n    }\n  }\n\n  public static disconnect() {\n    return AbcApi._dexieDb.close();\n  }\n\n  /**\n   * Connects to the IndexedDB; using all the models the ABC API knows\n   * about (and which have been configured to use IndexedDB)\n   */\n  public static async connectIndexedDb() {\n    const models = AbcApi.indexedDbModelConstructors;\n    if (models.length > 0) {\n      AbcApi._dexieDb = new DexieDb(`ABC-API`, ...models);\n      if (!AbcApi._dexieDb.isOpen()) {\n        await AbcApi._dexieDb.open();\n      }\n    } else {\n      console.info(\"ABC API has no models using IndexedDB\");\n    }\n  }\n\n  private _config: IAbcApiConfig<T>;\n  private _modelConstructor: IFmModelConstructor<T>;\n  // MODEL INFO\n  private _dbOffset: string;\n  private _dynamicPathComponents: (keyof T & string)[] | false;\n  private _modelName: { singular: string; plural: string; pascal: string };\n  private _modelMeta: IFmModelMeta<T>;\n  // CACHE STATS\n  private _cacheHits: number = 0;\n  private _cacheMisses: number = 0;\n  private _cacheIgnores: number = 0;\n\n  constructor(model: IFmModelConstructor<T>, config: IAbcApiConfig<T> = {}) {\n    // if (!config.db && FireModel.defaultDb) {\n    //   throw new AbcError(`You must provide a way to access the database before you instantiate the ABC API! You can pass it in explicitly as a part of the config or it will pickup the FireModel.defaultDb if that's available.`, 'not-ready')\n    // }\n    this._modelConstructor = model;\n    this._config = { ...getDefaultApiConfig(), ...config };\n    const rec = Record.create(this._modelConstructor);\n    this._dynamicPathComponents = rec.hasDynamicPath\n      ? rec.dynamicPathComponents\n      : false;\n    this._dbOffset = rec.dbOffset;\n    this._modelName = {\n      singular: rec.modelName,\n      plural: rec.pluralName,\n      pascal: capitalize(rec.modelName)\n    };\n    this._modelMeta = rec.META;\n    AbcApi.addModel(this);\n  }\n\n  /**\n   * Different naming conventions for the model along with the model's\n   * constructor\n   */\n  get model() {\n    return { ...this._modelName, constructor: this._modelConstructor };\n  }\n\n  /**\n   * Everything you wanted to know about this instance of the **ABC** API\n   * but were afraid to ask. :)\n   */\n  get about() {\n    return {\n      /**\n       * Different naming conventions for the model along with the model's\n       * constructor\n       */\n      model: this.model,\n      /** The meta infomation associated with the `Model` */\n      modelMeta: this._modelMeta,\n      /** the ABC API's configuration */\n      config: this._config,\n      dbOffset: this._dbOffset,\n      dynamicPathComponents: this._dynamicPathComponents\n    };\n  }\n\n  /**\n   * Information about the Vuex location\n   */\n  get vuex() {\n    return {\n      /**\n       * Indicates whether this module has been configured as a _list_\n       * or a _record_.\n       */\n      isList: this.config.isList,\n      /**\n       * Path to the root of the module\n       */\n      modulePath: this.config.isList ? this.model.plural : this.model.singular,\n      /**\n       * The name of the Vuex module who's state\n       * is being queried\n       */\n      moduleName: (this.config.moduleName || this.config.isList\n        ? this.about.model.plural\n        : this.about.modelMeta.localModelName) as string,\n      /**\n       * An optional offset to the module to store record(s)\n       */\n      modulePostfix: this.config.isList\n        ? this._modelMeta.localPostfix || \"all\"\n        : \"\",\n      /**\n       * The full path to where the record(s) reside\n       */\n      fullPath: this.config.isList\n        ? pathJoin(this.model.plural, this._modelMeta.localPostfix || \"all\")\n        : this.model.singular\n    };\n  }\n\n  /**\n   * Look at the performance of caching of your data for\n   * the given `Model`\n   */\n  get cachePerformance() {\n    return {\n      /** results found in IndexedDB */\n      hits: this._cacheHits,\n      /** had to go to Firebase for results */\n      misses: this._cacheMisses,\n      /** ignored the request as results were already in Vuex */\n      ignores: this._cacheIgnores\n    };\n  }\n\n  /**\n   * Get records using the **ABC** API.\n   *\n   * @request either a Query Helper (since, where, etc.) or an array of primary keys\n   */\n  async get(\n    request: IAbcParam<T>,\n    options: IAbcOptions<T> = {}\n  ): Promise<AbcResult<T>> {\n    if (isDiscreteRequest(request)) {\n      return this.getDiscrete(\"get\", request, options);\n    } else {\n      return request(\"get\", this);\n    }\n  }\n\n  /**\n   * Handles GET requests for Discrete ID requests\n   */\n  private async getDiscrete(\n    command: AbcRequestCommand,\n    request: IPrimaryKey<T>[],\n    options: IDiscreteOptions<T> = {}\n  ): Promise<AbcResult<T>> {\n    const store = getStore();\n\n    const requestIds = request.map(i =>\n      Record.compositeKeyRef(this._modelConstructor, i)\n    );\n    let results = await localRecords(command, requestIds, options, this);\n    this._cacheHits += results.cacheHits;\n    this._cacheMisses += results.cacheMisses;\n    const local: IDiscreteLocalResults<T> = {\n      ...results,\n      overallCachePerformance: this.cachePerformance\n    };\n\n    if (!this.config.useIndexedDb && command === \"load\") {\n      throw new AbcError(\n        `There was a call to load${capitalize(\n          this.model.plural\n        )}() but this is not allowed for models like ${\n          this.model.pascal\n        } which have been configured in ABC to not have IndexedDB support; use get${capitalize(\n          this.model.plural\n        )}() instead.`,\n        \"not-allowed\"\n      );\n    }\n\n    const localResult = new AbcResult(this, {\n      type: \"discrete\",\n      local,\n      options\n    });\n\n    if (local.cacheHits === 0) {\n      // No results locally\n      store.commit(\n        `${this.vuex.moduleName}/${AbcMutation.ABC_NO_CACHE}`,\n        localResult\n      );\n    } else if (this.config.useIndexedDb) {\n      // Using IndexedDB\n      if (local.foundExclusivelyInIndexedDb) {\n        store.commit(\n          `${this.vuex.moduleName}/${AbcMutation.ABC_VUEX_UPDATE_FROM_IDX}`,\n          localResult\n        );\n      } else {\n        store.commit(\n          `${this.vuex.moduleName}/${AbcMutation.ABC_INDEXED_SKIPPED}`,\n          localResult\n        );\n      }\n    }\n\n    if (local.allFoundLocally) {\n      return localResult;\n    }\n\n    const server = await serverRecords(\n      command,\n      this,\n      local.missing,\n      requestIds\n    );\n\n    const serverResults = new AbcResult(this, {\n      type: \"discrete\",\n      local,\n      server,\n      options\n    });\n\n    // Update Vuex with server results\n    if (command === \"get\") {\n      store.commit(\n        `${this.vuex.moduleName}/${AbcMutation.ABC_FIREBASE_TO_VUEX_UPDATE}`,\n        serverResults\n      );\n    }\n\n    // cache results to IndexedDB\n    if (this.config.useIndexedDb) {\n      try {\n        const waitFor: any[] = [];\n        const now = new Date().getTime();\n        server.records.forEach(record => {\n          const newRec = {\n            ...record,\n            lastUpdated: now,\n            createdAt: record.createdAt || now\n          };\n          waitFor.push(this.dexieTable.put(newRec));\n        });\n        await Promise.all(waitFor);\n        store.commit(\n          `${this.vuex.moduleName}/${AbcMutation.ABC_FIREBASE_REFRESH_INDEXED_DB}`,\n          serverResults\n        );\n      } catch (e) {\n        store.commit(\n          `${this.vuex.moduleName}/${AbcMutation.ABC_INDEXED_DB_REFRESH_FAILED}`,\n          { ...serverResults, errorMessage: e.message, errorStack: e.stack }\n        );\n      }\n    }\n\n    return new AbcResult(this, {\n      type: \"discrete\",\n      options,\n      local,\n      server\n    });\n  }\n\n  /**\n   * Provides access to the Firebase database\n   */\n  get db() {\n    const db = this.config.db || FireModel.defaultDb;\n    if (!db) {\n      throw new AbcError(\n        `Attempt to access the database via the db getter failed which means that the ABC API was not given a database connector and there is no \"defaultDb\" set with Firemodel.`\n      );\n    }\n\n    return db;\n  }\n\n  /**\n   * The **ABC** configuration for this instance's `Model`\n   */\n  get config() {\n    return this._config;\n  }\n\n  get dexieModels() {\n    return this.dexie.dexieTables;\n  }\n\n  /**\n   * Provides access to this Dexie **Table API**\n   */\n  get dexieTable() {\n    return this.dexie.table(this._modelConstructor);\n  }\n\n  /**\n   * Provides access to this Dexie **Record API**\n   */\n  get dexieRecord() {\n    return this.dexie.record(this._modelConstructor);\n  }\n\n  /**\n   * Provides access to this Dexie **List API**\n   */\n  get dexieList() {\n    return this.dexie.list(this._modelConstructor);\n  }\n\n  protected get dexie() {\n    if (!this.about.config.useIndexedDb) {\n      throw new AbcError(\n        `You are attempting to access Dexie while connected to the ABC API with the model ${this.about.model.pascal} which is configured NOT to use IndexedDB!`,\n        \"not-allowed\"\n      );\n    }\n\n    if (!AbcApi._dexieDb) {\n      throw new AbcError(\n        `The Dexie database is not yet connected; calls to get() or load() will automatically connect it but if you want to access it prior to that you must call connectDexie()`,\n        \"not-ready\"\n      );\n    }\n    return AbcApi._dexieDb;\n  }\n\n  /**\n   * Connects Dexie to IndexedDB for _all_ Firemodel Models\n   */\n  async connectDexie() {\n    return AbcApi.connectIndexedDb();\n  }\n\n  /**\n   * Load records using the **ABC** API\n   *\n   * @request either a Query Helper (since, where, etc.) or an array of primary keys\n   */\n  async load(request: IAbcParam<T>, options: IAbcOptions<T> = {}) {\n    if (isDiscreteRequest(request)) {\n      return this.getDiscrete(\"load\", request, options);\n    } else {\n      return request(\"get\", this);\n    }\n  }\n\n  /**\n   * Watch records using the **ABC** API\n   */\n  async watch() {\n    return [];\n  }\n\n  toJSON() {\n    return {\n      model: this.about.model.pascal,\n      config: this.about.config,\n      cachePerformance: this.cachePerformance\n    };\n  }\n  toString() {\n    return `ABC API for the \"${this.about.model.pascal}\" model [ cache: ${this.cachePerformance.hits}/${this.cachePerformance.misses} ]`;\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"4572231d60fa789ce89f91068398e2f2c121d09f","contentHash":"f96cb8fe3330732fb4def88ae53d2ce5579aa062cd14a101f86c42a9658e85ad"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/configuration/configApi.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/configuration/configApi.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":7,"column":1}},"2":{"start":{"line":20,"column":4},"end":{"line":20,"column":76}},"3":{"start":{"line":21,"column":4},"end":{"line":21,"column":25}},"4":{"start":{"line":23,"column":0},"end":{"line":23,"column":30}},"5":{"start":{"line":26,"column":4},"end":{"line":26,"column":25}},"6":{"start":{"line":28,"column":0},"end":{"line":28,"column":50}}},"fnMap":{"0":{"name":"configApi","decl":{"start":{"line":19,"column":9},"end":{"line":19,"column":18}},"loc":{"start":{"line":19,"column":27},"end":{"line":22,"column":1}},"line":19},"1":{"name":"getDefaultApiConfig","decl":{"start":{"line":25,"column":9},"end":{"line":25,"column":28}},"loc":{"start":{"line":25,"column":31},"end":{"line":27,"column":1}},"line":25}},"branchMap":{},"s":{"0":1,"1":1,"2":0,"3":0,"4":1,"5":15,"6":1},"f":{"0":0,"1":15},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/configuration/configApi.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/configuration/configApi.ts"],"names":[],"mappings":";;AAEA,IAAI,aAAa,GAAsC;IACrD,YAAY,EAAE,IAAI;IAClB,MAAM,EAAE,IAAI;IACZ,OAAO,EAAE,KAAK;CACf,CAAA;AAED;;;;;;;;;;GAUG;AACH,SAAgB,SAAS,CAAC,MAAyC;IACjE,aAAa,mCAAQ,aAAa,GAAK,MAAM,CAAE,CAAA;IAC/C,OAAO,aAAa,CAAA;AACtB,CAAC;AAHD,8BAGC;AAED,2DAA2D;AAC3D,SAAgB,mBAAmB;IACjC,OAAO,aAAa,CAAA;AACtB,CAAC;AAFD,kDAEC","sourcesContent":["import { IAbcApiConfig } from '../../types/abc'\n\nlet defaultConfig: Omit<IAbcApiConfig<any>, 'model'> = {\n  useIndexedDb: true,\n  isList: true,\n  encrypt: false,\n}\n\n/**\n * Allows consumers of this plugin to state the _default_ state of \n * their model's configuration. The normal defaults are:\n```typescript\n{\n  useIndexedDb: true,\n  plural: true,\n  encrypt: false,\n}\n```\n */\nexport function configApi(config: Omit<IAbcApiConfig<any>, 'model'>) {\n  defaultConfig = { ...defaultConfig, ...config }\n  return defaultConfig\n}\n\n/** the _default_ configuration for **ABC** API surfaces */\nexport function getDefaultApiConfig() {\n  return defaultConfig\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"7b048041fd1366cf4e18ed068982c5bdc520a4f2","contentHash":"c270b0456593416de8feb60879cd235dff7ccf2ffeaaa52be317f4a702c244ca"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/index.ts","statementMap":{"0":{"start":{"line":3,"column":4},"end":{"line":3,"column":71}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"2":{"start":{"line":3,"column":53},"end":{"line":3,"column":71}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":36}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":35}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":34}},"7":{"start":{"line":9,"column":0},"end":{"line":9,"column":34}},"8":{"start":{"line":10,"column":0},"end":{"line":10,"column":32}},"9":{"start":{"line":11,"column":0},"end":{"line":11,"column":47}},"10":{"start":{"line":12,"column":0},"end":{"line":12,"column":32}},"11":{"start":{"line":13,"column":0},"end":{"line":13,"column":35}},"12":{"start":{"line":14,"column":0},"end":{"line":14,"column":36}},"13":{"start":{"line":15,"column":0},"end":{"line":15,"column":38}},"14":{"start":{"line":16,"column":0},"end":{"line":16,"column":32}},"15":{"start":{"line":17,"column":0},"end":{"line":17,"column":34}}},"fnMap":{"0":{"name":"__export","decl":{"start":{"line":2,"column":9},"end":{"line":2,"column":17}},"loc":{"start":{"line":2,"column":21},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"type":"if","locations":[{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},{"start":{"line":3,"column":21},"end":{"line":3,"column":71}}],"line":3}},"s":{"0":12,"1":12,"2":12,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1},"f":{"0":12},"b":{"0":[12,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/index.ts"],"names":[],"mappings":";;;;;AAAA,oCAA+B;AAC/B,mCAA8B;AAC9B,kCAA6B;AAC7B,kCAA6B;AAC7B,gCAA2B;AAC3B,+CAA0C;AAC1C,gCAA2B;AAC3B,mCAA8B;AAC9B,oCAA+B;AAC/B,sCAAiC;AACjC,gCAA2B;AAC3B,kCAA6B","sourcesContent":["export * from './addNamespace';\nexport * from './authChanges';\nexport * from './capitalize';\nexport * from './changeRoot';\nexport * from './database';\nexport * from './determineLocalStateNode';\nexport * from './isRecord';\nexport * from './localChange';\nexport * from './localizeName';\nexport * from './removeProperty';\nexport * from './runQueue';\nexport * from './updateList';\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"b87555852f0af509c6a7ac03647a2c2e140a1db4","contentHash":"d7200e225ef0d816d3c52de9fcc6c98a30ec31acd69264e93d59c1b1f3716398"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/capitalize.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/capitalize.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":4,"column":4},"end":{"line":4,"column":58}},"2":{"start":{"line":6,"column":0},"end":{"line":6,"column":32}}},"fnMap":{"0":{"name":"capitalize","decl":{"start":{"line":3,"column":9},"end":{"line":3,"column":19}},"loc":{"start":{"line":3,"column":26},"end":{"line":5,"column":1}},"line":3}},"branchMap":{},"s":{"0":1,"1":24,"2":1},"f":{"0":24},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/capitalize.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/capitalize.ts"],"names":[],"mappings":";;AAAA,SAAgB,UAAU,CAAC,IAAY;IACrC,OAAO,IAAI,CAAC,KAAK,CAAC,CAAC,EAAC,CAAC,CAAC,CAAC,WAAW,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC;AACvD,CAAC;AAFD,gCAEC","sourcesContent":["export function capitalize(text: string) {\n  return text.slice(0,1).toUpperCase() + text.slice(1);\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"c5c3abf706f46bd04b1a0e79d719ee96e7f420f0","contentHash":"4d3492ce42c52ad4386e075f90bc62d34ebdc6ec7dd2229c00775b3ea725170a"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/localChange.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/localChange.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":40}},"2":{"start":{"line":8,"column":19},"end":{"line":8,"column":85}},"3":{"start":{"line":9,"column":4},"end":{"line":15,"column":6}},"4":{"start":{"line":17,"column":0},"end":{"line":17,"column":34}},"5":{"start":{"line":19,"column":19},"end":{"line":23,"column":5}},"6":{"start":{"line":24,"column":4},"end":{"line":24,"column":40}}},"fnMap":{"0":{"name":"localChange","decl":{"start":{"line":7,"column":9},"end":{"line":7,"column":20}},"loc":{"start":{"line":7,"column":28},"end":{"line":16,"column":1}},"line":7},"1":{"name":"mapper","decl":{"start":{"line":18,"column":9},"end":{"line":18,"column":15}},"loc":{"start":{"line":18,"column":25},"end":{"line":25,"column":1}},"line":18}},"branchMap":{"0":{"loc":{"start":{"line":24,"column":11},"end":{"line":24,"column":39}},"type":"binary-expr","locations":[{"start":{"line":24,"column":11},"end":{"line":24,"column":26}},{"start":{"line":24,"column":30},"end":{"line":24,"column":39}}],"line":24}},"s":{"0":1,"1":1,"2":0,"3":0,"4":1,"5":0,"6":0},"f":{"0":0,"1":0},"b":{"0":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/localChange.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/localChange.ts"],"names":[],"mappings":";;AAAA,yCAA4D;AAK5D;;GAEG;AACH,SAAgB,WAAW,CAAC,KAAoB;IAC9C,MAAM,MAAM,GAAG,kBAAM,CAAC,UAAU,CAAC,KAAK,CAAC,gBAAgB,EAAE,KAAK,CAAC,KAAK,CAAC,CAAC;IACtE,OAAO;QACL,MAAM,EAAE,MAAM,CAAC,MAAM;QACrB,MAAM,EAAE,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC;QAC1B,SAAS,EAAE,MAAM,CAAC,SAAS;QAC3B,KAAK,EAAE,KAAK,CAAC,KAAK;QAClB,SAAS,EAAE,IAAI,IAAI,EAAE,CAAC,OAAO,EAAE;KAChC,CAAC;AACJ,CAAC;AATD,kCASC;AAED,SAAS,MAAM,CAAC,OAAe;IAC7B,MAAM,MAAM,GAAiC;QAC3C,CAAC,oBAAQ,CAAC,oBAAoB,CAAC,EAAE,KAAK;QACtC,CAAC,oBAAQ,CAAC,sBAAsB,CAAC,EAAE,QAAQ;QAC3C,CAAC,oBAAQ,CAAC,sBAAsB,CAAC,EAAE,QAAQ;KAC5C,CAAC;IACF,OAAO,MAAM,CAAC,OAAO,CAAC,IAAI,SAAS,CAAC;AACtC,CAAC","sourcesContent":["import { IFmWatchEvent, Record, FmEvents } from \"firemodel\";\nimport { IFmLocalChange } from \"../index\";\nimport { IFmEventActions } from \"../types\";\nimport { IDictionary } from \"firemock\";\n\n/**\n * converts a \"local change\" event into the right data structure\n */\nexport function localChange(event: IFmWatchEvent): IFmLocalChange {\n  const record = Record.createWith(event.modelConstructor, event.value);\n  return {\n    dbPath: record.dbPath,\n    action: mapper(event.type),\n    localPath: record.localPath,\n    value: event.value,\n    timestamp: new Date().getTime()\n  };\n}\n\nfunction mapper(evtType: string): IFmEventActions {\n  const fields: IDictionary<IFmEventActions> = {\n    [FmEvents.RECORD_ADDED_LOCALLY]: \"add\",\n    [FmEvents.RECORD_CHANGED_LOCALLY]: \"update\",\n    [FmEvents.RECORD_REMOVED_LOCALLY]: \"remove\"\n  };\n  return fields[evtType] || \"unknown\";\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9e2e6acdb892f41ba59bb4cbda8c75a78e2e02ef","contentHash":"495207008bad762076754ce705b44d35b2ec7ed6742ea15b5733ae5a3b1311d7"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/localizeName.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/localizeName.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":7,"column":4},"end":{"line":7,"column":43}},"2":{"start":{"line":9,"column":0},"end":{"line":9,"column":36}}},"fnMap":{"0":{"name":"localizeName","decl":{"start":{"line":6,"column":9},"end":{"line":6,"column":21}},"loc":{"start":{"line":6,"column":28},"end":{"line":8,"column":1}},"line":6}},"branchMap":{},"s":{"0":1,"1":0,"2":1},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/localizeName.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/localizeName.ts"],"names":[],"mappings":";;AAAA;;GAEG;AACH,SAAgB,YAAY,CAAC,IAAY;IACvC,OAAO,IAAI,CAAC,OAAO,CAAC,aAAa,EAAE,EAAE,CAAC,CAAC;AACzC,CAAC;AAFD,oCAEC","sourcesContent":["/**\n * converts a namespaced mutation or action to a localized one\n */\nexport function localizeName(name: string) {\n  return name.replace(\"@firemodel/\", \"\");\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"40a397b31545946d4545fa1ed3278adb9aa81f7b","contentHash":"553d5d6a9a68509f24cc2a25ec6c36715460dd3fca85bda354ebb4f67f81a87f"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/removeProperty.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/removeProperty.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":7,"column":19},"end":{"line":7,"column":21}},"2":{"start":{"line":8,"column":4},"end":{"line":10,"column":54}},"3":{"start":{"line":9,"column":26},"end":{"line":9,"column":48}},"4":{"start":{"line":10,"column":27},"end":{"line":10,"column":52}},"5":{"start":{"line":11,"column":4},"end":{"line":11,"column":18}},"6":{"start":{"line":13,"column":0},"end":{"line":13,"column":40}}},"fnMap":{"0":{"name":"removeProperty","decl":{"start":{"line":6,"column":9},"end":{"line":6,"column":23}},"loc":{"start":{"line":6,"column":41},"end":{"line":12,"column":1}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":9,"column":16},"end":{"line":9,"column":17}},"loc":{"start":{"line":9,"column":26},"end":{"line":9,"column":48}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":10,"column":17},"end":{"line":10,"column":18}},"loc":{"start":{"line":10,"column":27},"end":{"line":10,"column":52}},"line":10}},"branchMap":{},"s":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":1},"f":{"0":0,"1":0,"2":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/removeProperty.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/shared/removeProperty.ts"],"names":[],"mappings":";;AACA;;GAEG;AACH,SAAgB,cAAc,CAAiC,IAAO,EAAE,GAAG,MAA4B;IACrG,MAAM,MAAM,GAAe,EAAE,CAAA;IAC7B,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC;SACd,MAAM,CAAC,CAAC,IAAsB,EAAE,EAAE,CAAC,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;SAC1D,OAAO,CAAC,CAAC,IAAsB,EAAE,EAAE,CAAC,MAAM,CAAC,IAAI,CAAC,GAAG,IAAI,CAAC,IAAI,CAAC,CAAC,CAAA;IACjE,OAAO,MAAM,CAAC;AAChB,CAAC;AAND,wCAMC","sourcesContent":["import { IDictionary } from \"common-types\";\n/**\n * Removes a property (or set of properties) from a hash/dictionary\n */\nexport function removeProperty<T extends Object = IDictionary>(hash: T, ...remove: (string & keyof T)[]) {\n  const output: Partial<T> = {}\n  Object.keys(hash)\n    .filter((prop: string & keyof T) => !remove.includes(prop))\n    .forEach((prop: string & keyof T) => output[prop] = hash[prop])\n  return output;\n}"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"02c2f1f6b464420bc7683c66c69c2b1ac79944c7","contentHash":"95e9360eaf1d731414184a50c38d71565d1bd62fa0a33281129b50e632515b94"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/index.ts","statementMap":{"0":{"start":{"line":3,"column":4},"end":{"line":3,"column":71}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"2":{"start":{"line":3,"column":53},"end":{"line":3,"column":71}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":32}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":44}}},"fnMap":{"0":{"name":"__export","decl":{"start":{"line":2,"column":9},"end":{"line":2,"column":17}},"loc":{"start":{"line":2,"column":21},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"type":"if","locations":[{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},{"start":{"line":3,"column":21},"end":{"line":3,"column":71}}],"line":3}},"s":{"0":2,"1":2,"2":2,"3":1,"4":1,"5":1},"f":{"0":2},"b":{"0":[2,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/index.ts"],"names":[],"mappings":";;;;;AAAA,gCAA2B;AAC3B,4CAAsC","sourcesContent":["export * from './AbcError';\nexport * from './FiremodelPluginError'"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"0ded1398d4eac70691c8278abd9c2a66b6d67881","contentHash":"48b5b998417eb46cdc13a89ea658bb7914ef88f0236171ecd75d6258d964f8ca"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/AbcError.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/AbcError.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":9,"column":8},"end":{"line":9,"column":23}},"2":{"start":{"line":10,"column":8},"end":{"line":10,"column":30}},"3":{"start":{"line":11,"column":8},"end":{"line":11,"column":24}},"4":{"start":{"line":12,"column":22},"end":{"line":12,"column":47}},"5":{"start":{"line":13,"column":32},"end":{"line":13,"column":82}},"6":{"start":{"line":14,"column":8},"end":{"line":14,"column":41}},"7":{"start":{"line":15,"column":8},"end":{"line":15,"column":28}},"8":{"start":{"line":18,"column":0},"end":{"line":18,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":8,"column":4},"end":{"line":8,"column":5}},"loc":{"start":{"line":8,"column":59},"end":{"line":16,"column":5}},"line":8}},"branchMap":{"0":{"loc":{"start":{"line":8,"column":25},"end":{"line":8,"column":57}},"type":"default-arg","locations":[{"start":{"line":8,"column":42},"end":{"line":8,"column":57}}],"line":8},"1":{"loc":{"start":{"line":13,"column":32},"end":{"line":13,"column":82}},"type":"cond-expr","locations":[{"start":{"line":13,"column":53},"end":{"line":13,"column":74}},{"start":{"line":13,"column":77},"end":{"line":13,"column":82}}],"line":13}},"s":{"0":1,"1":3,"2":3,"3":3,"4":3,"5":3,"6":3,"7":3,"8":1},"f":{"0":3},"b":{"0":[0],"1":[1,2]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/AbcError.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/errors/AbcError.ts"],"names":[],"mappings":";;AAAA;;;GAGG;AACH,MAAa,QAAS,SAAQ,KAAK;IAIjC,YAAY,OAAe,EAAE,iBAAyB,eAAe;QACnE,KAAK,CAAC,OAAO,CAAC,CAAC;QAJV,cAAS,GAAG,IAAI,CAAC;QACjB,QAAG,GAAG,IAAI,CAAC;QAIhB,MAAM,KAAK,GAAG,cAAc,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QACxC,MAAM,CAAC,IAAI,EAAE,OAAO,CAAC,GAAG,KAAK,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,SAAS,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;QAC3E,IAAI,CAAC,IAAI,GAAG,GAAG,IAAI,IAAI,OAAO,EAAE,CAAC;QACjC,IAAI,CAAC,IAAI,GAAG,OAAO,CAAC;IACtB,CAAC;CACF;AAXD,4BAWC","sourcesContent":["/**\n * An error within the Firemodel's Vuex plugin's **ABC** API. Takes _message_ and _type/subtype_ as\n * parameters. The code will be the `subtype`; the name is both.\n */\nexport class AbcError extends Error {\n  public firemodel = true;\n  public abc = true;\n  public code: string;\n  constructor(message: string, classification: string = \"abc-api/error\") {\n    super(message);\n    const parts = classification.split(\"/\");\n    const [type, subType] = parts.length === 1 ? [\"abc-api\", parts[0]] : parts;\n    this.name = `${type}/${subType}`;\n    this.code = subType;\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"96364acd088c350c028b74df995b3b65a8a8022b","contentHash":"c05a936ca00294b65bf1dad4618967ee00596d0d849546648b2c5fa1caa9598c"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/api-parts/localRecords.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/api-parts/localRecords.ts","statementMap":{"0":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"1":{"start":{"line":3,"column":4},"end":{"line":3,"column":62}},"2":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"3":{"start":{"line":6,"column":20},"end":{"line":6,"column":40}},"4":{"start":{"line":7,"column":17},"end":{"line":7,"column":37}},"5":{"start":{"line":8,"column":16},"end":{"line":8,"column":41}},"6":{"start":{"line":9,"column":21},"end":{"line":9,"column":59}},"7":{"start":{"line":19,"column":23},"end":{"line":19,"column":25}},"8":{"start":{"line":20,"column":18},"end":{"line":20,"column":36}},"9":{"start":{"line":21,"column":24},"end":{"line":21,"column":104}},"10":{"start":{"line":22,"column":4},"end":{"line":24,"column":5}},"11":{"start":{"line":23,"column":8},"end":{"line":23,"column":49}},"12":{"start":{"line":25,"column":4},"end":{"line":32,"column":5}},"13":{"start":{"line":26,"column":24},"end":{"line":26,"column":26}},"14":{"start":{"line":27,"column":8},"end":{"line":30,"column":13}},"15":{"start":{"line":27,"column":33},"end":{"line":30,"column":11}},"16":{"start":{"line":28,"column":12},"end":{"line":29,"column":37}},"17":{"start":{"line":29,"column":16},"end":{"line":29,"column":37}},"18":{"start":{"line":31,"column":8},"end":{"line":31,"column":35}},"19":{"start":{"line":33,"column":18},"end":{"line":33,"column":43}},"20":{"start":{"line":34,"column":20},"end":{"line":34,"column":86}},"21":{"start":{"line":34,"column":41},"end":{"line":34,"column":85}},"22":{"start":{"line":35,"column":19},"end":{"line":35,"column":84}},"23":{"start":{"line":35,"column":39},"end":{"line":35,"column":83}},"24":{"start":{"line":36,"column":21},"end":{"line":36,"column":65}},"25":{"start":{"line":37,"column":23},"end":{"line":39,"column":45}},"26":{"start":{"line":38,"column":19},"end":{"line":38,"column":101}},"27":{"start":{"line":39,"column":22},"end":{"line":39,"column":44}},"28":{"start":{"line":40,"column":26},"end":{"line":40,"column":62}},"29":{"start":{"line":41,"column":25},"end":{"line":41,"column":52}},"30":{"start":{"line":42,"column":28},"end":{"line":44,"column":48}},"31":{"start":{"line":45,"column":4},"end":{"line":56,"column":6}},"32":{"start":{"line":50,"column":56},"end":{"line":50,"column":76}},"33":{"start":{"line":58,"column":0},"end":{"line":58,"column":36}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":2,"column":56},"end":{"line":2,"column":57}},"loc":{"start":{"line":2,"column":71},"end":{"line":4,"column":1}},"line":2},"1":{"name":"localRecords","decl":{"start":{"line":18,"column":15},"end":{"line":18,"column":27}},"loc":{"start":{"line":18,"column":67},"end":{"line":57,"column":1}},"line":18},"2":{"name":"(anonymous_2)","decl":{"start":{"line":27,"column":27},"end":{"line":27,"column":28}},"loc":{"start":{"line":27,"column":33},"end":{"line":30,"column":11}},"line":27},"3":{"name":"(anonymous_3)","decl":{"start":{"line":27,"column":79},"end":{"line":27,"column":80}},"loc":{"start":{"line":27,"column":86},"end":{"line":30,"column":9}},"line":27},"4":{"name":"(anonymous_4)","decl":{"start":{"line":34,"column":36},"end":{"line":34,"column":37}},"loc":{"start":{"line":34,"column":41},"end":{"line":34,"column":85}},"line":34},"5":{"name":"(anonymous_5)","decl":{"start":{"line":35,"column":34},"end":{"line":35,"column":35}},"loc":{"start":{"line":35,"column":39},"end":{"line":35,"column":83}},"line":35},"6":{"name":"(anonymous_6)","decl":{"start":{"line":38,"column":13},"end":{"line":38,"column":14}},"loc":{"start":{"line":38,"column":19},"end":{"line":38,"column":101}},"line":38},"7":{"name":"(anonymous_7)","decl":{"start":{"line":39,"column":16},"end":{"line":39,"column":17}},"loc":{"start":{"line":39,"column":22},"end":{"line":39,"column":44}},"line":39},"8":{"name":"(anonymous_8)","decl":{"start":{"line":50,"column":51},"end":{"line":50,"column":52}},"loc":{"start":{"line":50,"column":56},"end":{"line":50,"column":76}},"line":50}},"branchMap":{"0":{"loc":{"start":{"line":2,"column":22},"end":{"line":4,"column":1}},"type":"binary-expr","locations":[{"start":{"line":2,"column":23},"end":{"line":2,"column":27}},{"start":{"line":2,"column":31},"end":{"line":2,"column":51}},{"start":{"line":2,"column":56},"end":{"line":4,"column":1}}],"line":2},"1":{"loc":{"start":{"line":3,"column":11},"end":{"line":3,"column":61}},"type":"cond-expr","locations":[{"start":{"line":3,"column":37},"end":{"line":3,"column":40}},{"start":{"line":3,"column":43},"end":{"line":3,"column":61}}],"line":3},"2":{"loc":{"start":{"line":3,"column":12},"end":{"line":3,"column":33}},"type":"binary-expr","locations":[{"start":{"line":3,"column":12},"end":{"line":3,"column":15}},{"start":{"line":3,"column":19},"end":{"line":3,"column":33}}],"line":3},"3":{"loc":{"start":{"line":22,"column":4},"end":{"line":24,"column":5}},"type":"if","locations":[{"start":{"line":22,"column":4},"end":{"line":24,"column":5}},{"start":{"line":22,"column":4},"end":{"line":24,"column":5}}],"line":22},"4":{"loc":{"start":{"line":25,"column":4},"end":{"line":32,"column":5}},"type":"if","locations":[{"start":{"line":25,"column":4},"end":{"line":32,"column":5}},{"start":{"line":25,"column":4},"end":{"line":32,"column":5}}],"line":25},"5":{"loc":{"start":{"line":28,"column":12},"end":{"line":29,"column":37}},"type":"if","locations":[{"start":{"line":28,"column":12},"end":{"line":29,"column":37}},{"start":{"line":28,"column":12},"end":{"line":29,"column":37}}],"line":28},"6":{"loc":{"start":{"line":38,"column":19},"end":{"line":38,"column":101}},"type":"cond-expr","locations":[{"start":{"line":38,"column":44},"end":{"line":38,"column":46}},{"start":{"line":38,"column":49},"end":{"line":38,"column":101}}],"line":38},"7":{"loc":{"start":{"line":42,"column":28},"end":{"line":44,"column":48}},"type":"cond-expr","locations":[{"start":{"line":43,"column":10},"end":{"line":43,"column":36}},{"start":{"line":44,"column":10},"end":{"line":44,"column":48}}],"line":42},"8":{"loc":{"start":{"line":42,"column":28},"end":{"line":42,"column":69}},"type":"binary-expr","locations":[{"start":{"line":42,"column":28},"end":{"line":42,"column":53}},{"start":{"line":42,"column":57},"end":{"line":42,"column":69}}],"line":42},"9":{"loc":{"start":{"line":51,"column":25},"end":{"line":51,"column":63}},"type":"cond-expr","locations":[{"start":{"line":51,"column":51},"end":{"line":51,"column":55}},{"start":{"line":51,"column":58},"end":{"line":51,"column":63}}],"line":51}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":1},"f":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/api-parts/localRecords.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/api-parts/localRecords.ts"],"names":[],"mappings":"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","sourcesContent":["import { Model, Record, IPrimaryKey } from \"firemodel\";\nimport {\n  IAbcOptions,\n  IAbcDiscreteRequest,\n  AbcRequestCommand,\n  IDiscreteLocalResults,\n  IDiscreteOptions\n} from \"../../../types\";\nimport { AbcApi } from \"../AbcApi\";\nimport { getStore } from \"../../../index\";\nimport get from \"lodash.get\";\n\n/**\n * For a discrete set of primary keys, get's all knowledge of these locally. This means\n * at least Vuex but also IndexedDB if the model is configured for it.\n *\n * It returns both\n * a complete list of the primary keys found, those still missing, as well as the records\n * themselves (where Vuex representation of a record trumps the IndexedDB representation)\n */\nexport async function localRecords<T extends Model>(\n  command: AbcRequestCommand,\n  requestPks: IPrimaryKey<T>[],\n  options: IDiscreteOptions<T>,\n  context: AbcApi<T>\n): Promise<Omit<IDiscreteLocalResults<T>, \"overallCachePerformance\">> {\n  const idxRecords: T[] = [];\n  const store = getStore();\n\n  const vuexRecords: T[] = get(\n    store.state,\n    context.vuex.fullPath.replace(/\\//g, \".\"),\n    []\n  );\n\n  if (!AbcApi.indexedDbConnected) {\n    await AbcApi.connectIndexedDb();\n  }\n\n  if (context.config.useIndexedDb) {\n    const waitFor: any[] = [];\n    requestPks.forEach(id =>\n      waitFor.push(\n        context.dexieRecord.get(id).then(rec => {\n          if (rec) idxRecords.push(rec);\n        })\n      )\n    );\n    await Promise.all(waitFor);\n  }\n  const model = context.model.constructor;\n  const vuexPks = vuexRecords.map(v => Record.compositeKeyRef(model, v));\n  const idxPks = idxRecords.map(i => Record.compositeKeyRef(model, i));\n\n  const localIds = Array.from(\n    new Set<string>([...vuexPks, ...idxPks])\n  );\n\n  const missingIds = requestPks\n    .map(pk =>\n      typeof pk === \"string\" ? pk : Record.create(model, pk).compositeKeyRef\n    )\n    .filter(pk => !localIds.includes(pk));\n\n  const modulePostfix = context.about.modelMeta.localPostfix as string;\n  const moduleIsList = context.about.config.isList as boolean;\n  const vuexModuleName = (context.config.moduleName || moduleIsList\n    ? context.about.model.plural\n    : context.about.modelMeta.localModelName) as string;\n\n  return {\n    cacheHits: localIds.length,\n    cacheMisses: missingIds.length,\n    foundInIndexedDb: idxPks,\n    foundInVuex: vuexPks,\n    foundExclusivelyInIndexedDb: idxPks.filter(i => !vuexPks.includes(i)),\n    allFoundLocally: missingIds.length === 0 ? true : false,\n    records: [...idxRecords, ...vuexRecords],\n    missing: missingIds,\n    apiCommand: command,\n    modelConfig: context.config\n  };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"862ef894687602b4071e4d11ab82df3c04699579","contentHash":"09b1337e033e02bec4b1ac1ec38e2d008e22e2bf4f04fd63b6b10e51daa057c2"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/AbcResult.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/AbcResult.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":28},"end":{"line":3,"column":56}},"2":{"start":{"line":4,"column":17},"end":{"line":4,"column":40}},"3":{"start":{"line":13,"column":8},"end":{"line":13,"column":33}},"4":{"start":{"line":14,"column":8},"end":{"line":14,"column":33}},"5":{"start":{"line":20,"column":8},"end":{"line":29,"column":9}},"6":{"start":{"line":21,"column":12},"end":{"line":23,"column":36}},"7":{"start":{"line":26,"column":26},"end":{"line":26,"column":76}},"8":{"start":{"line":27,"column":27},"end":{"line":27,"column":78}},"9":{"start":{"line":28,"column":12},"end":{"line":28,"column":100}},"10":{"start":{"line":35,"column":8},"end":{"line":35,"column":49}},"11":{"start":{"line":41,"column":8},"end":{"line":41,"column":72}},"12":{"start":{"line":44,"column":8},"end":{"line":44,"column":46}},"13":{"start":{"line":47,"column":8},"end":{"line":47,"column":34}},"14":{"start":{"line":53,"column":8},"end":{"line":53,"column":37}},"15":{"start":{"line":57,"column":8},"end":{"line":59,"column":9}},"16":{"start":{"line":58,"column":12},"end":{"line":58,"column":147}},"17":{"start":{"line":60,"column":8},"end":{"line":60,"column":39}},"18":{"start":{"line":73,"column":0},"end":{"line":73,"column":30}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":4},"end":{"line":12,"column":5}},"loc":{"start":{"line":12,"column":36},"end":{"line":15,"column":5}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":19,"column":4},"end":{"line":19,"column":5}},"loc":{"start":{"line":19,"column":18},"end":{"line":30,"column":5}},"line":19},"2":{"name":"(anonymous_2)","decl":{"start":{"line":34,"column":4},"end":{"line":34,"column":5}},"loc":{"start":{"line":34,"column":23},"end":{"line":36,"column":5}},"line":34},"3":{"name":"(anonymous_3)","decl":{"start":{"line":40,"column":4},"end":{"line":40,"column":5}},"loc":{"start":{"line":40,"column":24},"end":{"line":42,"column":5}},"line":40},"4":{"name":"(anonymous_4)","decl":{"start":{"line":43,"column":4},"end":{"line":43,"column":5}},"loc":{"start":{"line":43,"column":27},"end":{"line":45,"column":5}},"line":43},"5":{"name":"(anonymous_5)","decl":{"start":{"line":46,"column":4},"end":{"line":46,"column":5}},"loc":{"start":{"line":46,"column":15},"end":{"line":48,"column":5}},"line":46},"6":{"name":"(anonymous_6)","decl":{"start":{"line":52,"column":4},"end":{"line":52,"column":5}},"loc":{"start":{"line":52,"column":18},"end":{"line":54,"column":5}},"line":52},"7":{"name":"(anonymous_7)","decl":{"start":{"line":56,"column":4},"end":{"line":56,"column":5}},"loc":{"start":{"line":56,"column":20},"end":{"line":61,"column":5}},"line":56},"8":{"name":"(anonymous_8)","decl":{"start":{"line":69,"column":4},"end":{"line":69,"column":5}},"loc":{"start":{"line":69,"column":14},"end":{"line":71,"column":5}},"line":69}},"branchMap":{"0":{"loc":{"start":{"line":20,"column":8},"end":{"line":29,"column":9}},"type":"if","locations":[{"start":{"line":20,"column":8},"end":{"line":29,"column":9}},{"start":{"line":20,"column":8},"end":{"line":29,"column":9}}],"line":20},"1":{"loc":{"start":{"line":21,"column":19},"end":{"line":23,"column":35}},"type":"cond-expr","locations":[{"start":{"line":22,"column":18},"end":{"line":22,"column":36}},{"start":{"line":23,"column":18},"end":{"line":23,"column":35}}],"line":21},"2":{"loc":{"start":{"line":35,"column":15},"end":{"line":35,"column":48}},"type":"binary-expr","locations":[{"start":{"line":35,"column":15},"end":{"line":35,"column":42}},{"start":{"line":35,"column":46},"end":{"line":35,"column":48}}],"line":35},"3":{"loc":{"start":{"line":41,"column":15},"end":{"line":41,"column":71}},"type":"cond-expr","locations":[{"start":{"line":41,"column":38},"end":{"line":41,"column":66}},{"start":{"line":41,"column":69},"end":{"line":41,"column":71}}],"line":41},"4":{"loc":{"start":{"line":57,"column":8},"end":{"line":59,"column":9}},"type":"if","locations":[{"start":{"line":57,"column":8},"end":{"line":59,"column":9}},{"start":{"line":57,"column":8},"end":{"line":59,"column":9}}],"line":57}},"s":{"0":1,"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/AbcResult.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/AbcResult.ts"],"names":[],"mappings":";;AAGA,yDAA6D;AAC7D,yCAAwC;AAExC;;;;;GAKG;AACH,MAAa,SAAS;IACpB,YAAoB,QAAmB,EAAU,QAAuB;QAApD,aAAQ,GAAR,QAAQ,CAAW;QAAU,aAAQ,GAAR,QAAQ,CAAe;IAAG,CAAC;IAE5E;;OAEG;IACH,IAAI,OAAO;QACT,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,YAAY,EAAE;YAC9B,OAAO,IAAI,CAAC,aAAa,CAAC,MAAM,GAAG,CAAC;gBAClC,CAAC,CAAC,IAAI,CAAC,aAAa;gBACpB,CAAC,CAAC,IAAI,CAAC,YAAY,CAAC;SACvB;aAAM;YACL,MAAM,KAAK,GAAG,+BAAW,CAAC,IAAI,CAAC,YAAY,CAAC,CAAC;YAC7C,MAAM,MAAM,GAAG,+BAAW,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAC/C,OAAO,+BAAW,iCAAM,KAAK,GAAK,MAAM,EAAG,CAAC;SAC7C;IACH,CAAC;IAED;;OAEG;IACH,IAAI,YAAY;QACd,OAAO,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,OAAO,IAAI,EAAE,CAAC;IAC3C,CAAC;IAED;;OAEG;IACH,IAAI,aAAa;QACf,OAAO,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,CAAC,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE,CAAC;IAClE,CAAC;IAED,IAAI,gBAAgB;QAClB,OAAO,IAAI,CAAC,QAAQ,CAAC,gBAAgB,CAAC;IACxC,CAAC;IAED,IAAI,IAAI;QACN,OAAO,IAAI,CAAC,QAAQ,CAAC,IAAI,CAAC;IAC5B,CAAC;IAED;;OAEG;IACH,IAAI,OAAO;QACT,OAAO,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC;IAC/B,CAAC;IAED,2DAA2D;IAC3D,IAAI,SAAS;QACX,IAAI,IAAI,CAAC,QAAQ,CAAC,IAAI,KAAK,OAAO,EAAE;YAClC,MAAM,IAAI,iBAAQ,CAChB,0FAA0F,EAC1F,aAAa,CACd,CAAC;SACH;QAED,OAAO,IAAI,CAAC,QAAQ,CAAC,SAAS,CAAC;IACjC,CAAC;IAED;;;;;;OAMG;IACH,KAAK,CAAC,EAAsB;QAC1B,uCAAuC;IACzC,CAAC;CACF;AArED,8BAqEC","sourcesContent":["import { Model } from \"firemodel\";\nimport { IAbcPostWatcher, IAbcResult } from \"../../types\";\nimport { AbcApi } from \"./AbcApi\";\nimport { arrayToHash, hashToArray } from \"typed-conversions\";\nimport { AbcError } from \"../../errors\";\n\n/**\n * Whenever the `api.get()` or `api.load()` calls return they will\n * respond with this class. The classes goal is to pass back not only\n * the result but also certain meta data and a simple means to conditionally\n * watch certain elements of the returned resultset.\n */\nexport class AbcResult<T extends Model> {\n  constructor(private _context: AbcApi<T>, private _results: IAbcResult<T>) {}\n\n  /**\n   * All of the updated records in Vuex that originated from either IndexedDB or Firebase\n   */\n  get records(): T[] {\n    if (!this.options.mergeRecords) {\n      return this.serverRecords.length > 0\n        ? this.serverRecords\n        : this.localRecords;\n    } else {\n      const local = arrayToHash(this.localRecords);\n      const server = arrayToHash(this.serverRecords);\n      return hashToArray({ ...local, ...server });\n    }\n  }\n\n  /**\n   * All of the updated records in Vuex that originated from IndexedDB\n   */\n  get localRecords(): T[] {\n    return this._results.local.records || [];\n  }\n\n  /**\n   * All of the updated records in Vuex that originated from Firebase\n   */\n  get serverRecords(): T[] {\n    return this._results.server ? this._results.server.records : [];\n  }\n\n  get cachePerformance() {\n    return this._context.cachePerformance;\n  }\n\n  get vuex() {\n    return this._context.vuex;\n  }\n\n  /**\n   * The options passed in for the specific request which led to this result\n   */\n  get options() {\n    return this._results.options;\n  }\n\n  /** the query definition used to arrive at these results */\n  get queryDefn() {\n    if (this._results.type !== \"query\") {\n      throw new AbcError(\n        `The attempt to reference the result's \"queryDefn\" is invalid in non-query based results!`,\n        \"not-allowed\"\n      );\n    }\n\n    return this._results.queryDefn;\n  }\n\n  /**\n   * Runs a callback which filters down the set of results\n   * which should be watched. This list is then filtered down\n   * to just those which do not currently have a watcher on them.\n   *\n   * @param fn the callback function to call\n   */\n  watch(fn: IAbcPostWatcher<T>) {\n    // const watcherIds = fn(this.results);\n  }\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"731525d8bac84ffd02bf0a0f271e760e2c9aa303","contentHash":"e23e3565a5f6a1193feae5feb9e78f27a0e9a3f2508a1bd0f94ef5357dd230a3"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/serverRecords.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/serverRecords.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":20},"end":{"line":3,"column":40}},"2":{"start":{"line":5,"column":20},"end":{"line":5,"column":88}},"3":{"start":{"line":6,"column":22},"end":{"line":6,"column":104}},"4":{"start":{"line":6,"column":39},"end":{"line":6,"column":103}},"5":{"start":{"line":7,"column":20},"end":{"line":7,"column":59}},"6":{"start":{"line":7,"column":36},"end":{"line":7,"column":58}},"7":{"start":{"line":8,"column":4},"end":{"line":16,"column":6}},"8":{"start":{"line":18,"column":0},"end":{"line":18,"column":38}}},"fnMap":{"0":{"name":"serverRecords","decl":{"start":{"line":4,"column":15},"end":{"line":4,"column":28}},"loc":{"start":{"line":4,"column":63},"end":{"line":17,"column":1}},"line":4},"1":{"name":"(anonymous_1)","decl":{"start":{"line":6,"column":34},"end":{"line":6,"column":35}},"loc":{"start":{"line":6,"column":39},"end":{"line":6,"column":103}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":7,"column":31},"end":{"line":7,"column":32}},"loc":{"start":{"line":7,"column":36},"end":{"line":7,"column":58}},"line":7}},"branchMap":{},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":1},"f":{"0":0,"1":0,"2":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/serverRecords.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/serverRecords.ts"],"names":[],"mappings":";;AACA,yCAA+D;AAIxD,KAAK,UAAU,aAAa,CACjC,UAA6B,EAC7B,OAAkB,EAClB,GAAS,EACT,MAAY;IAEZ,MAAM,OAAO,GAAG,CAAC,MAAM,gBAAI,CAAC,GAAG,CAAC,OAAO,CAAC,KAAK,CAAC,WAAW,EAAE,GAAG,GAAG,CAAC,CAAC,CAAC,IAAI,CAAC;IACzE,MAAM,SAAS,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAChC,kBAAM,CAAC,eAAe,CAAC,OAAO,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC,CACrD,CAAC;IACF,MAAM,OAAO,GAAG,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IAExD,OAAO;QACL,GAAG;QACH,MAAM;QACN,OAAO;QACP,OAAO;QAEP,UAAU;QACV,uBAAuB,EAAE,OAAO,CAAC,gBAAgB;QAEjD,WAAW,EAAE,OAAO,CAAC,MAAM;KAC5B,CAAC;AACJ,CAAC;AAvBD,sCAuBC","sourcesContent":["import { AbcApi } from \"../AbcApi\";\nimport { Model, List, FireModel, Record, pk } from \"firemodel\";\nimport { getStore } from \"../../../index\";\nimport { AbcRequestCommand, IDiscreteServerResults } from \"../../../types\";\n\nexport async function serverRecords<T extends Model>(\n  apiCommand: AbcRequestCommand,\n  context: AbcApi<T>,\n  pks: pk[],\n  allPks: pk[]\n): Promise<IDiscreteServerResults<T>> {\n  const records = (await List.ids(context.model.constructor, ...pks)).data;\n  const recordIds = records.map(i =>\n    Record.compositeKeyRef(context.model.constructor, i)\n  );\n  const missing = pks.filter(i => !recordIds.includes(i));\n\n  return {\n    pks,\n    allPks,\n    missing,\n    records,\n\n    apiCommand,\n    overallCachePerformance: context.cachePerformance,\n\n    modelConfig: context.config\n  };\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"00a2d19e2881c08eb2ddf9712fa937bb6c20cca3","contentHash":"7f783aaeb92409898e10f2556342b9db5ca27caceddb59bc17ea3dfcbd0dc762"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/index.ts","statementMap":{"0":{"start":{"line":3,"column":4},"end":{"line":3,"column":71}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"2":{"start":{"line":3,"column":53},"end":{"line":3,"column":71}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":30}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":33}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":36}}},"fnMap":{"0":{"name":"__export","decl":{"start":{"line":2,"column":9},"end":{"line":2,"column":17}},"loc":{"start":{"line":2,"column":21},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"type":"if","locations":[{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},{"start":{"line":3,"column":21},"end":{"line":3,"column":71}}],"line":3}},"s":{"0":3,"1":5,"2":5,"3":1,"4":1,"5":1,"6":1},"f":{"0":3},"b":{"0":[5,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/index.ts"],"names":[],"mappings":";;;;;AAAA,8BAAyB;AACzB,iCAA4B;AAC5B,oCAA+B","sourcesContent":["export * from './AbcApi';\nexport * from './AbcResult';\nexport * from './queryHelpers';"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"51294a9b3ea4312e726f9512eaada5f811399beb","contentHash":"e170f808098c0f5aa2dbf47b54dd16cbd22731717050f0d384308b1c05d8b7f9"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/index.ts","statementMap":{"0":{"start":{"line":3,"column":4},"end":{"line":3,"column":71}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"2":{"start":{"line":3,"column":53},"end":{"line":3,"column":71}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":27}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":29}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":29}}},"fnMap":{"0":{"name":"__export","decl":{"start":{"line":2,"column":9},"end":{"line":2,"column":17}},"loc":{"start":{"line":2,"column":21},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"type":"if","locations":[{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},{"start":{"line":3,"column":21},"end":{"line":3,"column":71}}],"line":3}},"s":{"0":3,"1":3,"2":3,"3":1,"4":1,"5":1,"6":1},"f":{"0":3},"b":{"0":[3,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/index.ts"],"names":[],"mappings":";;;;;AAAA,2BAAsB;AACtB,6BAAwB;AACxB,6BAAwB","sourcesContent":["export * from './all';\nexport * from './since';\nexport * from './where';\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"915aa8291af9a9b1d3b264ee1ad645f5ce3ed069","contentHash":"49c0c82d8ac511ad97b81dc8baaa0770fa3fbce9e231283553223a5b66ced222"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/all.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/all.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":16},"end":{"line":3,"column":41}},"2":{"start":{"line":4,"column":20},"end":{"line":4,"column":40}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":37}},"4":{"start":{"line":6,"column":10},"end":{"line":21,"column":1}},"5":{"start":{"line":7,"column":4},"end":{"line":20,"column":6}},"6":{"start":{"line":8,"column":8},"end":{"line":8,"column":92}},"7":{"start":{"line":10,"column":27},"end":{"line":13,"column":9}},"8":{"start":{"line":11,"column":25},"end":{"line":11,"column":50}},"9":{"start":{"line":12,"column":12},"end":{"line":12,"column":24}},"10":{"start":{"line":15,"column":31},"end":{"line":18,"column":9}},"11":{"start":{"line":16,"column":25},"end":{"line":16,"column":74}},"12":{"start":{"line":17,"column":12},"end":{"line":17,"column":29}},"13":{"start":{"line":19,"column":8},"end":{"line":19,"column":98}},"14":{"start":{"line":22,"column":0},"end":{"line":22,"column":18}},"15":{"start":{"line":23,"column":0},"end":{"line":23,"column":35}}},"fnMap":{"0":{"name":"all","decl":{"start":{"line":6,"column":19},"end":{"line":6,"column":22}},"loc":{"start":{"line":6,"column":48},"end":{"line":21,"column":1}},"line":6},"1":{"name":"(anonymous_1)","decl":{"start":{"line":7,"column":11},"end":{"line":7,"column":12}},"loc":{"start":{"line":7,"column":35},"end":{"line":20,"column":5}},"line":7},"2":{"name":"(anonymous_2)","decl":{"start":{"line":10,"column":27},"end":{"line":10,"column":28}},"loc":{"start":{"line":10,"column":39},"end":{"line":13,"column":9}},"line":10},"3":{"name":"(anonymous_3)","decl":{"start":{"line":15,"column":31},"end":{"line":15,"column":32}},"loc":{"start":{"line":15,"column":43},"end":{"line":18,"column":9}},"line":15}},"branchMap":{"0":{"loc":{"start":{"line":6,"column":23},"end":{"line":6,"column":32}},"type":"default-arg","locations":[{"start":{"line":6,"column":30},"end":{"line":6,"column":32}}],"line":6},"1":{"loc":{"start":{"line":6,"column":34},"end":{"line":6,"column":46}},"type":"default-arg","locations":[{"start":{"line":6,"column":44},"end":{"line":6,"column":46}}],"line":6}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":1},"f":{"0":0,"1":0,"2":0,"3":0},"b":{"0":[0],"1":[0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/all.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/all.ts"],"names":[],"mappings":";;AAAA,0CAOwB;AAIxB,yCAAuD;AAGvD,sCAA6C;AAE7C,IAAI,GAAG,GAAG,SAAS,GAAG,CACpB,OAEgC,EAAE,EAClC,UAA4B,EAAE;IAE9B,OAAO,KAAK,EACV,OAA0B,EAC1B,GAAc,EACS,EAAE;QACzB,IAAI,mCAAQ,IAAI,KAAE,SAAS,EAAE,iBAAS,CAAC,GAAG,GAAE,CAAC;QAC7C,iCAAiC;QACjC,MAAM,UAAU,GAAG,KAAK,IAAI,EAAE;YAC5B,MAAM,IAAI,GAAG,MAAM,GAAG,CAAC,SAAS,CAAC,GAAG,EAAE,CAAC;YACvC,OAAO,IAAI,CAAC;QACd,CAAC,CAAC;QAEF,gCAAgC;QAChC,MAAM,cAAc,GAAG,KAAK,IAAI,EAAE;YAChC,MAAM,IAAI,GAAG,MAAM,gBAAI,CAAC,GAAG,CAAC,GAAG,CAAC,KAAK,CAAC,WAAW,CAAC,CAAC;YACnD,OAAO,IAAI,CAAC,IAAI,CAAC;QACnB,CAAC,CAAC;QAEF,OAAO,yBAAgB,CACrB,IAAI,EACJ,OAAO,EACP,UAAU,EACV,cAAc,EACd,GAAG,EACH,OAAO,CACR,CAAC;IACJ,CAAC,CAAC;AACJ,CAAC,CAAC;AAIO,kBAAG;AAFZ,GAAG,CAAC,SAAS,CAAC,aAAa,GAAG,IAAI,CAAC","sourcesContent":["import {\n  IAbcAllQueryDefinition,\n  AbcRequestCommand,\n  AbcMutation,\n  IQueryLocalResults,\n  IQueryServerResults,\n  QueryType\n} from \"../../../types\";\nimport { AbcApi } from \"../AbcApi\";\nimport { getStore, AbcResult, IQueryOptions } from \"../../..\";\nimport get = require(\"lodash.get\");\nimport { Record, List, IListOptions } from \"firemodel\";\nimport { deepEqual } from \"fast-equals\";\nimport { findPk } from \"../shared/findPk\";\nimport { generalizedQuery } from \"../shared\";\n\nlet all = function all<T>(\n  defn:\n    | Omit<IAbcAllQueryDefinition<T>, \"queryType\">\n    | IAbcAllQueryDefinition<T> = {},\n  options: IQueryOptions<T> = {}\n) {\n  return async (\n    command: AbcRequestCommand,\n    ctx: AbcApi<T>\n  ): Promise<AbcResult<T>> => {\n    defn = { ...defn, queryType: QueryType.all };\n    // The query to use for IndexedDB\n    const dexieQuery = async () => {\n      const recs = await ctx.dexieList.all();\n      return recs;\n    };\n\n    // The query to use for Firebase\n    const firemodelQuery = async () => {\n      const list = await List.all(ctx.model.constructor);\n      return list.data;\n    };\n\n    return generalizedQuery(\n      defn,\n      command,\n      dexieQuery,\n      firemodelQuery,\n      ctx,\n      options\n    );\n  };\n};\n\nall.prototype.isQueryHelper = true;\n\nexport { all };\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"56680717b950a5af4bcbcf92b58db8f3f8bc2b94","contentHash":"cd31d36b01a59fbb468247addcc5d86f85a31d32bd87ca9c7f2d26a6cda1057a"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/index.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/index.ts","statementMap":{"0":{"start":{"line":3,"column":4},"end":{"line":3,"column":71}},"1":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"2":{"start":{"line":3,"column":53},"end":{"line":3,"column":71}},"3":{"start":{"line":5,"column":0},"end":{"line":5,"column":62}},"4":{"start":{"line":6,"column":0},"end":{"line":6,"column":37}},"5":{"start":{"line":7,"column":0},"end":{"line":7,"column":30}},"6":{"start":{"line":8,"column":0},"end":{"line":8,"column":40}}},"fnMap":{"0":{"name":"__export","decl":{"start":{"line":2,"column":9},"end":{"line":2,"column":17}},"loc":{"start":{"line":2,"column":21},"end":{"line":4,"column":1}},"line":2}},"branchMap":{"0":{"loc":{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},"type":"if","locations":[{"start":{"line":3,"column":21},"end":{"line":3,"column":71}},{"start":{"line":3,"column":21},"end":{"line":3,"column":71}}],"line":3}},"s":{"0":3,"1":3,"2":3,"3":1,"4":1,"5":1,"6":1},"f":{"0":3},"b":{"0":[3,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/index.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/index.ts"],"names":[],"mappings":";;;;;AAAA,qCAAgC;AAChC,8BAAyB;AACzB,wCAAmC","sourcesContent":["export * from \"./serverRecords\";\nexport * from \"./findPk\";\nexport * from \"./generalizedQuery\";\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"6fd82cd86bb03458470e5e7b72676319ab5d509c","contentHash":"6410d6d680d62f7ad19aaf45c5163845a74ca5a2614821a07f61ac31f5afeaa6"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/findPk.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/findPk.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":17},"end":{"line":3,"column":43}},"2":{"start":{"line":12,"column":30},"end":{"line":12,"column":44}},"3":{"start":{"line":13,"column":16},"end":{"line":13,"column":48}},"4":{"start":{"line":13,"column":36},"end":{"line":13,"column":47}},"5":{"start":{"line":14,"column":4},"end":{"line":17,"column":7}},"6":{"start":{"line":15,"column":23},"end":{"line":15,"column":36}},"7":{"start":{"line":16,"column":8},"end":{"line":16,"column":46}},"8":{"start":{"line":16,"column":34},"end":{"line":16,"column":44}},"9":{"start":{"line":18,"column":4},"end":{"line":20,"column":5}},"10":{"start":{"line":19,"column":8},"end":{"line":19,"column":142}},"11":{"start":{"line":21,"column":4},"end":{"line":21,"column":49}},"12":{"start":{"line":23,"column":0},"end":{"line":23,"column":24}}},"fnMap":{"0":{"name":"findPk","decl":{"start":{"line":11,"column":9},"end":{"line":11,"column":15}},"loc":{"start":{"line":11,"column":29},"end":{"line":22,"column":1}},"line":11},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":31},"end":{"line":13,"column":32}},"loc":{"start":{"line":13,"column":36},"end":{"line":13,"column":47}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":14,"column":21},"end":{"line":14,"column":22}},"loc":{"start":{"line":14,"column":27},"end":{"line":17,"column":5}},"line":14},"3":{"name":"(anonymous_3)","decl":{"start":{"line":16,"column":29},"end":{"line":16,"column":30}},"loc":{"start":{"line":16,"column":34},"end":{"line":16,"column":44}},"line":16}},"branchMap":{"0":{"loc":{"start":{"line":18,"column":4},"end":{"line":20,"column":5}},"type":"if","locations":[{"start":{"line":18,"column":4},"end":{"line":20,"column":5}},{"start":{"line":18,"column":4},"end":{"line":20,"column":5}}],"line":18},"1":{"loc":{"start":{"line":21,"column":11},"end":{"line":21,"column":48}},"type":"cond-expr","locations":[{"start":{"line":21,"column":32},"end":{"line":21,"column":40}},{"start":{"line":21,"column":43},"end":{"line":21,"column":48}}],"line":21}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1},"f":{"0":0,"1":0,"2":0,"3":0},"b":{"0":[0,0],"1":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/findPk.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/findPk.ts"],"names":[],"mappings":";;AACA,4CAA2C;AAG3C;;;;;;GAMG;AACH,SAAgB,MAAM,CACpB,EAAU,EACV,OAAY;IAEZ,MAAM,CAAC,EAAE,EAAE,GAAG,QAAQ,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;IACzC,IAAI,KAAK,GAAG,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,EAAE,KAAK,EAAE,CAAC,CAAC;IAE7C,QAAQ,CAAC,OAAO,CAAC,EAAE,CAAC,EAAE;QACpB,MAAM,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;QAC7B,KAAK,GAAG,KAAK,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;IACxC,CAAC,CAAC,CAAC;IAEH,IAAI,KAAK,CAAC,MAAM,GAAG,CAAC,EAAE;QACpB,MAAM,IAAI,iBAAQ,CAChB,oCAAoC,EAAE,mDAAmD,EACzF,aAAa,CACd,CAAC;KACH;IAED,OAAO,KAAK,CAAC,MAAM,KAAK,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC,KAAK,CAAC;AAC/C,CAAC;AApBD,wBAoBC","sourcesContent":["import { Model } from \"firemodel\";\nimport { AbcError } from \"../../../errors\";\nimport { IDictionary } from \"firemock\";\n\n/**\n * Given a Primary Key _reference_ string; this function will find the record\n * which matches the primary key.\n *\n * If no record is found then `false` is returned. If _more_ than one result is\n * found than an error is thrown.\n */\nexport function findPk<T extends IDictionary>(\n  pk: string,\n  records: T[]\n): T | false {\n  const [id, ...keyValue] = pk.split(\"::\");\n  let found = records.filter(i => i.id === id);\n\n  keyValue.forEach(kv => {\n    const [k, v] = kv.split(\":\");\n    found = found.filter(i => i[k] === v);\n  });\n\n  if (found.length > 1) {\n    throw new AbcError(\n      `Attempt to find the primary key \"${pk}\" resulted in more than one record being matched!`,\n      \"not-allowed\"\n    );\n  }\n\n  return found.length === 1 ? found[0] : false;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"2dd8cdc2a7261b10aacab9a192a688e98dfa115d","contentHash":"8332ff3bb5cb5fe31a5d7c81bfa9c8351ea6a8984e0895ec733976b169e0d685"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/generalizedQuery.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/generalizedQuery.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":16},"end":{"line":3,"column":41}},"2":{"start":{"line":4,"column":12},"end":{"line":4,"column":31}},"3":{"start":{"line":5,"column":12},"end":{"line":5,"column":33}},"4":{"start":{"line":6,"column":20},"end":{"line":6,"column":40}},"5":{"start":{"line":7,"column":22},"end":{"line":7,"column":44}},"6":{"start":{"line":8,"column":17},"end":{"line":8,"column":44}},"7":{"start":{"line":14,"column":18},"end":{"line":14,"column":32}},"8":{"start":{"line":15,"column":24},"end":{"line":15,"column":83}},"9":{"start":{"line":16,"column":20},"end":{"line":16,"column":102}},"10":{"start":{"line":16,"column":41},"end":{"line":16,"column":101}},"11":{"start":{"line":17,"column":21},"end":{"line":17,"column":23}},"12":{"start":{"line":19,"column":4},"end":{"line":49,"column":5}},"13":{"start":{"line":21,"column":8},"end":{"line":21,"column":40}},"14":{"start":{"line":22,"column":29},"end":{"line":22,"column":110}},"15":{"start":{"line":22,"column":49},"end":{"line":22,"column":109}},"16":{"start":{"line":23,"column":8},"end":{"line":28,"column":10}},"17":{"start":{"line":29,"column":29},"end":{"line":34,"column":10}},"18":{"start":{"line":35,"column":8},"end":{"line":40,"column":9}},"19":{"start":{"line":36,"column":12},"end":{"line":36,"column":112}},"20":{"start":{"line":39,"column":12},"end":{"line":39,"column":110}},"21":{"start":{"line":43,"column":8},"end":{"line":48,"column":10}},"22":{"start":{"line":50,"column":26},"end":{"line":50,"column":48}},"23":{"start":{"line":51,"column":22},"end":{"line":51,"column":106}},"24":{"start":{"line":51,"column":45},"end":{"line":51,"column":105}},"25":{"start":{"line":52,"column":19},"end":{"line":52,"column":69}},"26":{"start":{"line":52,"column":41},"end":{"line":52,"column":68}},"27":{"start":{"line":53,"column":22},"end":{"line":53,"column":24}},"28":{"start":{"line":54,"column":21},"end":{"line":54,"column":23}},"29":{"start":{"line":55,"column":4},"end":{"line":66,"column":7}},"30":{"start":{"line":56,"column":19},"end":{"line":56,"column":81}},"31":{"start":{"line":57,"column":8},"end":{"line":65,"column":9}},"32":{"start":{"line":58,"column":29},"end":{"line":58,"column":63}},"33":{"start":{"line":59,"column":12},"end":{"line":64,"column":13}},"34":{"start":{"line":60,"column":16},"end":{"line":60,"column":35}},"35":{"start":{"line":63,"column":16},"end":{"line":63,"column":34}},"36":{"start":{"line":67,"column":4},"end":{"line":67,"column":77}},"37":{"start":{"line":68,"column":4},"end":{"line":69,"column":70}},"38":{"start":{"line":71,"column":26},"end":{"line":71,"column":80}},"39":{"start":{"line":71,"column":57},"end":{"line":71,"column":79}},"40":{"start":{"line":72,"column":27},"end":{"line":72,"column":76}},"41":{"start":{"line":72,"column":53},"end":{"line":72,"column":75}},"42":{"start":{"line":73,"column":4},"end":{"line":73,"column":51}},"43":{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},"44":{"start":{"line":75,"column":8},"end":{"line":75,"column":140}},"45":{"start":{"line":77,"column":4},"end":{"line":83,"column":5}},"46":{"start":{"line":78,"column":8},"end":{"line":82,"column":11}},"47":{"start":{"line":81,"column":12},"end":{"line":81,"column":142}},"48":{"start":{"line":84,"column":19},"end":{"line":93,"column":5}},"49":{"start":{"line":94,"column":21},"end":{"line":100,"column":6}},"50":{"start":{"line":101,"column":4},"end":{"line":101,"column":104}},"51":{"start":{"line":102,"column":4},"end":{"line":102,"column":20}},"52":{"start":{"line":104,"column":0},"end":{"line":104,"column":44}}},"fnMap":{"0":{"name":"generalizedQuery","decl":{"start":{"line":13,"column":15},"end":{"line":13,"column":31}},"loc":{"start":{"line":13,"column":94},"end":{"line":103,"column":1}},"line":13},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":36},"end":{"line":16,"column":37}},"loc":{"start":{"line":16,"column":41},"end":{"line":16,"column":101}},"line":16},"2":{"name":"(anonymous_2)","decl":{"start":{"line":22,"column":44},"end":{"line":22,"column":45}},"loc":{"start":{"line":22,"column":49},"end":{"line":22,"column":109}},"line":22},"3":{"name":"(anonymous_3)","decl":{"start":{"line":51,"column":40},"end":{"line":51,"column":41}},"loc":{"start":{"line":51,"column":45},"end":{"line":51,"column":105}},"line":51},"4":{"name":"(anonymous_4)","decl":{"start":{"line":52,"column":36},"end":{"line":52,"column":37}},"loc":{"start":{"line":52,"column":41},"end":{"line":52,"column":68}},"line":52},"5":{"name":"(anonymous_5)","decl":{"start":{"line":55,"column":26},"end":{"line":55,"column":27}},"loc":{"start":{"line":55,"column":33},"end":{"line":66,"column":5}},"line":55},"6":{"name":"(anonymous_6)","decl":{"start":{"line":71,"column":52},"end":{"line":71,"column":53}},"loc":{"start":{"line":71,"column":57},"end":{"line":71,"column":79}},"line":71},"7":{"name":"(anonymous_7)","decl":{"start":{"line":72,"column":48},"end":{"line":72,"column":49}},"loc":{"start":{"line":72,"column":53},"end":{"line":72,"column":75}},"line":72},"8":{"name":"(anonymous_8)","decl":{"start":{"line":78,"column":49},"end":{"line":78,"column":50}},"loc":{"start":{"line":78,"column":55},"end":{"line":82,"column":9}},"line":78}},"branchMap":{"0":{"loc":{"start":{"line":19,"column":4},"end":{"line":49,"column":5}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":49,"column":5}},{"start":{"line":19,"column":4},"end":{"line":49,"column":5}}],"line":19},"1":{"loc":{"start":{"line":19,"column":8},"end":{"line":19,"column":52}},"type":"binary-expr","locations":[{"start":{"line":19,"column":8},"end":{"line":19,"column":25}},{"start":{"line":19,"column":29},"end":{"line":19,"column":52}}],"line":19},"2":{"loc":{"start":{"line":35,"column":8},"end":{"line":40,"column":9}},"type":"if","locations":[{"start":{"line":35,"column":8},"end":{"line":40,"column":9}},{"start":{"line":35,"column":8},"end":{"line":40,"column":9}}],"line":35},"3":{"loc":{"start":{"line":57,"column":8},"end":{"line":65,"column":9}},"type":"if","locations":[{"start":{"line":57,"column":8},"end":{"line":65,"column":9}},{"start":{"line":57,"column":8},"end":{"line":65,"column":9}}],"line":57},"4":{"loc":{"start":{"line":59,"column":12},"end":{"line":64,"column":13}},"type":"if","locations":[{"start":{"line":59,"column":12},"end":{"line":64,"column":13}},{"start":{"line":59,"column":12},"end":{"line":64,"column":13}}],"line":59},"5":{"loc":{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},"type":"if","locations":[{"start":{"line":74,"column":4},"end":{"line":76,"column":5}},{"start":{"line":74,"column":4},"end":{"line":76,"column":5}}],"line":74},"6":{"loc":{"start":{"line":77,"column":4},"end":{"line":83,"column":5}},"type":"if","locations":[{"start":{"line":77,"column":4},"end":{"line":83,"column":5}},{"start":{"line":77,"column":4},"end":{"line":83,"column":5}}],"line":77}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":1},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/generalizedQuery.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/shared/generalizedQuery.ts"],"names":[],"mappings":";;AAAA,0CASwB;AAExB,gCAA8D;AAC9D,kCAAmC;AACnC,yCAAuD;AACvD,6CAAwC;AACxC,6CAA0C;AAO1C;;;GAGG;AACI,KAAK,UAAU,gBAAgB,CACpC,SAAiC,EACjC,OAA0B,EAC1B,UAAgC,EAChC,cAAoC,EACpC,GAAc,EACd,OAAuB;IAEvB,MAAM,KAAK,GAAG,YAAQ,EAAE,CAAC;IACzB,MAAM,WAAW,GAAG,GAAG,CACrB,KAAK,CAAC,KAAK,EACX,GAAG,CAAC,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,KAAK,EAAE,GAAG,CAAC,EACrC,EAAE,CACH,CAAC;IACF,MAAM,OAAO,GAAG,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CAClC,kBAAM,CAAC,eAAe,CAAC,GAAG,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC,CACjD,CAAC;IAEF,IAAI,UAAU,GAAQ,EAAE,CAAC;IACzB,IAAI,KAAiC,CAAC;IAEtC,IAAI,OAAO,KAAK,KAAK,IAAI,GAAG,CAAC,MAAM,CAAC,YAAY,EAAE;QAChD,0CAA0C;QAC1C,UAAU,GAAG,MAAM,UAAU,EAAE,CAAC;QAEhC,MAAM,YAAY,GAAG,UAAU,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CACtC,kBAAM,CAAC,eAAe,CAAC,GAAG,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC,CACjD,CAAC;QACF,KAAK,GAAG;YACN,OAAO,EAAE,UAAU;YACnB,OAAO;YACP,YAAY;YACZ,QAAQ,EAAE,KAAK,CAAC,IAAI,CAAC,IAAI,GAAG,CAAC,OAAO,CAAC,MAAM,CAAC,GAAG,YAAY,CAAC,CAAC,CAAC;SAC/D,CAAC;QACF,MAAM,YAAY,GAAG,IAAI,aAAS,CAAC,GAAG,EAAE;YACtC,IAAI,EAAE,OAAO;YACb,SAAS;YACT,KAAK;YACL,OAAO;SACR,CAAC,CAAC;QAEH,IAAI,UAAU,CAAC,MAAM,GAAG,CAAC,EAAE;YACzB,KAAK,CAAC,MAAM,CACV,GAAG,GAAG,CAAC,IAAI,CAAC,UAAU,IAAI,mBAAW,CAAC,uBAAuB,EAAE,EAC/D,YAAY,CACb,CAAC;SACH;aAAM;YACL,KAAK,CAAC,MAAM,CACV,GAAG,GAAG,CAAC,IAAI,CAAC,UAAU,IAAI,mBAAW,CAAC,qBAAqB,EAAE,EAC7D,YAAY,CACb,CAAC;SACH;KACF;SAAM;QACL,KAAK,GAAG;YACN,OAAO,EAAE,WAAW;YACpB,OAAO;YACP,YAAY,EAAE,EAAE;YAChB,QAAQ,EAAE,OAAO;SACO,CAAC;KAC5B;IAED,MAAM,aAAa,GAAG,MAAM,cAAc,EAAE,CAAC;IAC7C,MAAM,SAAS,GAAG,aAAa,CAAC,GAAG,CAAC,CAAC,CAAC,EAAE,CACtC,kBAAM,CAAC,eAAe,CAAC,GAAG,CAAC,KAAK,CAAC,WAAW,EAAE,CAAC,CAAC,CACjD,CAAC;IACF,MAAM,MAAM,GAAG,SAAS,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,KAAK,CAAC,QAAQ,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IAClE,MAAM,SAAS,GAAa,EAAE,CAAC;IAC/B,MAAM,QAAQ,GAAa,EAAE,CAAC;IAC9B,aAAa,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;QAC1B,MAAM,EAAE,GAAG,kBAAM,CAAC,eAAe,CAAC,GAAG,CAAC,KAAK,CAAC,WAAW,EAAE,GAAG,CAAC,CAAC;QAC9D,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,EAAE,CAAC,EAAE;YACxB,MAAM,QAAQ,GAAG,eAAM,CAAC,EAAE,EAAE,KAAK,CAAC,OAAO,CAAC,CAAC;YAC3C,IAAI,uBAAS,CAAC,GAAG,EAAE,QAAQ,CAAC,EAAE;gBAC5B,SAAS,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;aACpB;iBAAM;gBACL,QAAQ,CAAC,IAAI,CAAC,EAAE,CAAC,CAAC;aACnB;SACF;IACH,CAAC,CAAC,CAAC;IAEH,GAAG,CAAC,gBAAgB,CAAC,IAAI,GAAG,GAAG,CAAC,gBAAgB,CAAC,IAAI,GAAG,SAAS,CAAC,MAAM,CAAC;IACzE,GAAG,CAAC,gBAAgB,CAAC,MAAM;QACzB,GAAG,CAAC,gBAAgB,CAAC,MAAM,GAAG,QAAQ,CAAC,MAAM,GAAG,MAAM,CAAC,MAAM,CAAC;IAEhE,QAAQ;IACR,MAAM,aAAa,GAAG,KAAK,CAAC,YAAY,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IAC7E,MAAM,cAAc,GAAG,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC,CAAC,CAAC,CAAC;IACzE,OAAO,CAAC,GAAG,CAAC,EAAE,aAAa,EAAE,cAAc,EAAE,CAAC,CAAC;IAE/C,IAAI,cAAc,CAAC,MAAM,GAAG,CAAC,EAAE;QAC7B,KAAK,CAAC,MAAM,CACV,GAAG,GAAG,CAAC,IAAI,CAAC,UAAU,IAAI,mBAAW,CAAC,4BAA4B,EAAE,EACpE,EAAE,GAAG,EAAE,cAAc,EAAE,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE,CACxC,CAAC;KACH;IACD,IAAI,aAAa,CAAC,MAAM,GAAG,CAAC,EAAE;QAC5B,GAAG,CAAC,UAAU,CAAC,UAAU,CAAC,QAAQ,CAAC,CAAC,IAAI,CAAC,GAAG,EAAE;YAC5C,iFAAiF;YACjF,+DAA+D;YAC/D,KAAK,CAAC,MAAM,CACV,GAAG,GAAG,CAAC,IAAI,CAAC,UAAU,IAAI,mBAAW,CAAC,2BAA2B,EAAE,EACnE,EAAE,GAAG,EAAE,aAAa,EAAE,IAAI,EAAE,GAAG,CAAC,IAAI,EAAE,CACvC,CAAC;QACJ,CAAC,CAAC,CAAC;KACJ;IAED,MAAM,MAAM,GAA2B;QACrC,OAAO,EAAE,aAAa;QACtB,SAAS;QACT,MAAM;QACN,SAAS;QACT,QAAQ;QACR,aAAa;QACb,cAAc;QACd,uBAAuB,EAAE,GAAG,CAAC,gBAAgB;KAC9C,CAAC;IAEF,MAAM,QAAQ,GAAG,IAAI,aAAS,CAAC,GAAG,EAAE;QAClC,IAAI,EAAE,OAAO;QACb,SAAS;QACT,KAAK;QACL,MAAM;QACN,OAAO;KACR,CAAC,CAAC;IAEH,KAAK,CAAC,MAAM,CACV,GAAG,GAAG,CAAC,IAAI,CAAC,UAAU,IAAI,mBAAW,CAAC,2BAA2B,EAAE,EACnE,QAAQ,CACT,CAAC;IAEF,OAAO,QAAQ,CAAC;AAClB,CAAC;AAnID,4CAmIC","sourcesContent":["import {\n  IAbcAllQueryDefinition,\n  AbcRequestCommand,\n  AbcMutation,\n  IQueryLocalResults,\n  IQueryServerResults,\n  QueryType,\n  IAbcQueryDefinition,\n  IAbcOptions\n} from \"../../../types\";\nimport { AbcApi } from \"../AbcApi\";\nimport { getStore, AbcResult, IQueryOptions } from \"../../..\";\nimport get = require(\"lodash.get\");\nimport { Record, List, IListOptions } from \"firemodel\";\nimport { deepEqual } from \"fast-equals\";\nimport { findPk } from \"../shared/findPk\";\nimport { localRecords } from \"../api-parts/localRecords\";\n\nexport interface IGeneralizedQuery<T> {\n  (): Promise<T[]>;\n}\n\n/**\n * A generalized flow for queries; specific query helpers\n * should use this flow to standarize their approach.\n */\nexport async function generalizedQuery<T>(\n  queryDefn: IAbcQueryDefinition<T>,\n  command: AbcRequestCommand,\n  dexieQuery: IGeneralizedQuery<T>,\n  firemodelQuery: IGeneralizedQuery<T>,\n  ctx: AbcApi<T>,\n  options: IAbcOptions<T>\n) {\n  const store = getStore();\n  const vuexRecords = get<T[]>(\n    store.state,\n    ctx.vuex.fullPath.replace(/\\//g, \".\"),\n    []\n  );\n  const vuexPks = vuexRecords.map(v =>\n    Record.compositeKeyRef(ctx.model.constructor, v)\n  );\n\n  let idxRecords: T[] = [];\n  let local: IQueryLocalResults<T, any>;\n\n  if (command === \"get\" && ctx.config.useIndexedDb) {\n    // Populate Vuex with what IndexedDB knows\n    idxRecords = await dexieQuery();\n\n    const indexedDbPks = idxRecords.map(i =>\n      Record.compositeKeyRef(ctx.model.constructor, i)\n    );\n    local = {\n      records: idxRecords,\n      vuexPks,\n      indexedDbPks,\n      localPks: Array.from(new Set(vuexPks.concat(...indexedDbPks)))\n    };\n    const localResults = new AbcResult(ctx, {\n      type: \"query\",\n      queryDefn,\n      local,\n      options\n    });\n\n    if (idxRecords.length > 0) {\n      store.commit(\n        `${ctx.vuex.moduleName}/${AbcMutation.ABC_LOCAL_QUERY_TO_VUEX}`,\n        localResults\n      );\n    } else {\n      store.commit(\n        `${ctx.vuex.moduleName}/${AbcMutation.ABC_LOCAL_QUERY_EMPTY}`,\n        localResults\n      );\n    }\n  } else {\n    local = {\n      records: vuexRecords,\n      vuexPks,\n      indexedDbPks: [],\n      localPks: vuexPks\n    } as IQueryLocalResults<T>;\n  }\n\n  const serverRecords = await firemodelQuery();\n  const serverPks = serverRecords.map(i =>\n    Record.compositeKeyRef(ctx.model.constructor, i)\n  );\n  const newPks = serverPks.filter(i => !local.localPks.includes(i));\n  const cacheHits: string[] = [];\n  const stalePks: string[] = [];\n  serverRecords.forEach(rec => {\n    const pk = Record.compositeKeyRef(ctx.model.constructor, rec);\n    if (!newPks.includes(pk)) {\n      const localRec = findPk(pk, local.records);\n      if (deepEqual(rec, localRec)) {\n        cacheHits.push(pk);\n      } else {\n        stalePks.push(pk);\n      }\n    }\n  });\n\n  ctx.cachePerformance.hits = ctx.cachePerformance.hits + cacheHits.length;\n  ctx.cachePerformance.misses =\n    ctx.cachePerformance.misses + stalePks.length + newPks.length;\n\n  // PRUNE\n  const removeFromIdx = local.indexedDbPks.filter(i => !serverPks.includes(i));\n  const removeFromVuex = local.vuexPks.filter(i => !serverPks.includes(i));\n  console.log({ removeFromIdx, removeFromVuex });\n\n  if (removeFromVuex.length > 0) {\n    store.commit(\n      `${ctx.vuex.moduleName}/${AbcMutation.ABC_PRUNE_STALE_VUEX_RECORDS}`,\n      { pks: removeFromVuex, vuex: ctx.vuex }\n    );\n  }\n  if (removeFromIdx.length > 0) {\n    ctx.dexieTable.bulkDelete(stalePks).then(() => {\n      // NOTE: this is making the async component (which will be short) not part of the\n      // critical path for this query's completion. This is intended.\n      store.commit(\n        `${ctx.vuex.moduleName}/${AbcMutation.ABC_PRUNE_STALE_IDX_RECORDS}`,\n        { pks: removeFromIdx, vuex: ctx.vuex }\n      );\n    });\n  }\n\n  const server: IQueryServerResults<T> = {\n    records: serverRecords,\n    serverPks,\n    newPks,\n    cacheHits,\n    stalePks,\n    removeFromIdx,\n    removeFromVuex,\n    overallCachePerformance: ctx.cachePerformance\n  };\n\n  const response = new AbcResult(ctx, {\n    type: \"query\",\n    queryDefn,\n    local,\n    server,\n    options\n  });\n\n  store.commit(\n    `${ctx.vuex.moduleName}/${AbcMutation.ABC_FIREBASE_TO_VUEX_UPDATE}`,\n    response\n  );\n\n  return response;\n}\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"a827d92ce0fa0ab6f5c22c651adcba47f10f1fd6","contentHash":"2589f9560564954d5c32d6e3e425cfa2f1fdec7463829afa3d240b773992174e"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/since.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/since.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":8,"column":12},"end":{"line":12,"column":1}},"2":{"start":{"line":9,"column":4},"end":{"line":11,"column":6}},"3":{"start":{"line":10,"column":8},"end":{"line":10,"column":43}},"4":{"start":{"line":13,"column":0},"end":{"line":13,"column":22}},"5":{"start":{"line":14,"column":0},"end":{"line":14,"column":37}}},"fnMap":{"0":{"name":"since","decl":{"start":{"line":8,"column":21},"end":{"line":8,"column":26}},"loc":{"start":{"line":8,"column":33},"end":{"line":12,"column":1}},"line":8},"1":{"name":"all","decl":{"start":{"line":9,"column":20},"end":{"line":9,"column":23}},"loc":{"start":{"line":9,"column":30},"end":{"line":11,"column":5}},"line":9},"2":{"name":"(anonymous_2)","decl":{"start":{"line":10,"column":15},"end":{"line":10,"column":16}},"loc":{"start":{"line":10,"column":39},"end":{"line":10,"column":42}},"line":10}},"branchMap":{},"s":{"0":1,"1":1,"2":0,"3":0,"4":1,"5":1},"f":{"0":0,"1":0,"2":0},"b":{},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/since.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/since.ts"],"names":[],"mappings":";;AASA;;;;GAIG;AACH,IAAI,KAAK,GAAG,SAAS,KAAK,CACxB,IAAoD;IAEpD,OAAO,SAAS,GAAG,CAAI,IAAmD;QACxE,OAAO,KAAK,EAAE,OAA0B,EAAE,GAAc,EAAE,EAAE,GAAE,CAAC,CAAC;IAClE,CAAC,CAAC;AACJ,CAAC,CAAC;AAIO,sBAAK;AAFd,KAAK,CAAC,SAAS,CAAC,aAAa,GAAG,IAAI,CAAC","sourcesContent":["import { AbcApi } from \"../AbcApi\";\nimport { IDictionary } from \"common-types\";\nimport { Model } from \"firemodel\";\nimport {\n  AbcRequestCommand,\n  IAbcSinceQueryDefinition,\n  IAbcAllQueryDefinition\n} from \"../../../types\";\n\n/**\n * **since**\n *\n * Gets all records _since_ a certain timestamp (`epoch` with milliseconds)\n */\nlet since = function since<T extends Model = IDictionary>(\n  defn: Omit<IAbcSinceQueryDefinition<T>, \"queryType\">\n) {\n  return function all<T>(defn?: Omit<IAbcAllQueryDefinition<T>, \"queryType\">) {\n    return async (command: AbcRequestCommand, ctx: AbcApi<T>) => {};\n  };\n};\n\nsince.prototype.isQueryHelper = true;\n\nexport { since };\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"9244398caceb69e9231af79cc2c5330a5dfc3c1b","contentHash":"d806049852b98cabd34c9edfabb2cf7750cf156f584d23a0c48c6dd93ed8b5a4"},"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/where.ts":{"path":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/where.ts","statementMap":{"0":{"start":{"line":2,"column":0},"end":{"line":2,"column":62}},"1":{"start":{"line":3,"column":16},"end":{"line":3,"column":41}},"2":{"start":{"line":4,"column":20},"end":{"line":4,"column":40}},"3":{"start":{"line":5,"column":17},"end":{"line":5,"column":37}},"4":{"start":{"line":11,"column":12},"end":{"line":32,"column":1}},"5":{"start":{"line":12,"column":4},"end":{"line":12,"column":90}},"6":{"start":{"line":13,"column":4},"end":{"line":31,"column":6}},"7":{"start":{"line":15,"column":24},"end":{"line":19,"column":38}},"8":{"start":{"line":21,"column":27},"end":{"line":24,"column":9}},"9":{"start":{"line":22,"column":25},"end":{"line":22,"column":74}},"10":{"start":{"line":23,"column":12},"end":{"line":23,"column":24}},"11":{"start":{"line":26,"column":31},"end":{"line":29,"column":9}},"12":{"start":{"line":27,"column":25},"end":{"line":27,"column":100}},"13":{"start":{"line":28,"column":12},"end":{"line":28,"column":29}},"14":{"start":{"line":30,"column":8},"end":{"line":30,"column":98}},"15":{"start":{"line":33,"column":0},"end":{"line":33,"column":22}},"16":{"start":{"line":34,"column":0},"end":{"line":34,"column":37}}},"fnMap":{"0":{"name":"where","decl":{"start":{"line":11,"column":21},"end":{"line":11,"column":26}},"loc":{"start":{"line":11,"column":47},"end":{"line":32,"column":1}},"line":11},"1":{"name":"(anonymous_1)","decl":{"start":{"line":13,"column":11},"end":{"line":13,"column":12}},"loc":{"start":{"line":13,"column":35},"end":{"line":31,"column":5}},"line":13},"2":{"name":"(anonymous_2)","decl":{"start":{"line":21,"column":27},"end":{"line":21,"column":28}},"loc":{"start":{"line":21,"column":39},"end":{"line":24,"column":9}},"line":21},"3":{"name":"(anonymous_3)","decl":{"start":{"line":26,"column":31},"end":{"line":26,"column":32}},"loc":{"start":{"line":26,"column":43},"end":{"line":29,"column":9}},"line":26}},"branchMap":{"0":{"loc":{"start":{"line":11,"column":33},"end":{"line":11,"column":45}},"type":"default-arg","locations":[{"start":{"line":11,"column":43},"end":{"line":11,"column":45}}],"line":11},"1":{"loc":{"start":{"line":15,"column":24},"end":{"line":19,"column":38}},"type":"cond-expr","locations":[{"start":{"line":16,"column":14},"end":{"line":16,"column":25}},{"start":{"line":17,"column":14},"end":{"line":19,"column":38}}],"line":15},"2":{"loc":{"start":{"line":17,"column":14},"end":{"line":19,"column":38}},"type":"cond-expr","locations":[{"start":{"line":18,"column":18},"end":{"line":18,"column":41}},{"start":{"line":19,"column":18},"end":{"line":19,"column":38}}],"line":17}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":1,"16":1},"f":{"0":0,"1":0,"2":0,"3":0},"b":{"0":[0],"1":[0,0],"2":[0,0]},"inputSourceMap":{"version":3,"file":"/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/where.ts","sources":["/Volumes/Coding/forest-fire/vuex-plugin-firemodel/src/abc/api/queryHelpers/where.ts"],"names":[],"mappings":";;AAAA,0CAA8D;AAQ9D,yCAAuE;AACvE,sCAA6C;AAE7C;;;;GAIG;AACH,IAAI,KAAK,GAAG,SAAS,KAAK,CACxB,IAEkE,EAClE,UAA4B,EAAE;IAE9B,IAAI,mCAAQ,IAAI,KAAE,SAAS,EAAE,iBAAS,CAAC,KAAK,GAAE,CAAC;IAC/C,OAAO,KAAK,EACV,OAA0B,EAC1B,GAAc,EACS,EAAE;QACzB,qCAAqC;QACrC,MAAM,OAAO,GACX,IAAI,CAAC,MAAM,KAAK,SAAS;YACvB,CAAC,CAAC,IAAI,CAAC,MAAM;YACb,CAAC,CAAC,IAAI,CAAC,WAAW,KAAK,SAAS;gBAChC,CAAC,CAAC,CAAC,GAAG,EAAE,IAAI,CAAC,WAAW,CAAC;gBACzB,CAAC,CAAC,CAAC,GAAG,EAAE,IAAI,CAAC,QAAQ,CAAC,CAAC;QAC3B,iCAAiC;QACjC,MAAM,UAAU,GAAG,KAAK,IAAI,EAAE;YAC5B,MAAM,IAAI,GAAG,MAAM,GAAG,CAAC,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,QAAQ,EAAE,OAAO,CAAC,CAAC;YAE/D,OAAO,IAAI,CAAC;QACd,CAAC,CAAC;QACF,gCAAgC;QAChC,MAAM,cAAc,GAAG,KAAK,IAAI,EAAE;YAChC,MAAM,IAAI,GAAG,MAAM,gBAAI,CAAC,KAAK,CAC3B,GAAG,CAAC,KAAK,CAAC,WAAW,EACrB,IAAI,CAAC,QAAQ,EACb,OAAO,CACR,CAAC;YACF,OAAO,IAAI,CAAC,IAAI,CAAC;QACnB,CAAC,CAAC;QAEF,OAAO,yBAAgB,CACrB,IAAI,EACJ,OAAO,EACP,UAAU,EACV,cAAc,EACd,GAAG,EACH,OAAO,CACR,CAAC;IACJ,CAAC,CAAC;AACJ,CAAC,CAAC;AAIO,sBAAK;AAFd,KAAK,CAAC,SAAS,CAAC,aAAa,GAAG,IAAI,CAAC","sourcesContent":["import { AbcRequestCommand, QueryType } from \"../../../types\";\nimport { AbcApi } from \"../AbcApi\";\nimport {\n  getStore,\n  AbcResult,\n  IQueryOptions,\n  IAbcWhereQueryDefinition\n} from \"../../..\";\nimport { List, Model, PropType, IComparisonOperator } from \"firemodel\";\nimport { generalizedQuery } from \"../shared\";\n\n/**\n * Offers a configuration to consumers of the standard _where_ clause that Firebase\n * provides and then provides an implementation that is aligned with the ABC `get`\n * and `load` endpoints.\n */\nlet where = function where<T extends Model, K extends keyof T>(\n  defn:\n    | IAbcWhereQueryDefinition<T>\n    | (IAbcWhereQueryDefinition<T> & { queryType: QueryType.where }),\n  options: IQueryOptions<T> = {}\n) {\n  defn = { ...defn, queryType: QueryType.where };\n  return async (\n    command: AbcRequestCommand,\n    ctx: AbcApi<T>\n  ): Promise<AbcResult<T>> => {\n    // The value and operation to be used\n    const valueOp: PropType<T, K> | [IComparisonOperator, PropType<T, K>] =\n      defn.equals !== undefined\n        ? defn.equals\n        : defn.greaterThan !== undefined\n        ? [\">\", defn.greaterThan]\n        : [\"<\", defn.lessThan];\n    // The query to use for IndexedDB\n    const dexieQuery = async () => {\n      const recs = await ctx.dexieList.where(defn.property, valueOp);\n\n      return recs;\n    };\n    // The query to use for Firebase\n    const firemodelQuery = async () => {\n      const list = await List.where(\n        ctx.model.constructor,\n        defn.property,\n        valueOp\n      );\n      return list.data;\n    };\n\n    return generalizedQuery(\n      defn,\n      command,\n      dexieQuery,\n      firemodelQuery,\n      ctx,\n      options\n    );\n  };\n};\n\nwhere.prototype.isQueryHelper = true;\n\nexport { where };\n"]},"_coverageSchema":"1a1c01bbd47fc00a2c39e90264f33305004495a9","hash":"74a4de6a9ec66f6998933659a1636cd474d389e1","contentHash":"8b34fb54e20781c6888faba5862eff9923da2ef01275e0c5884db8132b4e0280"}}